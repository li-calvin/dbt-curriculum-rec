[0m15:50:37.519361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107738c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107757e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107757f90>]}


============================== 15:50:37.521552 | 114a67df-fdb6-49e0-97be-24900d373843 ==============================
[0m15:50:37.521552 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:50:37.521820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'log_path': '/Users/CalvinLii/dbt-tutorial/jaffle_shop/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:50:37.529947 [info ] [MainThread]: dbt version: 1.8.3
[0m15:50:37.530123 [info ] [MainThread]: python version: 3.11.7
[0m15:50:37.530258 [info ] [MainThread]: python path: /Users/CalvinLii/dbt-env/bin/python
[0m15:50:37.530373 [info ] [MainThread]: os info: macOS-14.0-arm64-arm-64bit
[0m15:50:38.030814 [info ] [MainThread]: Using profiles dir at /Users/CalvinLii/.dbt
[0m15:50:38.031067 [info ] [MainThread]: Using profiles.yml file at /Users/CalvinLii/.dbt/profiles.yml
[0m15:50:38.031202 [info ] [MainThread]: Using dbt_project.yml file at /Users/CalvinLii/dbt-tutorial/jaffle_shop/dbt_project.yml
[0m15:50:38.031319 [info ] [MainThread]: adapter type: bigquery
[0m15:50:38.031431 [info ] [MainThread]: adapter version: 1.8.2
[0m15:50:38.060876 [info ] [MainThread]: Configuration:
[0m15:50:38.061050 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:50:38.061175 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:50:38.061287 [info ] [MainThread]: Required dependencies:
[0m15:50:38.061431 [debug] [MainThread]: Executing "git --help"
[0m15:50:38.073930 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:50:38.074359 [debug] [MainThread]: STDERR: "b''"
[0m15:50:38.074512 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:50:38.074664 [info ] [MainThread]: Connection:
[0m15:50:38.074821 [info ] [MainThread]:   method: service-account
[0m15:50:38.074923 [info ] [MainThread]:   database: dbt-tutorial-428919
[0m15:50:38.075022 [info ] [MainThread]:   execution_project: dbt-tutorial-428919
[0m15:50:38.075118 [info ] [MainThread]:   schema: dbt_calvin
[0m15:50:38.075209 [info ] [MainThread]:   location: US
[0m15:50:38.075299 [info ] [MainThread]:   priority: interactive
[0m15:50:38.075392 [info ] [MainThread]:   maximum_bytes_billed: None
[0m15:50:38.075484 [info ] [MainThread]:   impersonate_service_account: None
[0m15:50:38.075576 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m15:50:38.075677 [info ] [MainThread]:   job_retries: 1
[0m15:50:38.075773 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m15:50:38.075876 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m15:50:38.075966 [info ] [MainThread]:   timeout_seconds: 300
[0m15:50:38.076062 [info ] [MainThread]:   client_id: None
[0m15:50:38.076152 [info ] [MainThread]:   token_uri: None
[0m15:50:38.076243 [info ] [MainThread]:   dataproc_region: None
[0m15:50:38.076333 [info ] [MainThread]:   dataproc_cluster_name: None
[0m15:50:38.076418 [info ] [MainThread]:   gcs_bucket: None
[0m15:50:38.076507 [info ] [MainThread]:   dataproc_batch: None
[0m15:50:38.076744 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:50:38.080254 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m15:50:38.080761 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:50:38.080990 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/Users/BBaggins/.dbt/dbt-tutorial-428919-05cddae3d3b7.json''
[0m15:50:38.081163 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m15:50:38.081328 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:50:38.081537 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  [Errno 2] No such file or directory: '/Users/BBaggins/.dbt/dbt-tutorial-428919-05cddae3d3b7.json'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m15:50:38.083074 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.5902921, "process_user_time": 0.758639, "process_kernel_time": 0.174433, "process_mem_max_rss": "195084288", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:50:38.083381 [debug] [MainThread]: Command `dbt debug` failed at 15:50:38.083319 after 0.59 seconds
[0m15:50:38.083550 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:50:38.084036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103289350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103288a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc05bd0>]}
[0m15:50:38.084264 [debug] [MainThread]: Flushing usage events
[0m15:50:52.297972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f42f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fabe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fabdd0>]}


============================== 15:50:52.299729 | 4a3e770b-825c-4fa4-b626-3b28a414736b ==============================
[0m15:50:52.299729 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:50:52.300004 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/CalvinLii/dbt-tutorial/jaffle_shop/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:50:52.303920 [info ] [MainThread]: dbt version: 1.8.3
[0m15:50:52.304099 [info ] [MainThread]: python version: 3.11.7
[0m15:50:52.304243 [info ] [MainThread]: python path: /Users/CalvinLii/dbt-env/bin/python
[0m15:50:52.304365 [info ] [MainThread]: os info: macOS-14.0-arm64-arm-64bit
[0m15:50:52.582920 [info ] [MainThread]: Using profiles dir at /Users/CalvinLii/.dbt
[0m15:50:52.583177 [info ] [MainThread]: Using profiles.yml file at /Users/CalvinLii/.dbt/profiles.yml
[0m15:50:52.583309 [info ] [MainThread]: Using dbt_project.yml file at /Users/CalvinLii/dbt-tutorial/jaffle_shop/dbt_project.yml
[0m15:50:52.583425 [info ] [MainThread]: adapter type: bigquery
[0m15:50:52.583536 [info ] [MainThread]: adapter version: 1.8.2
[0m15:50:52.612892 [info ] [MainThread]: Configuration:
[0m15:50:52.613057 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:50:52.613189 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:50:52.613299 [info ] [MainThread]: Required dependencies:
[0m15:50:52.613442 [debug] [MainThread]: Executing "git --help"
[0m15:50:52.620720 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:50:52.621140 [debug] [MainThread]: STDERR: "b''"
[0m15:50:52.621308 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:50:52.621456 [info ] [MainThread]: Connection:
[0m15:50:52.621635 [info ] [MainThread]:   method: service-account
[0m15:50:52.621737 [info ] [MainThread]:   database: dbt-tutorial-428919
[0m15:50:52.621875 [info ] [MainThread]:   execution_project: dbt-tutorial-428919
[0m15:50:52.621977 [info ] [MainThread]:   schema: dbt_calvin
[0m15:50:52.622076 [info ] [MainThread]:   location: US
[0m15:50:52.622177 [info ] [MainThread]:   priority: interactive
[0m15:50:52.622277 [info ] [MainThread]:   maximum_bytes_billed: None
[0m15:50:52.622380 [info ] [MainThread]:   impersonate_service_account: None
[0m15:50:52.622477 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m15:50:52.622578 [info ] [MainThread]:   job_retries: 1
[0m15:50:52.622697 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m15:50:52.622792 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m15:50:52.622891 [info ] [MainThread]:   timeout_seconds: 300
[0m15:50:52.622990 [info ] [MainThread]:   client_id: None
[0m15:50:52.623091 [info ] [MainThread]:   token_uri: None
[0m15:50:52.623193 [info ] [MainThread]:   dataproc_region: None
[0m15:50:52.623292 [info ] [MainThread]:   dataproc_cluster_name: None
[0m15:50:52.623393 [info ] [MainThread]:   gcs_bucket: None
[0m15:50:52.623492 [info ] [MainThread]:   dataproc_batch: None
[0m15:50:52.623754 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:50:52.627020 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m15:50:52.627506 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:50:52.628845 [debug] [MainThread]: On debug: select 1 as id
[0m15:50:53.900408 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:bd61372f-7b53-4666-86db-6fde94df2aaa&page=queryresults
[0m15:50:54.533997 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:50:54.535260 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:50:54.540007 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.2654727, "process_user_time": 0.821543, "process_kernel_time": 0.139832, "process_mem_max_rss": "199704576", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:50:54.540969 [debug] [MainThread]: Command `dbt debug` succeeded at 15:50:54.540853 after 2.27 seconds
[0m15:50:54.541365 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:50:54.541722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f6f090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b81a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b21d550>]}
[0m15:50:54.542123 [debug] [MainThread]: Flushing usage events
[0m15:51:17.596513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090c2c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10911c290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109144f50>]}


============================== 15:51:17.598171 | 51183ecc-a36e-4a0c-92e4-48fd6c0a79a7 ==============================
[0m15:51:17.598171 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:51:17.598445 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/CalvinLii/dbt-tutorial/jaffle_shop/logs', 'profiles_dir': '/Users/CalvinLii/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:51:17.902296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51183ecc-a36e-4a0c-92e4-48fd6c0a79a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4c7790>]}
[0m15:51:17.920633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51183ecc-a36e-4a0c-92e4-48fd6c0a79a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076a8cd0>]}
[0m15:51:17.920877 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:51:17.929733 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:51:17.930146 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:51:17.930360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '51183ecc-a36e-4a0c-92e4-48fd6c0a79a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e915590>]}
[0m15:51:18.408645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51183ecc-a36e-4a0c-92e4-48fd6c0a79a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090f0610>]}
[0m15:51:18.444619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51183ecc-a36e-4a0c-92e4-48fd6c0a79a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edebdd0>]}
[0m15:51:18.444834 [info ] [MainThread]: Found 2 models, 4 data tests, 471 macros
[0m15:51:18.444990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51183ecc-a36e-4a0c-92e4-48fd6c0a79a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebd3450>]}
[0m15:51:18.445680 [info ] [MainThread]: 
[0m15:51:18.445900 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:51:18.447342 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m15:51:18.447507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:18.745837 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now create_dbt-tutorial-428919_dbt_calvin)
[0m15:51:18.746888 [debug] [ThreadPool]: Creating schema "database: "dbt-tutorial-428919"
schema: "dbt_calvin"
"
[0m15:51:18.758810 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:18.760644 [debug] [ThreadPool]: On create_dbt-tutorial-428919_dbt_calvin: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_dbt-tutorial-428919_dbt_calvin"} */
create schema if not exists `dbt-tutorial-428919`.`dbt_calvin`
  
[0m15:51:19.315470 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:42203407-e78e-4ccb-a864-5097311a7c06&page=queryresults
[0m15:51:20.126046 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt-tutorial-428919_dbt_calvin, now list_dbt-tutorial-428919_dbt_calvin)
[0m15:51:20.126893 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:20.645776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51183ecc-a36e-4a0c-92e4-48fd6c0a79a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec5cd50>]}
[0m15:51:20.647354 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:51:20.647891 [info ] [MainThread]: 
[0m15:51:20.651846 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m15:51:20.652822 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_calvin.my_first_dbt_model ..................... [RUN]
[0m15:51:20.653671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_calvin, now model.jaffle_shop.my_first_dbt_model)
[0m15:51:20.654089 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m15:51:20.662431 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m15:51:20.663374 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m15:51:20.686715 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m15:51:20.687347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:20.688336 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

    create or replace table `dbt-tutorial-428919`.`dbt_calvin`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m15:51:21.362099 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:fd3a0b71-c3bb-4ffb-b780-7e2194534b79&page=queryresults
[0m15:51:24.287624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51183ecc-a36e-4a0c-92e4-48fd6c0a79a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090f18d0>]}
[0m15:51:24.288330 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_calvin.my_first_dbt_model ................ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.63s]
[0m15:51:24.288780 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m15:51:24.289499 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m15:51:24.289804 [info ] [Thread-1 (]: 2 of 2 START sql view model dbt_calvin.my_second_dbt_model ..................... [RUN]
[0m15:51:24.290088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.my_second_dbt_model)
[0m15:51:24.290314 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m15:51:24.292368 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m15:51:24.293018 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m15:51:24.304345 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m15:51:24.304734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:24.305682 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `dbt-tutorial-428919`.`dbt_calvin`.`my_first_dbt_model`
where id = 1;


[0m15:51:24.946681 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:a64be105-5a3d-43e3-8cc3-96e43a97e088&page=queryresults
[0m15:51:25.352009 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51183ecc-a36e-4a0c-92e4-48fd6c0a79a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee843d0>]}
[0m15:51:25.353709 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dbt_calvin.my_second_dbt_model ................ [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m15:51:25.354686 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m15:51:25.356582 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:25.357084 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m15:51:25.357392 [info ] [MainThread]: 
[0m15:51:25.357697 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 6.91 seconds (6.91s).
[0m15:51:25.358413 [debug] [MainThread]: Command end result
[0m15:51:25.383225 [info ] [MainThread]: 
[0m15:51:25.383593 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:51:25.383782 [info ] [MainThread]: 
[0m15:51:25.383968 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:51:25.385246 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.812728, "process_user_time": 1.67123, "process_kernel_time": 0.17279, "process_mem_max_rss": "213319680", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:51:25.385547 [debug] [MainThread]: Command `dbt run` succeeded at 15:51:25.385495 after 7.81 seconds
[0m15:51:25.385744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109155ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109144890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d574d0>]}
[0m15:51:25.385945 [debug] [MainThread]: Flushing usage events
[0m16:01:06.515708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cff110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d7c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d7ce10>]}


============================== 16:01:06.517319 | c6b0354d-57da-4440-811b-adffc01912f0 ==============================
[0m16:01:06.517319 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:01:06.517596 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'log_path': '/Users/CalvinLii/dbt-tutorial/jaffle_shop/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:01:06.817338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6b0354d-57da-4440-811b-adffc01912f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c20f90>]}
[0m16:01:06.835737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6b0354d-57da-4440-811b-adffc01912f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1b9110>]}
[0m16:01:06.835985 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m16:01:06.844384 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:01:06.920602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:01:06.920885 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/customers.sql
[0m16:01:07.000043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6b0354d-57da-4440-811b-adffc01912f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a532150>]}
[0m16:01:07.032149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6b0354d-57da-4440-811b-adffc01912f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a94ff50>]}
[0m16:01:07.032350 [info ] [MainThread]: Found 3 models, 4 data tests, 471 macros
[0m16:01:07.032494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6b0354d-57da-4440-811b-adffc01912f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a82df50>]}
[0m16:01:07.033201 [info ] [MainThread]: 
[0m16:01:07.033420 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:01:07.034892 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m16:01:07.035070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:07.506366 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_calvin)
[0m16:01:07.507432 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:07.870856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6b0354d-57da-4440-811b-adffc01912f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a81b710>]}
[0m16:01:07.872408 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:01:07.873457 [info ] [MainThread]: 
[0m16:01:07.876296 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m16:01:07.876874 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_calvin.customers ............................... [RUN]
[0m16:01:07.877333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_calvin, now model.jaffle_shop.customers)
[0m16:01:07.877670 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m16:01:07.883649 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m16:01:07.884369 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m16:01:07.905413 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m16:01:07.905853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:07.906861 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`customers`
  OPTIONS()
  as with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


[0m16:01:08.603529 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:8d9da2af-d111-4c99-81e7-c9bca86ea1f5&page=queryresults
[0m16:01:09.213758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6b0354d-57da-4440-811b-adffc01912f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7a9110>]}
[0m16:01:09.214464 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dbt_calvin.customers .......................... [[32mCREATE VIEW (0 processed)[0m in 1.34s]
[0m16:01:09.214949 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m16:01:09.215290 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m16:01:09.215736 [info ] [Thread-1 (]: 2 of 3 START sql table model dbt_calvin.my_first_dbt_model ..................... [RUN]
[0m16:01:09.216145 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.customers, now model.jaffle_shop.my_first_dbt_model)
[0m16:01:09.216430 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m16:01:09.218254 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m16:01:09.218773 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m16:01:09.224839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:09.674911 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m16:01:09.675978 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

    create or replace table `dbt-tutorial-428919`.`dbt_calvin`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m16:01:10.781075 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:7a97a6ac-fbe3-4d24-8b88-d0457d0d1192&page=queryresults
[0m16:01:17.006997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6b0354d-57da-4440-811b-adffc01912f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a84bd50>]}
[0m16:01:17.008899 [info ] [Thread-1 (]: 2 of 3 OK created sql table model dbt_calvin.my_first_dbt_model ................ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 7.79s]
[0m16:01:17.010538 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m16:01:17.012564 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m16:01:17.013970 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_calvin.my_second_dbt_model ..................... [RUN]
[0m16:01:17.015020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.my_second_dbt_model)
[0m16:01:17.015675 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m16:01:17.022270 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m16:01:17.023737 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m16:01:17.027795 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m16:01:17.028873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:17.031296 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `dbt-tutorial-428919`.`dbt_calvin`.`my_first_dbt_model`
where id = 1;


[0m16:01:17.744617 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:0675fc60-06cd-4d53-8927-ec4889bce21a&page=queryresults
[0m16:01:18.089656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6b0354d-57da-4440-811b-adffc01912f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7d0bd0>]}
[0m16:01:18.090767 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dbt_calvin.my_second_dbt_model ................ [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m16:01:18.091451 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m16:01:18.093246 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:01:18.093779 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m16:01:18.094177 [info ] [MainThread]: 
[0m16:01:18.094503 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 11.06 seconds (11.06s).
[0m16:01:18.095473 [debug] [MainThread]: Command end result
[0m16:01:18.121244 [info ] [MainThread]: 
[0m16:01:18.121521 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:01:18.121888 [info ] [MainThread]: 
[0m16:01:18.122166 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:01:18.123565 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.631514, "process_user_time": 1.401118, "process_kernel_time": 0.169818, "process_mem_max_rss": "209338368", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:01:18.123906 [debug] [MainThread]: Command `dbt run` succeeded at 16:01:18.123846 after 11.63 seconds
[0m16:01:18.124130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d7ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d7cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10093db10>]}
[0m16:01:18.124351 [debug] [MainThread]: Flushing usage events
[0m16:04:50.409529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054b16d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105503d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105534cd0>]}


============================== 16:04:50.411154 | 5abf1690-43f3-4783-8ec1-6100cb3302af ==============================
[0m16:04:50.411154 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:04:50.411429 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/CalvinLii/dbt-tutorial/jaffle_shop/logs', 'profiles_dir': '/Users/CalvinLii/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:04:50.714212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5abf1690-43f3-4783-8ec1-6100cb3302af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acd23d0>]}
[0m16:04:50.732598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5abf1690-43f3-4783-8ec1-6100cb3302af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a9cb50>]}
[0m16:04:50.732830 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m16:04:50.741275 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:04:50.811353 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:04:50.811651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5abf1690-43f3-4783-8ec1-6100cb3302af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041f0fd0>]}
[0m16:04:51.245376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5abf1690-43f3-4783-8ec1-6100cb3302af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad41e50>]}
[0m16:04:51.277759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5abf1690-43f3-4783-8ec1-6100cb3302af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1e7e90>]}
[0m16:04:51.277966 [info ] [MainThread]: Found 3 models, 4 data tests, 471 macros
[0m16:04:51.278114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5abf1690-43f3-4783-8ec1-6100cb3302af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aca2cd0>]}
[0m16:04:51.278843 [info ] [MainThread]: 
[0m16:04:51.279057 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:04:51.280572 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m16:04:51.280748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:51.644467 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_calvin)
[0m16:04:51.645572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:52.017927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5abf1690-43f3-4783-8ec1-6100cb3302af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c71bd0>]}
[0m16:04:52.019767 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:04:52.020543 [info ] [MainThread]: 
[0m16:04:52.023761 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m16:04:52.024593 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_calvin.customers ............................... [RUN]
[0m16:04:52.025188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_calvin, now model.jaffle_shop.customers)
[0m16:04:52.025572 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m16:04:52.033933 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m16:04:52.034724 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m16:04:52.055576 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m16:04:52.056015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:04:52.057173 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`customers`
  OPTIONS()
  as with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


[0m16:04:52.787655 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:c5a7359f-0546-4536-b315-51e888bb749c&page=queryresults
[0m16:04:53.169410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5abf1690-43f3-4783-8ec1-6100cb3302af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1e7250>]}
[0m16:04:53.170010 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dbt_calvin.customers .......................... [[32mCREATE VIEW (0 processed)[0m in 1.14s]
[0m16:04:53.170446 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m16:04:53.170753 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m16:04:53.171160 [info ] [Thread-1 (]: 2 of 3 START sql table model dbt_calvin.my_first_dbt_model ..................... [RUN]
[0m16:04:53.171530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.customers, now model.jaffle_shop.my_first_dbt_model)
[0m16:04:53.171786 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m16:04:53.173893 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m16:04:53.174548 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m16:04:53.181083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:04:53.544706 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m16:04:53.545490 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

    create or replace table `dbt-tutorial-428919`.`dbt_calvin`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m16:04:54.014654 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:de04a692-8019-4569-b065-30e7f1716394&page=queryresults
[0m16:04:56.426442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5abf1690-43f3-4783-8ec1-6100cb3302af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b24fc90>]}
[0m16:04:56.427980 [info ] [Thread-1 (]: 2 of 3 OK created sql table model dbt_calvin.my_first_dbt_model ................ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.25s]
[0m16:04:56.428747 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m16:04:56.430092 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m16:04:56.431060 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_calvin.my_second_dbt_model ..................... [RUN]
[0m16:04:56.431632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.my_second_dbt_model)
[0m16:04:56.432019 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m16:04:56.435679 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m16:04:56.436481 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m16:04:56.438986 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m16:04:56.439561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:04:56.441118 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `dbt-tutorial-428919`.`dbt_calvin`.`my_first_dbt_model`
where id = 1;


[0m16:04:56.982627 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:3915fd77-7ccb-4b87-9d5c-dba1a3541bbe&page=queryresults
[0m16:04:57.485165 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5abf1690-43f3-4783-8ec1-6100cb3302af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b22b490>]}
[0m16:04:57.486274 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dbt_calvin.my_second_dbt_model ................ [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m16:04:57.486962 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m16:04:57.488741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:04:57.489334 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m16:04:57.489796 [info ] [MainThread]: 
[0m16:04:57.490182 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 6.21 seconds (6.21s).
[0m16:04:57.491225 [debug] [MainThread]: Command end result
[0m16:04:57.517121 [info ] [MainThread]: 
[0m16:04:57.517389 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:04:57.517604 [info ] [MainThread]: 
[0m16:04:57.517798 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:04:57.519146 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.133368, "process_user_time": 1.720628, "process_kernel_time": 0.173623, "process_mem_max_rss": "213434368", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:04:57.519460 [debug] [MainThread]: Command `dbt run` succeeded at 16:04:57.519408 after 7.13 seconds
[0m16:04:57.519663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105501fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105147850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1010f1b10>]}
[0m16:04:57.519879 [debug] [MainThread]: Flushing usage events
[0m16:06:34.770474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10908f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090dfc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109114f50>]}


============================== 16:06:34.772159 | 39d09585-0a05-4fc5-9ca6-13d7fa54aecb ==============================
[0m16:06:34.772159 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:06:34.772431 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/CalvinLii/dbt-tutorial/jaffle_shop/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:06:35.072519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39d09585-0a05-4fc5-9ca6-13d7fa54aecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac128d0>]}
[0m16:06:35.090878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39d09585-0a05-4fc5-9ca6-13d7fa54aecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107674f50>]}
[0m16:06:35.091114 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m16:06:35.099513 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:06:35.176150 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:06:35.176434 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/customers.sql
[0m16:06:35.255142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39d09585-0a05-4fc5-9ca6-13d7fa54aecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e862d50>]}
[0m16:06:35.287441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39d09585-0a05-4fc5-9ca6-13d7fa54aecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eccfc10>]}
[0m16:06:35.287638 [info ] [MainThread]: Found 3 models, 4 data tests, 471 macros
[0m16:06:35.287783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39d09585-0a05-4fc5-9ca6-13d7fa54aecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebd0cd0>]}
[0m16:06:35.288490 [info ] [MainThread]: 
[0m16:06:35.288715 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:06:35.290221 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m16:06:35.290393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:35.700700 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_calvin)
[0m16:06:35.701912 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:06:36.044589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39d09585-0a05-4fc5-9ca6-13d7fa54aecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e84c790>]}
[0m16:06:36.046054 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:06:36.046822 [info ] [MainThread]: 
[0m16:06:36.050149 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m16:06:36.050842 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_calvin.customers ............................... [RUN]
[0m16:06:36.051371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_calvin, now model.jaffle_shop.customers)
[0m16:06:36.051684 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m16:06:36.059640 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m16:06:36.060369 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m16:06:36.079791 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m16:06:36.080228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:36.081218 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`customers`
  OPTIONS()
  as 

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


[0m16:06:36.825719 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:551136b7-a164-450b-adf2-2c5ba5c05079&page=queryresults
[0m16:06:37.177427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39d09585-0a05-4fc5-9ca6-13d7fa54aecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed11550>]}
[0m16:06:37.178156 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dbt_calvin.customers .......................... [[32mCREATE VIEW (0 processed)[0m in 1.13s]
[0m16:06:37.178647 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m16:06:37.179003 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m16:06:37.179476 [info ] [Thread-1 (]: 2 of 3 START sql table model dbt_calvin.my_first_dbt_model ..................... [RUN]
[0m16:06:37.179897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.customers, now model.jaffle_shop.my_first_dbt_model)
[0m16:06:37.180180 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m16:06:37.182496 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m16:06:37.183150 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m16:06:37.190386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:37.665329 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m16:06:37.666178 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

    create or replace table `dbt-tutorial-428919`.`dbt_calvin`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m16:06:38.117966 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:de9fb788-bd4e-46d1-8111-5d1b1da3e17a&page=queryresults
[0m16:06:40.616761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39d09585-0a05-4fc5-9ca6-13d7fa54aecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed5ead0>]}
[0m16:06:40.618567 [info ] [Thread-1 (]: 2 of 3 OK created sql table model dbt_calvin.my_first_dbt_model ................ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.44s]
[0m16:06:40.620052 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m16:06:40.621742 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m16:06:40.622379 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_calvin.my_second_dbt_model ..................... [RUN]
[0m16:06:40.622927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.my_second_dbt_model)
[0m16:06:40.623330 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m16:06:40.628838 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m16:06:40.629965 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m16:06:40.632929 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m16:06:40.633538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:40.635135 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `dbt-tutorial-428919`.`dbt_calvin`.`my_first_dbt_model`
where id = 1;


[0m16:06:41.330641 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:daf52446-bfcc-4732-8d3e-66dd93d72744&page=queryresults
[0m16:06:41.849159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39d09585-0a05-4fc5-9ca6-13d7fa54aecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8e2090>]}
[0m16:06:41.850121 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dbt_calvin.my_second_dbt_model ................ [[32mCREATE VIEW (0 processed)[0m in 1.23s]
[0m16:06:41.850836 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m16:06:41.852928 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:06:41.853283 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m16:06:41.853704 [info ] [MainThread]: 
[0m16:06:41.854066 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 6.56 seconds (6.56s).
[0m16:06:41.855050 [debug] [MainThread]: Command end result
[0m16:06:41.880715 [info ] [MainThread]: 
[0m16:06:41.880975 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:06:41.881148 [info ] [MainThread]: 
[0m16:06:41.881332 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:06:41.882636 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.1359854, "process_user_time": 1.380829, "process_kernel_time": 0.169327, "process_mem_max_rss": "208781312", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:06:41.882950 [debug] [MainThread]: Command `dbt run` succeeded at 16:06:41.882899 after 7.14 seconds
[0m16:06:41.883171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ccdb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c28a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109098c10>]}
[0m16:06:41.883370 [debug] [MainThread]: Flushing usage events
[0m16:06:57.609572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10506eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f4550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f4b90>]}


============================== 16:06:57.611253 | 535ca94b-99da-44ac-8d1e-5931752d4e64 ==============================
[0m16:06:57.611253 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:06:57.611524 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/CalvinLii/dbt-tutorial/jaffle_shop/logs', 'profiles_dir': '/Users/CalvinLii/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:06:57.920201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '535ca94b-99da-44ac-8d1e-5931752d4e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a448990>]}
[0m16:06:57.938629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '535ca94b-99da-44ac-8d1e-5931752d4e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10364d850>]}
[0m16:06:57.938868 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m16:06:57.947863 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:06:58.026604 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:06:58.026816 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:06:58.040763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '535ca94b-99da-44ac-8d1e-5931752d4e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9cd850>]}
[0m16:06:58.074903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '535ca94b-99da-44ac-8d1e-5931752d4e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9de150>]}
[0m16:06:58.075116 [info ] [MainThread]: Found 3 models, 4 data tests, 471 macros
[0m16:06:58.075266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '535ca94b-99da-44ac-8d1e-5931752d4e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a95efd0>]}
[0m16:06:58.076025 [info ] [MainThread]: 
[0m16:06:58.076256 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:06:58.077827 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m16:06:58.078014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:58.403176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_calvin)
[0m16:06:58.404400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:06:58.842751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '535ca94b-99da-44ac-8d1e-5931752d4e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10977db90>]}
[0m16:06:58.843801 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:06:58.844271 [info ] [MainThread]: 
[0m16:06:58.847472 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m16:06:58.848341 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_calvin.customers ............................... [RUN]
[0m16:06:58.849257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_calvin, now model.jaffle_shop.customers)
[0m16:06:58.849674 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m16:06:58.858913 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m16:06:58.859676 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m16:06:58.880331 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m16:06:58.880832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:58.881924 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`customers`
  OPTIONS()
  as 

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


[0m16:06:59.558419 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:febb3c15-1a35-4e1d-9942-e5fdf4300848&page=queryresults
[0m16:07:00.097148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '535ca94b-99da-44ac-8d1e-5931752d4e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8e1bd0>]}
[0m16:07:00.097867 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dbt_calvin.customers .......................... [[32mCREATE VIEW (0 processed)[0m in 1.25s]
[0m16:07:00.098370 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m16:07:00.098719 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m16:07:00.099183 [info ] [Thread-1 (]: 2 of 3 START sql table model dbt_calvin.my_first_dbt_model ..................... [RUN]
[0m16:07:00.099607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.customers, now model.jaffle_shop.my_first_dbt_model)
[0m16:07:00.099897 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m16:07:00.102102 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m16:07:00.102719 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m16:07:00.109896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:00.463146 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m16:07:00.464104 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

    create or replace table `dbt-tutorial-428919`.`dbt_calvin`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m16:07:00.991359 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:8512d645-19a8-4112-b7aa-b8f4d8a3fcd3&page=queryresults
[0m16:07:03.657155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '535ca94b-99da-44ac-8d1e-5931752d4e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abb8150>]}
[0m16:07:03.658945 [info ] [Thread-1 (]: 2 of 3 OK created sql table model dbt_calvin.my_first_dbt_model ................ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.56s]
[0m16:07:03.660431 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m16:07:03.662109 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m16:07:03.662799 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_calvin.my_second_dbt_model ..................... [RUN]
[0m16:07:03.663391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.my_second_dbt_model)
[0m16:07:03.663850 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m16:07:03.669098 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m16:07:03.670322 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m16:07:03.673303 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m16:07:03.673903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:03.675517 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `dbt-tutorial-428919`.`dbt_calvin`.`my_first_dbt_model`
where id = 1;


[0m16:07:04.271844 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:6135a2e8-eff4-49eb-b5ea-9fbd8e7ef713&page=queryresults
[0m16:07:04.599152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '535ca94b-99da-44ac-8d1e-5931752d4e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab14490>]}
[0m16:07:04.600148 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dbt_calvin.my_second_dbt_model ................ [[32mCREATE VIEW (0 processed)[0m in 0.94s]
[0m16:07:04.600912 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m16:07:04.602504 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:07:04.602828 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m16:07:04.603241 [info ] [MainThread]: 
[0m16:07:04.604147 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 6.53 seconds (6.53s).
[0m16:07:04.605240 [debug] [MainThread]: Command end result
[0m16:07:04.630400 [info ] [MainThread]: 
[0m16:07:04.630693 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:07:04.630895 [info ] [MainThread]: 
[0m16:07:04.631097 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:07:04.632541 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.047081, "process_user_time": 1.340657, "process_kernel_time": 0.172992, "process_mem_max_rss": "205750272", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:07:04.632885 [debug] [MainThread]: Command `dbt run` succeeded at 16:07:04.632835 after 7.05 seconds
[0m16:07:04.633106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105101cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f4a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100c08b50>]}
[0m16:07:04.633313 [debug] [MainThread]: Flushing usage events
[0m16:12:03.444590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104da2bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e28550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e28b90>]}


============================== 16:12:03.446300 | a97e7e83-e949-46f0-bd64-2ff4026bbfc6 ==============================
[0m16:12:03.446300 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:12:03.446568 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/CalvinLii/.dbt', 'log_path': '/Users/CalvinLii/dbt-tutorial/jaffle_shop/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:12:03.748218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a97e7e83-e949-46f0-bd64-2ff4026bbfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a25a550>]}
[0m16:12:03.766676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a97e7e83-e949-46f0-bd64-2ff4026bbfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103389010>]}
[0m16:12:03.766912 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m16:12:03.775378 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:12:03.843137 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:12:03.843413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a97e7e83-e949-46f0-bd64-2ff4026bbfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ae10d0>]}
[0m16:12:04.203071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a97e7e83-e949-46f0-bd64-2ff4026bbfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a504b10>]}
[0m16:12:04.230028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a97e7e83-e949-46f0-bd64-2ff4026bbfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a99c410>]}
[0m16:12:04.230221 [info ] [MainThread]: Found 3 models, 471 macros
[0m16:12:04.230365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a97e7e83-e949-46f0-bd64-2ff4026bbfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8c4850>]}
[0m16:12:04.231049 [info ] [MainThread]: 
[0m16:12:04.231276 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:12:04.232793 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m16:12:04.232962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:04.586106 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_calvin)
[0m16:12:04.586876 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:12:04.975443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a97e7e83-e949-46f0-bd64-2ff4026bbfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a86ba50>]}
[0m16:12:04.976855 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:12:04.977274 [info ] [MainThread]: 
[0m16:12:04.980959 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m16:12:04.981820 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_calvin.stg_customers ........................... [RUN]
[0m16:12:04.982419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_calvin, now model.jaffle_shop.stg_customers)
[0m16:12:04.982812 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m16:12:04.989196 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m16:12:04.989931 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m16:12:05.010557 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m16:12:05.010990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:05.012002 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`stg_customers`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers;


[0m16:12:05.691524 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:c9ad201e-b6c5-4d0e-84b4-22f42ab67b2c&page=queryresults
[0m16:12:06.258336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a97e7e83-e949-46f0-bd64-2ff4026bbfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7e3850>]}
[0m16:12:06.259028 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dbt_calvin.stg_customers ...................... [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m16:12:06.259527 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m16:12:06.259874 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m16:12:06.260379 [info ] [Thread-1 (]: 2 of 3 START sql view model dbt_calvin.stg_orders .............................. [RUN]
[0m16:12:06.260785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m16:12:06.261111 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m16:12:06.264624 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m16:12:06.265245 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m16:12:06.267033 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m16:12:06.267500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:06.268766 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders;


[0m16:12:07.067574 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:6235e1b1-aa11-452f-845c-2f061c0b9b05&page=queryresults
[0m16:12:07.395220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a97e7e83-e949-46f0-bd64-2ff4026bbfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103aee990>]}
[0m16:12:07.396273 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dbt_calvin.stg_orders ......................... [[32mCREATE VIEW (0 processed)[0m in 1.13s]
[0m16:12:07.397069 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m16:12:07.398085 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m16:12:07.398690 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_calvin.customers ............................... [RUN]
[0m16:12:07.399323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.customers)
[0m16:12:07.400021 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m16:12:07.404182 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m16:12:07.404895 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m16:12:07.407387 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m16:12:07.407937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:07.409224 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`customers`
  OPTIONS()
  as with customers as (

    select * from `dbt-tutorial-428919`.`dbt_calvin`.`stg_customers`

),

orders as (

    select * from `dbt-tutorial-428919`.`dbt_calvin`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


[0m16:12:08.178054 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:2c870e39-b0fc-494a-ad3d-a556d824131a&page=queryresults
[0m16:12:08.713531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a97e7e83-e949-46f0-bd64-2ff4026bbfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a878890>]}
[0m16:12:08.714521 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dbt_calvin.customers .......................... [[32mCREATE VIEW (0 processed)[0m in 1.31s]
[0m16:12:08.715648 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m16:12:08.717075 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:12:08.717412 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m16:12:08.717766 [info ] [MainThread]: 
[0m16:12:08.718085 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.49 seconds (4.49s).
[0m16:12:08.718879 [debug] [MainThread]: Command end result
[0m16:12:08.741634 [info ] [MainThread]: 
[0m16:12:08.741882 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:12:08.742059 [info ] [MainThread]: 
[0m16:12:08.742242 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:12:08.743502 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.322857, "process_user_time": 1.618933, "process_kernel_time": 0.172099, "process_mem_max_rss": "207126528", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:12:08.743817 [debug] [MainThread]: Command `dbt run` succeeded at 16:12:08.743765 after 5.32 seconds
[0m16:12:08.744026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a37690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1009e1b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10093d6d0>]}
[0m16:12:08.744224 [debug] [MainThread]: Flushing usage events
[0m16:17:39.588489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096c6950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109748350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109748990>]}


============================== 16:17:39.590368 | 879cc16a-1641-4f9a-8dae-76b68c060fa8 ==============================
[0m16:17:39.590368 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:17:39.590661 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/CalvinLii/dbt-tutorial/jaffle_shop/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:17:39.903213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '879cc16a-1641-4f9a-8dae-76b68c060fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123412a10>]}
[0m16:17:39.921516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '879cc16a-1641-4f9a-8dae-76b68c060fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cad090>]}
[0m16:17:39.921753 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m16:17:39.930854 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:17:39.991256 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:17:39.991537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '879cc16a-1641-4f9a-8dae-76b68c060fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10837f650>]}
[0m16:17:40.348577 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m16:17:40.348830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '879cc16a-1641-4f9a-8dae-76b68c060fa8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123be9bd0>]}
[0m16:17:40.429532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '879cc16a-1641-4f9a-8dae-76b68c060fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123be7e50>]}
[0m16:17:40.463498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '879cc16a-1641-4f9a-8dae-76b68c060fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125c5ec50>]}
[0m16:17:40.463698 [info ] [MainThread]: Found 3 models, 9 data tests, 471 macros
[0m16:17:40.463845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '879cc16a-1641-4f9a-8dae-76b68c060fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123a4c410>]}
[0m16:17:40.464594 [info ] [MainThread]: 
[0m16:17:40.464824 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:17:40.466327 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m16:17:40.466510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:17:40.895792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_calvin)
[0m16:17:40.896720 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:17:41.716023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '879cc16a-1641-4f9a-8dae-76b68c060fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125abc2d0>]}
[0m16:17:41.717516 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:17:41.718208 [info ] [MainThread]: 
[0m16:17:41.721792 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m16:17:41.722582 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_calvin.stg_customers ........................... [RUN]
[0m16:17:41.723153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_calvin, now model.jaffle_shop.stg_customers)
[0m16:17:41.723536 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m16:17:41.730091 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m16:17:41.730959 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m16:17:41.752068 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m16:17:41.752553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:17:41.753585 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`stg_customers`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers;


[0m16:17:42.431474 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:f5230a8f-76f0-4a70-9533-097dc67297ff&page=queryresults
[0m16:17:43.218579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '879cc16a-1641-4f9a-8dae-76b68c060fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125c517d0>]}
[0m16:17:43.219228 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dbt_calvin.stg_customers ...................... [[32mCREATE VIEW (0 processed)[0m in 1.49s]
[0m16:17:43.219671 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m16:17:43.219974 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m16:17:43.220369 [info ] [Thread-1 (]: 2 of 3 START sql view model dbt_calvin.stg_orders .............................. [RUN]
[0m16:17:43.220752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m16:17:43.221009 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m16:17:43.222430 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m16:17:43.223040 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m16:17:43.224796 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m16:17:43.225189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:17:43.226253 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders;


[0m16:17:43.966882 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:6366598b-ceac-44a5-bd02-11c7dce3100f&page=queryresults
[0m16:17:44.464230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '879cc16a-1641-4f9a-8dae-76b68c060fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125c53c10>]}
[0m16:17:44.465387 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dbt_calvin.stg_orders ......................... [[32mCREATE VIEW (0 processed)[0m in 1.24s]
[0m16:17:44.465956 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m16:17:44.466788 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m16:17:44.467295 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_calvin.customers ............................... [RUN]
[0m16:17:44.467696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.customers)
[0m16:17:44.467993 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m16:17:44.471529 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m16:17:44.472336 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m16:17:44.474429 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m16:17:44.474903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:17:44.476272 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`customers`
  OPTIONS()
  as with customers as (

    select * from `dbt-tutorial-428919`.`dbt_calvin`.`stg_customers`

),

orders as (

    select * from `dbt-tutorial-428919`.`dbt_calvin`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


[0m16:17:45.502852 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:4a5e08a4-215a-47b9-a616-85813e6bb24b&page=queryresults
[0m16:17:45.915730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '879cc16a-1641-4f9a-8dae-76b68c060fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130125690>]}
[0m16:17:45.916749 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dbt_calvin.customers .......................... [[32mCREATE VIEW (0 processed)[0m in 1.45s]
[0m16:17:45.917321 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m16:17:45.918690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:17:45.919029 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m16:17:45.919368 [info ] [MainThread]: 
[0m16:17:45.919659 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 5.45 seconds (5.45s).
[0m16:17:45.920470 [debug] [MainThread]: Command end result
[0m16:17:45.942951 [info ] [MainThread]: 
[0m16:17:45.943198 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:17:45.943377 [info ] [MainThread]: 
[0m16:17:45.943563 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:17:45.944877 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.381336, "process_user_time": 1.690637, "process_kernel_time": 0.176138, "process_mem_max_rss": "212680704", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:17:45.945188 [debug] [MainThread]: Command `dbt run` succeeded at 16:17:45.945135 after 6.38 seconds
[0m16:17:45.945394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109597150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105305a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105261350>]}
[0m16:17:45.945592 [debug] [MainThread]: Flushing usage events
[0m16:19:42.956046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10917aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091fc610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091fcc50>]}


============================== 16:19:42.957687 | df939b19-65ad-4bd4-a57d-6259a5cbe44c ==============================
[0m16:19:42.957687 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:19:42.957957 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/CalvinLii/dbt-tutorial/jaffle_shop/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:19:43.259019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df939b19-65ad-4bd4-a57d-6259a5cbe44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e905d90>]}
[0m16:19:43.277490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df939b19-65ad-4bd4-a57d-6259a5cbe44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107760e90>]}
[0m16:19:43.277731 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m16:19:43.286191 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:19:43.363271 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:19:43.363675 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/schema.yml
[0m16:19:43.506362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df939b19-65ad-4bd4-a57d-6259a5cbe44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edc2950>]}
[0m16:19:43.538974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df939b19-65ad-4bd4-a57d-6259a5cbe44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef1ff10>]}
[0m16:19:43.539179 [info ] [MainThread]: Found 3 models, 9 data tests, 471 macros
[0m16:19:43.539326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df939b19-65ad-4bd4-a57d-6259a5cbe44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed2c790>]}
[0m16:19:43.540071 [info ] [MainThread]: 
[0m16:19:43.540287 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:19:43.541760 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m16:19:43.541930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:43.908763 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_calvin)
[0m16:19:43.909829 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:44.265998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df939b19-65ad-4bd4-a57d-6259a5cbe44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee84950>]}
[0m16:19:44.267085 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:19:44.267514 [info ] [MainThread]: 
[0m16:19:44.270692 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m16:19:44.271401 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_calvin.stg_customers ........................... [RUN]
[0m16:19:44.271906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_calvin, now model.jaffle_shop.stg_customers)
[0m16:19:44.272227 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m16:19:44.278610 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m16:19:44.279412 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m16:19:44.300350 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m16:19:44.300781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:44.301792 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`stg_customers`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers;


[0m16:19:44.919655 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:b3802b79-cb84-4aed-826a-12775a83c18c&page=queryresults
[0m16:19:45.463871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df939b19-65ad-4bd4-a57d-6259a5cbe44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea04e10>]}
[0m16:19:45.464604 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dbt_calvin.stg_customers ...................... [[32mCREATE VIEW (0 processed)[0m in 1.19s]
[0m16:19:45.465100 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m16:19:45.465452 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m16:19:45.465918 [info ] [Thread-1 (]: 2 of 3 START sql view model dbt_calvin.stg_orders .............................. [RUN]
[0m16:19:45.466341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m16:19:45.466599 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m16:19:45.468096 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m16:19:45.468746 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m16:19:45.472647 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m16:19:45.473155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:45.474410 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders;


[0m16:19:46.232939 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:fc0743ef-24ed-425e-92e1-3bc2ea6b195b&page=queryresults
[0m16:19:46.594856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df939b19-65ad-4bd4-a57d-6259a5cbe44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edf2890>]}
[0m16:19:46.595982 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dbt_calvin.stg_orders ......................... [[32mCREATE VIEW (0 processed)[0m in 1.13s]
[0m16:19:46.596536 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m16:19:46.597501 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m16:19:46.598183 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_calvin.customers ............................... [RUN]
[0m16:19:46.598598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.customers)
[0m16:19:46.598870 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m16:19:46.602248 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m16:19:46.602980 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m16:19:46.604922 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m16:19:46.605396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:46.606656 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`customers`
  OPTIONS()
  as with customers as (

    select * from `dbt-tutorial-428919`.`dbt_calvin`.`stg_customers`

),

orders as (

    select * from `dbt-tutorial-428919`.`dbt_calvin`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


[0m16:19:47.359010 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:f0741747-f567-4c72-8426-46e58eab756c&page=queryresults
[0m16:19:47.980659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df939b19-65ad-4bd4-a57d-6259a5cbe44c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef54550>]}
[0m16:19:47.981766 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dbt_calvin.customers .......................... [[32mCREATE VIEW (0 processed)[0m in 1.38s]
[0m16:19:47.982784 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m16:19:47.984480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:19:47.984897 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m16:19:47.985318 [info ] [MainThread]: 
[0m16:19:47.985676 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.44 seconds (4.44s).
[0m16:19:47.986583 [debug] [MainThread]: Command end result
[0m16:19:48.011923 [info ] [MainThread]: 
[0m16:19:48.012175 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:19:48.012352 [info ] [MainThread]: 
[0m16:19:48.012533 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:19:48.013804 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.0814533, "process_user_time": 1.408704, "process_kernel_time": 0.169501, "process_mem_max_rss": "209305600", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:19:48.014123 [debug] [MainThread]: Command `dbt run` succeeded at 16:19:48.014071 after 5.08 seconds
[0m16:19:48.014328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091fec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091fc910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d14a90>]}
[0m16:19:48.014529 [debug] [MainThread]: Flushing usage events
[0m16:20:36.488397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123687f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236d4d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236d5390>]}


============================== 16:20:36.490136 | 05a631c2-2d19-4598-b28b-fd6d05ff4e70 ==============================
[0m16:20:36.490136 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:20:36.490407 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/CalvinLii/dbt-tutorial/jaffle_shop/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:20:36.791589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05a631c2-2d19-4598-b28b-fd6d05ff4e70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127c97b50>]}
[0m16:20:36.809983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05a631c2-2d19-4598-b28b-fd6d05ff4e70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d78d10>]}
[0m16:20:36.810224 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m16:20:36.818692 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:20:36.895869 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:20:36.896294 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/schema.yml
[0m16:20:37.039777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05a631c2-2d19-4598-b28b-fd6d05ff4e70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136ef7910>]}
[0m16:20:37.045551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05a631c2-2d19-4598-b28b-fd6d05ff4e70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137310c90>]}
[0m16:20:37.045756 [info ] [MainThread]: Found 3 models, 9 data tests, 471 macros
[0m16:20:37.045904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05a631c2-2d19-4598-b28b-fd6d05ff4e70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136bccf50>]}
[0m16:20:37.046705 [info ] [MainThread]: 
[0m16:20:37.046925 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:20:37.048370 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919_dbt_calvin'
[0m16:20:37.048528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:37.385234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05a631c2-2d19-4598-b28b-fd6d05ff4e70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136e83890>]}
[0m16:20:37.386156 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:20:37.386683 [info ] [MainThread]: 
[0m16:20:37.389631 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m16:20:37.390184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_calvin, now model.jaffle_shop.stg_customers)
[0m16:20:37.390543 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m16:20:37.398223 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m16:20:37.399283 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m16:20:37.399992 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m16:20:37.400377 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m16:20:37.400863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m16:20:37.401269 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m16:20:37.402823 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m16:20:37.403326 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m16:20:37.403799 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m16:20:37.404094 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:20:37.404432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m16:20:37.404821 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:20:37.411259 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:20:37.411790 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:20:37.412207 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:20:37.412461 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m16:20:37.412721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.jaffle_shop.unique_stg_customers_customer_id.c7614daada)
[0m16:20:37.412942 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m16:20:37.418155 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m16:20:37.418540 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m16:20:37.418915 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m16:20:37.419147 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m16:20:37.419373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_customers_customer_id.c7614daada, now model.jaffle_shop.customers)
[0m16:20:37.419562 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m16:20:37.421322 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m16:20:37.421701 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m16:20:37.422155 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m16:20:37.422385 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m16:20:37.422683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.customers, now test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad)
[0m16:20:37.422902 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m16:20:37.425522 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m16:20:37.425901 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m16:20:37.426276 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m16:20:37.426498 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m16:20:37.426713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad, now test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5)
[0m16:20:37.426892 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m16:20:37.429075 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m16:20:37.429377 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m16:20:37.429688 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m16:20:37.429892 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m16:20:37.430094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m16:20:37.430276 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m16:20:37.432486 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m16:20:37.432784 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m16:20:37.433089 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m16:20:37.433281 [debug] [Thread-1 (]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m16:20:37.433473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m16:20:37.433651 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m16:20:37.436154 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m16:20:37.436457 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m16:20:37.436762 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m16:20:37.436953 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m16:20:37.437137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m16:20:37.437316 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m16:20:37.439230 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m16:20:37.439542 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m16:20:37.439825 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m16:20:37.440019 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:20:37.440199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a, now test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d)
[0m16:20:37.440365 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:20:37.442215 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m16:20:37.442472 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:20:37.442747 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:20:37.442925 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:20:37.443096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d, now test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1)
[0m16:20:37.443248 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:20:37.445090 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m16:20:37.445375 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:20:37.445646 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:20:37.446087 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:20:37.446222 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m16:20:37.447002 [debug] [MainThread]: Command end result
[0m16:20:37.483600 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m16:20:37.483743 [info ] [MainThread]: Building catalog
[0m16:20:37.485606 [debug] [ThreadPool]: Acquiring new bigquery connection 'dbt-tutorial-428919.information_schema'
[0m16:20:37.493146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:37.494054 [debug] [ThreadPool]: On dbt-tutorial-428919.information_schema: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "dbt-tutorial-428919.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `dbt-tutorial-428919`.`dbt_calvin`.__TABLES__ tables
    left join `dbt-tutorial-428919`.`dbt_calvin`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `dbt-tutorial-428919`.`dbt_calvin`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dbt_calvin')
                            and upper(table_name) = upper('customers')
                            ) or (
                                upper(table_schema) = upper('dbt_calvin')
                            and upper(table_name) = upper('stg_orders')
                            ) or (
                                upper(table_schema) = upper('dbt_calvin')
                            and upper(table_name) = upper('stg_customers')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `dbt-tutorial-428919`.`dbt_calvin`.INFORMATION_SCHEMA.COLUMNS columns
    join `dbt-tutorial-428919`.`dbt_calvin`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m16:20:38.048694 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:3881b743-685d-4f4d-b7dc-bb4ca1ca5be8&page=queryresults
[0m16:20:40.242654 [info ] [MainThread]: Catalog written to /Users/CalvinLii/dbt-tutorial/jaffle_shop/target/catalog.json
[0m16:20:40.244054 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 3.7799752, "process_user_time": 1.239099, "process_kernel_time": 0.160845, "process_mem_max_rss": "213024768", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:20:40.244429 [debug] [MainThread]: Command `dbt docs generate` succeeded at 16:20:40.244373 after 3.78 seconds
[0m16:20:40.244601 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m16:20:40.244738 [debug] [MainThread]: Connection 'dbt-tutorial-428919.information_schema' was properly closed.
[0m16:20:40.244898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121052610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12293b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105458b10>]}
[0m16:20:40.245094 [debug] [MainThread]: Flushing usage events
[0m16:20:45.385210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088544d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088a1e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d51d0>]}


============================== 16:20:45.387173 | df7d319f-a5fa-4763-ac3b-2180aeebd010 ==============================
[0m16:20:45.387173 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:20:45.387468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/CalvinLii/dbt-tutorial/jaffle_shop/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:20:45.698167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df7d319f-a5fa-4763-ac3b-2180aeebd010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3fa210>]}
[0m16:20:45.716402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df7d319f-a5fa-4763-ac3b-2180aeebd010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e79050>]}
[0m16:21:57.129358 [error] [MainThread]: Encountered an error:

[0m16:21:57.136028 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/CalvinLii/dbt-env/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/CalvinLii/dbt-env/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/CalvinLii/dbt-env/lib/python3.11/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/CalvinLii/dbt-env/lib/python3.11/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/CalvinLii/dbt-env/lib/python3.11/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/CalvinLii/dbt-env/lib/python3.11/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/CalvinLii/dbt-env/lib/python3.11/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/opt/anaconda3/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m16:21:57.138535 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 71.77977, "process_user_time": 0.827737, "process_kernel_time": 0.14434, "process_mem_max_rss": "199311360", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:21:57.139180 [debug] [MainThread]: Command `dbt docs serve` failed at 16:21:57.139087 after 71.78 seconds
[0m16:21:57.139625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088a1350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d6c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f15ee50>]}
[0m16:21:57.140022 [debug] [MainThread]: Flushing usage events
[0m09:15:44.225290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f47050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa3fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa3f90>]}


============================== 09:15:44.227510 | 29fc9f44-1fa8-4c11-83ec-f6b4079b69cb ==============================
[0m09:15:44.227510 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:15:44.227824 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'log_path': '/Users/CalvinLii/dbt-tutorial/jaffle_shop/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:15:44.235052 [info ] [MainThread]: dbt version: 1.8.3
[0m09:15:44.235227 [info ] [MainThread]: python version: 3.11.7
[0m09:15:44.235366 [info ] [MainThread]: python path: /Users/CalvinLii/dbt-env/bin/python
[0m09:15:44.235481 [info ] [MainThread]: os info: macOS-14.0-arm64-arm-64bit
[0m09:15:44.703620 [info ] [MainThread]: Using profiles dir at /Users/CalvinLii/.dbt
[0m09:15:44.703859 [info ] [MainThread]: Using profiles.yml file at /Users/CalvinLii/.dbt/profiles.yml
[0m09:15:44.703989 [info ] [MainThread]: Using dbt_project.yml file at /Users/CalvinLii/dbt-tutorial/jaffle_shop/dbt_project.yml
[0m09:15:44.704106 [info ] [MainThread]: adapter type: bigquery
[0m09:15:44.704218 [info ] [MainThread]: adapter version: 1.8.2
[0m09:15:44.733385 [info ] [MainThread]: Configuration:
[0m09:15:44.733554 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:15:44.733679 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:15:44.733793 [info ] [MainThread]: Required dependencies:
[0m09:15:44.733935 [debug] [MainThread]: Executing "git --help"
[0m09:15:44.740356 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:15:44.740786 [debug] [MainThread]: STDERR: "b''"
[0m09:15:44.740929 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:15:44.741075 [info ] [MainThread]: Connection:
[0m09:15:44.741287 [info ] [MainThread]:   method: service-account
[0m09:15:44.741393 [info ] [MainThread]:   database: dbt-tutorial-428919
[0m09:15:44.741504 [info ] [MainThread]:   execution_project: dbt-tutorial-428919
[0m09:15:44.741609 [info ] [MainThread]:   schema: dbt_calvin
[0m09:15:44.741712 [info ] [MainThread]:   location: US
[0m09:15:44.741811 [info ] [MainThread]:   priority: interactive
[0m09:15:44.741911 [info ] [MainThread]:   maximum_bytes_billed: None
[0m09:15:44.742016 [info ] [MainThread]:   impersonate_service_account: None
[0m09:15:44.742113 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m09:15:44.742213 [info ] [MainThread]:   job_retries: 1
[0m09:15:44.742313 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m09:15:44.742411 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m09:15:44.742512 [info ] [MainThread]:   timeout_seconds: 300
[0m09:15:44.742613 [info ] [MainThread]:   client_id: None
[0m09:15:44.742710 [info ] [MainThread]:   token_uri: None
[0m09:15:44.742808 [info ] [MainThread]:   dataproc_region: None
[0m09:15:44.742905 [info ] [MainThread]:   dataproc_cluster_name: None
[0m09:15:44.743002 [info ] [MainThread]:   gcs_bucket: None
[0m09:15:44.743097 [info ] [MainThread]:   dataproc_batch: None
[0m09:15:44.743323 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m09:15:44.747023 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m09:15:44.747591 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:15:44.749029 [debug] [MainThread]: On debug: select 1 as id
[0m09:15:45.248745 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:4b082e92-6daa-492a-97c2-0ee3c0a09527&page=queryresults
[0m09:15:45.863541 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:15:45.864584 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:15:45.869809 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.6711096, "process_user_time": 0.815176, "process_kernel_time": 0.173127, "process_mem_max_rss": "196575232", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:15:45.870830 [debug] [MainThread]: Command `dbt debug` succeeded at 09:15:45.870705 after 1.67 seconds
[0m09:15:45.871302 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:15:45.871729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fcc550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f908d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057c7850>]}
[0m09:15:45.872211 [debug] [MainThread]: Flushing usage events
[0m09:15:48.333872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10980ad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109890490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109890ad0>]}


============================== 09:15:48.335574 | 20da23cc-2f58-41e0-af28-56b4c5e1005e ==============================
[0m09:15:48.335574 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:15:48.335843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/CalvinLii/dbt-tutorial/jaffle_shop/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:15:48.636880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20da23cc-2f58-41e0-af28-56b4c5e1005e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecab750>]}
[0m09:15:48.655320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20da23cc-2f58-41e0-af28-56b4c5e1005e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df0ed0>]}
[0m09:15:48.655568 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m09:15:48.664414 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:15:48.732852 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:15:48.733141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '20da23cc-2f58-41e0-af28-56b4c5e1005e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085491d0>]}
[0m09:15:49.171218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20da23cc-2f58-41e0-af28-56b4c5e1005e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3d9e50>]}
[0m09:15:49.205503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20da23cc-2f58-41e0-af28-56b4c5e1005e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f454c50>]}
[0m09:15:49.205716 [info ] [MainThread]: Found 3 models, 9 data tests, 471 macros
[0m09:15:49.205864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20da23cc-2f58-41e0-af28-56b4c5e1005e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f291410>]}
[0m09:15:49.206610 [info ] [MainThread]: 
[0m09:15:49.206821 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:15:49.208312 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m09:15:49.208481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:15:49.603296 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_calvin)
[0m09:15:49.604063 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:15:50.063839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20da23cc-2f58-41e0-af28-56b4c5e1005e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f29c410>]}
[0m09:15:50.065479 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:15:50.066211 [info ] [MainThread]: 
[0m09:15:50.071581 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m09:15:50.072390 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_calvin.stg_customers ........................... [RUN]
[0m09:15:50.072977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_calvin, now model.jaffle_shop.stg_customers)
[0m09:15:50.073371 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m09:15:50.079887 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m09:15:50.080952 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m09:15:50.102218 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m09:15:50.102765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:15:50.103841 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`stg_customers`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers;


[0m09:15:50.983325 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:1c12ac77-af0a-45aa-bdd7-8467c87404cb&page=queryresults
[0m09:15:51.537162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20da23cc-2f58-41e0-af28-56b4c5e1005e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f48d290>]}
[0m09:15:51.537889 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dbt_calvin.stg_customers ...................... [[32mCREATE VIEW (0 processed)[0m in 1.46s]
[0m09:15:51.538380 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m09:15:51.538726 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m09:15:51.539185 [info ] [Thread-1 (]: 2 of 3 START sql view model dbt_calvin.stg_orders .............................. [RUN]
[0m09:15:51.539623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m09:15:51.539904 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m09:15:51.541600 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m09:15:51.542266 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m09:15:51.544503 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m09:15:51.544945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:15:51.546192 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders;


[0m09:15:52.511265 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:27551843-635f-4dc6-96e1-c0b31488c000&page=queryresults
[0m09:15:52.999862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20da23cc-2f58-41e0-af28-56b4c5e1005e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f53b050>]}
[0m09:15:53.000995 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dbt_calvin.stg_orders ......................... [[32mCREATE VIEW (0 processed)[0m in 1.46s]
[0m09:15:53.002263 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m09:15:53.003372 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m09:15:53.003944 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_calvin.customers ............................... [RUN]
[0m09:15:53.004478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.customers)
[0m09:15:53.004850 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m09:15:53.009078 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m09:15:53.009846 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m09:15:53.014324 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m09:15:53.014830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:15:53.016244 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`customers`
  OPTIONS()
  as with customers as (

    select * from `dbt-tutorial-428919`.`dbt_calvin`.`stg_customers`

),

orders as (

    select * from `dbt-tutorial-428919`.`dbt_calvin`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


[0m09:15:53.952654 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:5975fb7a-a257-48d9-a4b0-8157f718f416&page=queryresults
[0m09:15:55.048359 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20da23cc-2f58-41e0-af28-56b4c5e1005e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f09af10>]}
[0m09:15:55.050259 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dbt_calvin.customers .......................... [[32mCREATE VIEW (0 processed)[0m in 2.04s]
[0m09:15:55.051369 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m09:15:55.053229 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:15:55.053715 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m09:15:55.054080 [info ] [MainThread]: 
[0m09:15:55.054392 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 5.85 seconds (5.85s).
[0m09:15:55.055222 [debug] [MainThread]: Command end result
[0m09:15:55.077692 [info ] [MainThread]: 
[0m09:15:55.077985 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:15:55.078170 [info ] [MainThread]: 
[0m09:15:55.078357 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:15:55.079676 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.7699485, "process_user_time": 1.704903, "process_kernel_time": 0.170587, "process_mem_max_rss": "214401024", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:15:55.079987 [debug] [MainThread]: Command `dbt run` succeeded at 09:15:55.079936 after 6.77 seconds
[0m09:15:55.080193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10985bdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105449b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053a56d0>]}
[0m09:15:55.080389 [debug] [MainThread]: Flushing usage events
[0m10:09:43.532450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10981e550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a45d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a4c10>]}


============================== 10:09:43.534714 | c2f18537-02ec-4700-ab37-af29573cdab1 ==============================
[0m10:09:43.534714 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:09:43.534982 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/CalvinLii/dbt-tutorial/jaffle_shop/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:09:44.064570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2f18537-02ec-4700-ab37-af29573cdab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118e27790>]}
[0m10:09:44.083095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2f18537-02ec-4700-ab37-af29573cdab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e051d0>]}
[0m10:09:44.083335 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m10:09:44.093125 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m10:09:44.183973 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:09:44.184195 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:09:44.198609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2f18537-02ec-4700-ab37-af29573cdab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11935a190>]}
[0m10:09:44.237743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2f18537-02ec-4700-ab37-af29573cdab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a982d0>]}
[0m10:09:44.237947 [info ] [MainThread]: Found 3 models, 9 data tests, 471 macros
[0m10:09:44.238095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2f18537-02ec-4700-ab37-af29573cdab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1192599d0>]}
[0m10:09:44.238841 [info ] [MainThread]: 
[0m10:09:44.239071 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:09:44.240559 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m10:09:44.240747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:09:44.661327 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_calvin)
[0m10:09:44.662383 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:09:45.106743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2f18537-02ec-4700-ab37-af29573cdab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092adf90>]}
[0m10:09:45.107607 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:09:45.108018 [info ] [MainThread]: 
[0m10:09:45.113411 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m10:09:45.114103 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_calvin.stg_customers ........................... [RUN]
[0m10:09:45.114583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_calvin, now model.jaffle_shop.stg_customers)
[0m10:09:45.114902 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m10:09:45.122429 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m10:09:45.123338 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m10:09:45.144008 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m10:09:45.144618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:09:45.145701 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`stg_customers`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers;


[0m10:09:46.028855 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:01c5133b-b974-4eb1-ae20-94a196f450a8&page=queryresults
[0m10:09:46.708517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2f18537-02ec-4700-ab37-af29573cdab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109860a10>]}
[0m10:09:46.708906 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dbt_calvin.stg_customers ...................... [[32mCREATE VIEW (0 processed)[0m in 1.59s]
[0m10:09:46.709180 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m10:09:46.709372 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m10:09:46.709577 [info ] [Thread-1 (]: 2 of 3 START sql view model dbt_calvin.stg_orders .............................. [RUN]
[0m10:09:46.709911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m10:09:46.710215 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m10:09:46.711353 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m10:09:46.711737 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m10:09:46.714291 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m10:09:46.714611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:09:46.715416 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders;


[0m10:09:47.357415 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:2fe3f2c4-bba9-4910-9232-7606ef6f8c46&page=queryresults
[0m10:09:47.891774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2f18537-02ec-4700-ab37-af29573cdab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11966e450>]}
[0m10:09:47.892725 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dbt_calvin.stg_orders ......................... [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m10:09:47.893282 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m10:09:47.894405 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m10:09:47.895128 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_calvin.customers ............................... [RUN]
[0m10:09:47.895616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.customers)
[0m10:09:47.895946 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m10:09:47.899577 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m10:09:47.901408 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m10:09:47.903780 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m10:09:47.904303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:09:47.905729 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`customers`
  OPTIONS()
  as with customers as (

    select * from `dbt-tutorial-428919`.`dbt_calvin`.`stg_customers`

),

orders as (

    select * from `dbt-tutorial-428919`.`dbt_calvin`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


[0m10:09:48.791415 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:714aaedb-ca83-4ae0-a0b7-1bfe6e98d2b5&page=queryresults
[0m10:09:49.130542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2f18537-02ec-4700-ab37-af29573cdab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119676850>]}
[0m10:09:49.131647 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dbt_calvin.customers .......................... [[32mCREATE VIEW (0 processed)[0m in 1.23s]
[0m10:09:49.132408 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m10:09:49.133929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:09:49.134251 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m10:09:49.135167 [info ] [MainThread]: 
[0m10:09:49.135632 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.90 seconds (4.90s).
[0m10:09:49.136651 [debug] [MainThread]: Command end result
[0m10:09:49.162999 [info ] [MainThread]: 
[0m10:09:49.163283 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:09:49.163464 [info ] [MainThread]: 
[0m10:09:49.163648 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:09:49.165571 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.660513, "process_user_time": 1.279985, "process_kernel_time": 0.222153, "process_mem_max_rss": "204177408", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:09:49.165889 [debug] [MainThread]: Command `dbt run` succeeded at 10:09:49.165837 after 5.66 seconds
[0m10:09:49.166102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10986cfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a68d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10545da90>]}
[0m10:09:49.166312 [debug] [MainThread]: Flushing usage events
[0m10:14:38.426805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054dd350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105538290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105561110>]}


============================== 10:14:38.428590 | eed25165-e0cc-464a-97f7-b840f9a6b38d ==============================
[0m10:14:38.428590 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:14:38.428860 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'log_path': '/Users/CalvinLii/dbt-tutorial/curriculum_rec/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:14:38.731548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eed25165-e0cc-464a-97f7-b840f9a6b38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acdf0d0>]}
[0m10:14:38.750069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eed25165-e0cc-464a-97f7-b840f9a6b38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ac51d0>]}
[0m10:14:38.750302 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m10:14:38.758952 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m10:14:38.827655 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:14:38.827934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eed25165-e0cc-464a-97f7-b840f9a6b38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041d8f90>]}
[0m10:14:39.254487 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.curriculum_rec.staging
- models.curriculum_rec
[0m10:14:39.256596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eed25165-e0cc-464a-97f7-b840f9a6b38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ac4050>]}
[0m10:14:39.289074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eed25165-e0cc-464a-97f7-b840f9a6b38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b26d690>]}
[0m10:14:39.289340 [info ] [MainThread]: Found 3 models, 9 data tests, 471 macros
[0m10:14:39.289502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eed25165-e0cc-464a-97f7-b840f9a6b38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af83a10>]}
[0m10:14:39.290336 [info ] [MainThread]: 
[0m10:14:39.290567 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:14:39.292110 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m10:14:39.292288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:14:39.714136 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_calvin)
[0m10:14:39.715327 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:14:40.226514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eed25165-e0cc-464a-97f7-b840f9a6b38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b026fd0>]}
[0m10:14:40.227596 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:14:40.228095 [info ] [MainThread]: 
[0m10:14:40.231033 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m10:14:40.231686 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_calvin.stg_customers ........................... [RUN]
[0m10:14:40.232171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_calvin, now model.jaffle_shop.stg_customers)
[0m10:14:40.232997 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m10:14:40.240280 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m10:14:40.241148 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m10:14:40.262557 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m10:14:40.262983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:14:40.263993 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`stg_customers`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers;


[0m10:14:41.062145 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:2deb93d9-01b9-4ab8-aba7-5e0c184ae189&page=queryresults
[0m10:14:41.596457 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eed25165-e0cc-464a-97f7-b840f9a6b38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aed6050>]}
[0m10:14:41.596935 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dbt_calvin.stg_customers ...................... [[32mCREATE VIEW (0 processed)[0m in 1.36s]
[0m10:14:41.597299 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m10:14:41.597567 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m10:14:41.597939 [info ] [Thread-1 (]: 2 of 3 START sql view model dbt_calvin.stg_orders .............................. [RUN]
[0m10:14:41.598242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m10:14:41.598454 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m10:14:41.599635 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m10:14:41.600056 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m10:14:41.601649 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m10:14:41.601990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:14:41.602935 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders;


[0m10:14:42.476436 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:98f909be-7bf4-4a37-913f-667caf02cc1d&page=queryresults
[0m10:14:43.035124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eed25165-e0cc-464a-97f7-b840f9a6b38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b12cc50>]}
[0m10:14:43.036212 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dbt_calvin.stg_orders ......................... [[32mCREATE VIEW (0 processed)[0m in 1.44s]
[0m10:14:43.037432 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m10:14:43.038759 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m10:14:43.039509 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_calvin.customers ............................... [RUN]
[0m10:14:43.040153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.customers)
[0m10:14:43.040533 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m10:14:43.044465 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m10:14:43.045284 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m10:14:43.049716 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m10:14:43.050243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:14:43.051677 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`customers`
  OPTIONS()
  as with customers as (

    select * from `dbt-tutorial-428919`.`dbt_calvin`.`stg_customers`

),

orders as (

    select * from `dbt-tutorial-428919`.`dbt_calvin`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


[0m10:14:43.812734 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:e23d98d4-581e-4d51-99ed-07444e676182&page=queryresults
[0m10:14:44.184358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eed25165-e0cc-464a-97f7-b840f9a6b38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b085450>]}
[0m10:14:44.185531 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dbt_calvin.customers .......................... [[32mCREATE VIEW (0 processed)[0m in 1.14s]
[0m10:14:44.186371 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m10:14:44.187974 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:14:44.188287 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m10:14:44.189256 [info ] [MainThread]: 
[0m10:14:44.189689 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.90 seconds (4.90s).
[0m10:14:44.190753 [debug] [MainThread]: Command end result
[0m10:14:44.215581 [info ] [MainThread]: 
[0m10:14:44.215845 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:14:44.216031 [info ] [MainThread]: 
[0m10:14:44.216223 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:14:44.217519 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.815234, "process_user_time": 1.689765, "process_kernel_time": 0.182812, "process_mem_max_rss": "213483520", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:14:44.217815 [debug] [MainThread]: Command `dbt run` succeeded at 10:14:44.217764 after 5.82 seconds
[0m10:14:44.218020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10552ea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10111da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101079350>]}
[0m10:14:44.218214 [debug] [MainThread]: Flushing usage events
[0m10:16:55.788823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b92e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c18550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c18b90>]}


============================== 10:16:55.790499 | dda8e2fb-3d86-45be-97ce-4ab2050b27fc ==============================
[0m10:16:55.790499 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:16:55.790777 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/CalvinLii/dbt-tutorial/curriculum_rec/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:16:55.792090 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'curriculum_rec'
[0m10:16:55.792733 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.028026626, "process_user_time": 0.498612, "process_kernel_time": 0.074658, "process_mem_max_rss": "111443968", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:16:55.792975 [debug] [MainThread]: Command `dbt run` failed at 10:16:55.792933 after 0.03 seconds
[0m10:16:55.793151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c25190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c1aad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c4d250>]}
[0m10:16:55.793297 [debug] [MainThread]: Flushing usage events
[0m10:17:15.325579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105102950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105184810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105184e50>]}


============================== 10:17:15.327303 | dbd4dfc3-3ddc-4ba9-84e1-ef54baf37bcf ==============================
[0m10:17:15.327303 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:17:15.327567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/CalvinLii/dbt-tutorial/curriculum_rec/logs', 'version_check': 'True', 'profiles_dir': '/Users/CalvinLii/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:17:15.629370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbd4dfc3-3ddc-4ba9-84e1-ef54baf37bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b47a850>]}
[0m10:17:15.647928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbd4dfc3-3ddc-4ba9-84e1-ef54baf37bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036e8cd0>]}
[0m10:17:15.648162 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m10:17:15.656787 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m10:17:15.725207 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m10:17:15.725491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dbd4dfc3-3ddc-4ba9-84e1-ef54baf37bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dfcd10>]}
[0m10:17:16.153066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbd4dfc3-3ddc-4ba9-84e1-ef54baf37bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb8ef10>]}
[0m10:17:16.185403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbd4dfc3-3ddc-4ba9-84e1-ef54baf37bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc64910>]}
[0m10:17:16.185658 [info ] [MainThread]: Found 3 models, 9 data tests, 471 macros
[0m10:17:16.185818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbd4dfc3-3ddc-4ba9-84e1-ef54baf37bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eed0fd0>]}
[0m10:17:16.186610 [info ] [MainThread]: 
[0m10:17:16.186838 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:17:16.188342 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m10:17:16.188504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:16.539655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_calvin)
[0m10:17:16.540364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:17:17.001955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbd4dfc3-3ddc-4ba9-84e1-ef54baf37bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9b8210>]}
[0m10:17:17.003036 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:17:17.003551 [info ] [MainThread]: 
[0m10:17:17.006495 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_customers
[0m10:17:17.007116 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_calvin.stg_customers ........................... [RUN]
[0m10:17:17.007600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_calvin, now model.curriculum_rec.stg_customers)
[0m10:17:17.008362 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_customers
[0m10:17:17.015633 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_customers"
[0m10:17:17.016531 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_customers
[0m10:17:17.037958 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_customers"
[0m10:17:17.038494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:17.039515 [debug] [Thread-1 (]: On model.curriculum_rec.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.curriculum_rec.stg_customers"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`stg_customers`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers;


[0m10:17:17.819889 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:1b92f598-8c79-4699-9f98-0ffd624a3141&page=queryresults
[0m10:17:18.397860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbd4dfc3-3ddc-4ba9-84e1-ef54baf37bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc64710>]}
[0m10:17:18.398479 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dbt_calvin.stg_customers ...................... [[32mCREATE VIEW (0 processed)[0m in 1.39s]
[0m10:17:18.398909 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_customers
[0m10:17:18.399195 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_orders
[0m10:17:18.399564 [info ] [Thread-1 (]: 2 of 3 START sql view model dbt_calvin.stg_orders .............................. [RUN]
[0m10:17:18.399811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_customers, now model.curriculum_rec.stg_orders)
[0m10:17:18.400007 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_orders
[0m10:17:18.401299 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_orders"
[0m10:17:18.401824 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_orders
[0m10:17:18.403633 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_orders"
[0m10:17:18.403993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:18.405029 [debug] [Thread-1 (]: On model.curriculum_rec.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.curriculum_rec.stg_orders"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders;


[0m10:17:19.212557 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:f0a53fc3-b5db-4ecd-ae9c-035e603060ba&page=queryresults
[0m10:17:19.743678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbd4dfc3-3ddc-4ba9-84e1-ef54baf37bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb5f8d0>]}
[0m10:17:19.744889 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dbt_calvin.stg_orders ......................... [[32mCREATE VIEW (0 processed)[0m in 1.34s]
[0m10:17:19.745622 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_orders
[0m10:17:19.746648 [debug] [Thread-1 (]: Began running node model.curriculum_rec.customers
[0m10:17:19.747838 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_calvin.customers ............................... [RUN]
[0m10:17:19.748464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_orders, now model.curriculum_rec.customers)
[0m10:17:19.748869 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.customers
[0m10:17:19.753053 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.customers"
[0m10:17:19.753816 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.customers
[0m10:17:19.758430 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.customers"
[0m10:17:19.758971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:19.760398 [debug] [Thread-1 (]: On model.curriculum_rec.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.curriculum_rec.customers"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`customers`
  OPTIONS()
  as with customers as (

    select * from `dbt-tutorial-428919`.`dbt_calvin`.`stg_customers`

),

orders as (

    select * from `dbt-tutorial-428919`.`dbt_calvin`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


[0m10:17:20.583426 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:2b957a26-5500-4d05-acff-cf04e8bdea2d&page=queryresults
[0m10:17:21.239075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbd4dfc3-3ddc-4ba9-84e1-ef54baf37bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118131090>]}
[0m10:17:21.240276 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dbt_calvin.customers .......................... [[32mCREATE VIEW (0 processed)[0m in 1.49s]
[0m10:17:21.241560 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.customers
[0m10:17:21.243145 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:17:21.243575 [debug] [MainThread]: Connection 'model.curriculum_rec.customers' was properly closed.
[0m10:17:21.243994 [info ] [MainThread]: 
[0m10:17:21.244352 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 5.06 seconds (5.06s).
[0m10:17:21.245190 [debug] [MainThread]: Command end result
[0m10:17:21.269019 [info ] [MainThread]: 
[0m10:17:21.269273 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:17:21.269451 [info ] [MainThread]: 
[0m10:17:21.269638 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:17:21.270957 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.969366, "process_user_time": 1.690245, "process_kernel_time": 0.167469, "process_mem_max_rss": "211927040", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:17:21.271277 [debug] [MainThread]: Command `dbt run` succeeded at 10:17:21.271220 after 5.97 seconds
[0m10:17:21.271489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105133bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d41a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100c9d350>]}
[0m10:17:21.271709 [debug] [MainThread]: Flushing usage events
[0m10:18:41.861850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b97390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c18890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c18ed0>]}


============================== 10:18:41.863510 | 34d6f717-bc7d-47b6-aaff-f0ff06bc39dc ==============================
[0m10:18:41.863510 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:18:41.863809 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/CalvinLii/dbt-tutorial/curriculum_rec/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:18:41.865109 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'curriculum_rec'
[0m10:18:41.865747 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.028164541, "process_user_time": 0.49814, "process_kernel_time": 0.074485, "process_mem_max_rss": "108888064", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:18:41.865979 [debug] [MainThread]: Command `dbt run` failed at 10:18:41.865938 after 0.03 seconds
[0m10:18:41.866159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bf08d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c18cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c1aed0>]}
[0m10:18:41.866305 [debug] [MainThread]: Flushing usage events
[0m10:18:50.802493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10928ae90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10930c810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10930ce50>]}


============================== 10:18:50.804208 | 989bad78-3c2c-47b9-9677-2ffa73380e0c ==============================
[0m10:18:50.804208 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:18:50.804476 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/CalvinLii/.dbt', 'log_path': '/Users/CalvinLii/dbt-tutorial/curriculum_rec/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:18:51.105260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '989bad78-3c2c-47b9-9677-2ffa73380e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e73f790>]}
[0m10:18:51.123738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '989bad78-3c2c-47b9-9677-2ffa73380e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb2e550>]}
[0m10:18:51.123985 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m10:18:51.132445 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m10:18:51.201030 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:18:51.201319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '989bad78-3c2c-47b9-9677-2ffa73380e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fccfd0>]}
[0m10:18:51.627240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '989bad78-3c2c-47b9-9677-2ffa73380e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed4bc10>]}
[0m10:18:51.659714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '989bad78-3c2c-47b9-9677-2ffa73380e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0199d0>]}
[0m10:18:51.659915 [info ] [MainThread]: Found 3 models, 9 data tests, 471 macros
[0m10:18:51.660061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '989bad78-3c2c-47b9-9677-2ffa73380e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec3ef50>]}
[0m10:18:51.660818 [info ] [MainThread]: 
[0m10:18:51.661030 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:18:51.662528 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m10:18:51.662703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:18:52.040467 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_calvin)
[0m10:18:52.041304 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:18:52.411803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '989bad78-3c2c-47b9-9677-2ffa73380e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9ebb50>]}
[0m10:18:52.413214 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:18:52.413649 [info ] [MainThread]: 
[0m10:18:52.417103 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_customers
[0m10:18:52.417939 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_calvin.stg_customers ........................... [RUN]
[0m10:18:52.418551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_calvin, now model.curriculum_rec.stg_customers)
[0m10:18:52.418948 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_customers
[0m10:18:52.425775 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_customers"
[0m10:18:52.426699 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_customers
[0m10:18:52.447764 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_customers"
[0m10:18:52.448193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:18:52.449428 [debug] [Thread-1 (]: On model.curriculum_rec.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec", "target_name": "dev", "node_id": "model.curriculum_rec.stg_customers"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`stg_customers`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers;


[0m10:18:53.256212 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:2272d9b4-7496-4c32-8302-55ee49dacf51&page=queryresults
[0m10:18:53.810785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '989bad78-3c2c-47b9-9677-2ffa73380e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f01a490>]}
[0m10:18:53.811527 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dbt_calvin.stg_customers ...................... [[32mCREATE VIEW (0 processed)[0m in 1.39s]
[0m10:18:53.811964 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_customers
[0m10:18:53.812282 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_orders
[0m10:18:53.812784 [info ] [Thread-1 (]: 2 of 3 START sql view model dbt_calvin.stg_orders .............................. [RUN]
[0m10:18:53.813146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_customers, now model.curriculum_rec.stg_orders)
[0m10:18:53.813397 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_orders
[0m10:18:53.815022 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_orders"
[0m10:18:53.815661 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_orders
[0m10:18:53.817760 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_orders"
[0m10:18:53.818174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:18:53.819325 [debug] [Thread-1 (]: On model.curriculum_rec.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec", "target_name": "dev", "node_id": "model.curriculum_rec.stg_orders"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders;


[0m10:18:54.457256 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:b0b5c355-78af-4478-bc60-49551bc0aa90&page=queryresults
[0m10:18:54.946256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '989bad78-3c2c-47b9-9677-2ffa73380e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f068c50>]}
[0m10:18:54.947471 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dbt_calvin.stg_orders ......................... [[32mCREATE VIEW (0 processed)[0m in 1.13s]
[0m10:18:54.948188 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_orders
[0m10:18:54.949375 [debug] [Thread-1 (]: Began running node model.curriculum_rec.customers
[0m10:18:54.950559 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_calvin.customers ............................... [RUN]
[0m10:18:54.951290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_orders, now model.curriculum_rec.customers)
[0m10:18:54.951717 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.customers
[0m10:18:54.956154 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.customers"
[0m10:18:54.957069 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.customers
[0m10:18:54.962404 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.customers"
[0m10:18:54.963100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:18:54.964636 [debug] [Thread-1 (]: On model.curriculum_rec.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec", "target_name": "dev", "node_id": "model.curriculum_rec.customers"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`customers`
  OPTIONS()
  as with customers as (

    select * from `dbt-tutorial-428919`.`dbt_calvin`.`stg_customers`

),

orders as (

    select * from `dbt-tutorial-428919`.`dbt_calvin`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


[0m10:18:55.816194 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:9573dce2-dcc3-479f-9d2a-ea42b0991cef&page=queryresults
[0m10:18:56.365036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '989bad78-3c2c-47b9-9677-2ffa73380e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0a42d0>]}
[0m10:18:56.366909 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dbt_calvin.customers .......................... [[32mCREATE VIEW (0 processed)[0m in 1.41s]
[0m10:18:56.368424 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.customers
[0m10:18:56.371192 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:18:56.371863 [debug] [MainThread]: Connection 'model.curriculum_rec.customers' was properly closed.
[0m10:18:56.372718 [info ] [MainThread]: 
[0m10:18:56.373396 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.71 seconds (4.71s).
[0m10:18:56.375045 [debug] [MainThread]: Command end result
[0m10:18:56.413038 [info ] [MainThread]: 
[0m10:18:56.413478 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:18:56.413696 [info ] [MainThread]: 
[0m10:18:56.413912 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:18:56.415552 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.637343, "process_user_time": 1.714044, "process_kernel_time": 0.178264, "process_mem_max_rss": "211746816", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:18:56.415927 [debug] [MainThread]: Command `dbt run` succeeded at 10:18:56.415867 after 5.64 seconds
[0m10:18:56.416182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ec9a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e24a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e25350>]}
[0m10:18:56.416427 [debug] [MainThread]: Flushing usage events
[0m11:29:11.538124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c72190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ccffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf86d0>]}


============================== 11:29:11.540405 | 1671923f-3a2a-4b35-9449-6cc2fec26751 ==============================
[0m11:29:11.540405 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:29:11.540712 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:29:11.548395 [info ] [MainThread]: dbt version: 1.8.3
[0m11:29:11.548579 [info ] [MainThread]: python version: 3.11.7
[0m11:29:11.548720 [info ] [MainThread]: python path: /Users/CalvinLii/dbt-env/bin/python
[0m11:29:11.548837 [info ] [MainThread]: os info: macOS-14.0-arm64-arm-64bit
[0m11:29:12.037156 [info ] [MainThread]: Using profiles dir at /Users/CalvinLii/.dbt
[0m11:29:12.037400 [info ] [MainThread]: Using profiles.yml file at /Users/CalvinLii/.dbt/profiles.yml
[0m11:29:12.037530 [info ] [MainThread]: Using dbt_project.yml file at /Users/CalvinLii/dbt-curriculum-rec/dbt_project.yml
[0m11:29:12.037647 [info ] [MainThread]: adapter type: bigquery
[0m11:29:12.037758 [info ] [MainThread]: adapter version: 1.8.2
[0m11:29:12.039564 [info ] [MainThread]: Configuration:
[0m11:29:12.039704 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:29:12.039820 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m11:29:12.039931 [info ] [MainThread]: Required dependencies:
[0m11:29:12.040068 [debug] [MainThread]: Executing "git --help"
[0m11:29:12.052655 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:29:12.053041 [debug] [MainThread]: STDERR: "b''"
[0m11:29:12.053226 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:29:12.053353 [info ] [MainThread]: Connection:
[0m11:29:12.053506 [info ] [MainThread]:   method: service-account
[0m11:29:12.053607 [info ] [MainThread]:   database: dbt-tutorial-428919
[0m11:29:12.053706 [info ] [MainThread]:   execution_project: dbt-tutorial-428919
[0m11:29:12.053802 [info ] [MainThread]:   schema: dbt_calvin
[0m11:29:12.053893 [info ] [MainThread]:   location: US
[0m11:29:12.053989 [info ] [MainThread]:   priority: interactive
[0m11:29:12.054084 [info ] [MainThread]:   maximum_bytes_billed: None
[0m11:29:12.054179 [info ] [MainThread]:   impersonate_service_account: None
[0m11:29:12.054268 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m11:29:12.054363 [info ] [MainThread]:   job_retries: 1
[0m11:29:12.054453 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m11:29:12.054543 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m11:29:12.054635 [info ] [MainThread]:   timeout_seconds: 300
[0m11:29:12.054724 [info ] [MainThread]:   client_id: None
[0m11:29:12.054815 [info ] [MainThread]:   token_uri: None
[0m11:29:12.054902 [info ] [MainThread]:   dataproc_region: None
[0m11:29:12.054989 [info ] [MainThread]:   dataproc_cluster_name: None
[0m11:29:12.055089 [info ] [MainThread]:   gcs_bucket: None
[0m11:29:12.055184 [info ] [MainThread]:   dataproc_batch: None
[0m11:29:12.055412 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:29:12.058757 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m11:29:12.059333 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:29:12.060868 [debug] [MainThread]: On debug: select 1 as id
[0m11:29:12.904396 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:ec3f18b1-baa4-4f65-b4da-754d23f68bcd&page=queryresults
[0m11:29:13.435457 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:29:13.436874 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:29:13.437705 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  data-paths and seed-paths cannot both be defined. The `data-paths` config has been deprecated in favor of `seed-paths`. Please update your `dbt_project.yml` configuration to reflect this change.

Error encountered in /Users/CalvinLii/dbt-curriculum-rec/dbt_project.yml


[0m11:29:13.442696 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.9313853, "process_user_time": 0.790065, "process_kernel_time": 0.17976, "process_mem_max_rss": "195870720", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:29:13.443661 [debug] [MainThread]: Command `dbt debug` failed at 11:29:13.443512 after 1.93 seconds
[0m11:29:13.444244 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:29:13.444747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cbc8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c1e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054f3850>]}
[0m11:29:13.445185 [debug] [MainThread]: Flushing usage events
[0m11:31:04.149108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d56b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109db3fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d57010>]}


============================== 11:31:04.150781 | 40f02401-3cbb-485c-b236-7ea447b6ab47 ==============================
[0m11:31:04.150781 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:31:04.151053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'profiles_dir': '/Users/CalvinLii/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:31:04.154915 [info ] [MainThread]: dbt version: 1.8.3
[0m11:31:04.155096 [info ] [MainThread]: python version: 3.11.7
[0m11:31:04.155239 [info ] [MainThread]: python path: /Users/CalvinLii/dbt-env/bin/python
[0m11:31:04.155354 [info ] [MainThread]: os info: macOS-14.0-arm64-arm-64bit
[0m11:31:04.421520 [info ] [MainThread]: Using profiles dir at /Users/CalvinLii/.dbt
[0m11:31:04.421771 [info ] [MainThread]: Using profiles.yml file at /Users/CalvinLii/.dbt/profiles.yml
[0m11:31:04.421919 [info ] [MainThread]: Using dbt_project.yml file at /Users/CalvinLii/dbt-curriculum-rec/dbt_project.yml
[0m11:31:04.422038 [info ] [MainThread]: adapter type: bigquery
[0m11:31:04.422155 [info ] [MainThread]: adapter version: 1.8.2
[0m11:31:04.423954 [info ] [MainThread]: Configuration:
[0m11:31:04.424106 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:31:04.424227 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m11:31:04.424339 [info ] [MainThread]: Required dependencies:
[0m11:31:04.424477 [debug] [MainThread]: Executing "git --help"
[0m11:31:04.430853 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:31:04.431248 [debug] [MainThread]: STDERR: "b''"
[0m11:31:04.431414 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:31:04.431551 [info ] [MainThread]: Connection:
[0m11:31:04.431723 [info ] [MainThread]:   method: service-account
[0m11:31:04.431834 [info ] [MainThread]:   database: dbt-tutorial-428919
[0m11:31:04.431944 [info ] [MainThread]:   execution_project: dbt-tutorial-428919
[0m11:31:04.432046 [info ] [MainThread]:   schema: dbt_calvin
[0m11:31:04.432149 [info ] [MainThread]:   location: US
[0m11:31:04.432252 [info ] [MainThread]:   priority: interactive
[0m11:31:04.432352 [info ] [MainThread]:   maximum_bytes_billed: None
[0m11:31:04.432455 [info ] [MainThread]:   impersonate_service_account: None
[0m11:31:04.432555 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m11:31:04.432653 [info ] [MainThread]:   job_retries: 1
[0m11:31:04.432754 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m11:31:04.432852 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m11:31:04.432956 [info ] [MainThread]:   timeout_seconds: 300
[0m11:31:04.433065 [info ] [MainThread]:   client_id: None
[0m11:31:04.433164 [info ] [MainThread]:   token_uri: None
[0m11:31:04.433264 [info ] [MainThread]:   dataproc_region: None
[0m11:31:04.433365 [info ] [MainThread]:   dataproc_cluster_name: None
[0m11:31:04.433460 [info ] [MainThread]:   gcs_bucket: None
[0m11:31:04.433558 [info ] [MainThread]:   dataproc_batch: None
[0m11:31:04.433786 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:31:04.436701 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m11:31:04.437198 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:31:04.438574 [debug] [MainThread]: On debug: select 1 as id
[0m11:31:05.238162 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:9fbedd67-7e49-4993-9bfe-13889766f470&page=queryresults
[0m11:31:05.861406 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:31:05.862786 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:31:05.863495 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  data-paths and seed-paths cannot both be defined. The `data-paths` config has been deprecated in favor of `seed-paths`. Please update your `dbt_project.yml` configuration to reflect this change.

Error encountered in /Users/CalvinLii/dbt-curriculum-rec/dbt_project.yml


[0m11:31:05.866837 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.7420553, "process_user_time": 0.778237, "process_kernel_time": 0.136153, "process_mem_max_rss": "196771840", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:31:05.867632 [debug] [MainThread]: Command `dbt debug` failed at 11:31:05.867515 after 1.74 seconds
[0m11:31:05.868090 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:31:05.868486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dda410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dd8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108059bd0>]}
[0m11:31:05.868969 [debug] [MainThread]: Flushing usage events
[0m11:50:08.355344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113492c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113514410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113514a50>]}


============================== 11:50:08.357652 | 7863940c-dc2b-402c-8172-c23677c02da8 ==============================
[0m11:50:08.357652 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:50:08.357928 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:50:08.365822 [info ] [MainThread]: dbt version: 1.8.3
[0m11:50:08.366007 [info ] [MainThread]: python version: 3.11.7
[0m11:50:08.366154 [info ] [MainThread]: python path: /Users/CalvinLii/dbt-env/bin/python
[0m11:50:08.366272 [info ] [MainThread]: os info: macOS-14.0-arm64-arm-64bit
[0m11:50:08.853331 [info ] [MainThread]: Using profiles dir at /Users/CalvinLii/.dbt
[0m11:50:08.853573 [info ] [MainThread]: Using profiles.yml file at /Users/CalvinLii/.dbt/profiles.yml
[0m11:50:08.853709 [info ] [MainThread]: Using dbt_project.yml file at /Users/CalvinLii/dbt-curriculum-rec/dbt_project.yml
[0m11:50:08.853825 [info ] [MainThread]: adapter type: bigquery
[0m11:50:08.853937 [info ] [MainThread]: adapter version: 1.8.2
[0m11:50:08.883151 [info ] [MainThread]: Configuration:
[0m11:50:08.883323 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:50:08.883444 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:50:08.883554 [info ] [MainThread]: Required dependencies:
[0m11:50:08.883695 [debug] [MainThread]: Executing "git --help"
[0m11:50:08.890212 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:50:08.890624 [debug] [MainThread]: STDERR: "b''"
[0m11:50:08.890762 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:50:08.890924 [info ] [MainThread]: Connection:
[0m11:50:08.891088 [info ] [MainThread]:   method: service-account
[0m11:50:08.891194 [info ] [MainThread]:   database: dbt-tutorial-428919
[0m11:50:08.891306 [info ] [MainThread]:   execution_project: dbt-tutorial-428919
[0m11:50:08.891426 [info ] [MainThread]:   schema: dbt_calvin
[0m11:50:08.891536 [info ] [MainThread]:   location: US
[0m11:50:08.891639 [info ] [MainThread]:   priority: interactive
[0m11:50:08.891739 [info ] [MainThread]:   maximum_bytes_billed: None
[0m11:50:08.891850 [info ] [MainThread]:   impersonate_service_account: None
[0m11:50:08.891958 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m11:50:08.892065 [info ] [MainThread]:   job_retries: 1
[0m11:50:08.892165 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m11:50:08.892274 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m11:50:08.892375 [info ] [MainThread]:   timeout_seconds: 300
[0m11:50:08.892484 [info ] [MainThread]:   client_id: None
[0m11:50:08.892585 [info ] [MainThread]:   token_uri: None
[0m11:50:08.892680 [info ] [MainThread]:   dataproc_region: None
[0m11:50:08.892780 [info ] [MainThread]:   dataproc_cluster_name: None
[0m11:50:08.892879 [info ] [MainThread]:   gcs_bucket: None
[0m11:50:08.892980 [info ] [MainThread]:   dataproc_batch: None
[0m11:50:08.893205 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:50:08.897281 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m11:50:08.897918 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:50:08.899553 [debug] [MainThread]: On debug: select 1 as id
[0m11:50:09.744656 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:66eb6e89-59f3-4265-90b2-cd35d7bad987&page=queryresults
[0m11:50:10.359763 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:50:10.360930 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:50:10.366366 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.0379765, "process_user_time": 0.815379, "process_kernel_time": 0.187355, "process_mem_max_rss": "197263360", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:50:10.367456 [debug] [MainThread]: Command `dbt debug` succeeded at 11:50:10.367312 after 2.04 seconds
[0m11:50:10.367998 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:50:10.368439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113524e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113524a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122380f50>]}
[0m11:50:10.368984 [debug] [MainThread]: Flushing usage events
[0m11:50:16.136537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113456b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134d8490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134d8ad0>]}


============================== 11:50:16.138277 | 52194a51-6d85-44d8-9a93-ff5a83c3c4e8 ==============================
[0m11:50:16.138277 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:50:16.138545 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:50:16.449335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52194a51-6d85-44d8-9a93-ff5a83c3c4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113472510>]}
[0m11:50:16.468372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52194a51-6d85-44d8-9a93-ff5a83c3c4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110178f10>]}
[0m11:50:16.468645 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:50:16.478153 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:50:16.547727 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:50:16.548026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '52194a51-6d85-44d8-9a93-ff5a83c3c4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ad5090>]}
[0m11:50:16.922766 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_customers' in the 'models' section of file 'models/schema.yml'
[0m11:50:16.923529 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_orders' in the 'models' section of file 'models/schema.yml'
[0m11:50:16.966457 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.curriculum_rec.unique_stg_customers_customer_id.c7614daada' (models/schema.yml) depends on a node named 'stg_customers' in package '' which was not found
[0m11:50:16.966672 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.curriculum_rec.not_null_stg_customers_customer_id.e2cfb1f9aa' (models/schema.yml) depends on a node named 'stg_customers' in package '' which was not found
[0m11:50:16.966823 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.curriculum_rec.unique_stg_orders_order_id.e3b841c71a' (models/schema.yml) depends on a node named 'stg_orders' in package '' which was not found
[0m11:50:16.966960 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.curriculum_rec.not_null_stg_orders_order_id.81cfe2fe64' (models/schema.yml) depends on a node named 'stg_orders' in package '' which was not found
[0m11:50:16.967091 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.curriculum_rec.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad' (models/schema.yml) depends on a node named 'stg_orders' in package '' which was not found
[0m11:50:16.967221 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.curriculum_rec.not_null_stg_orders_customer_id.af79d5e4b5' (models/schema.yml) depends on a node named 'stg_orders' in package '' which was not found
[0m11:50:16.967350 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.curriculum_rec.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' (models/schema.yml) depends on a node named 'stg_customers' in package '' which was not found
[0m11:50:16.967483 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.curriculum_rec.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' (models/schema.yml) depends on a node named 'stg_orders' in package '' which was not found
[0m11:50:16.996085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52194a51-6d85-44d8-9a93-ff5a83c3c4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122851dd0>]}
[0m11:50:17.030797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52194a51-6d85-44d8-9a93-ff5a83c3c4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122d9c790>]}
[0m11:50:17.031008 [info ] [MainThread]: Found 4 models, 2 data tests, 471 macros
[0m11:50:17.031148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52194a51-6d85-44d8-9a93-ff5a83c3c4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122b0d990>]}
[0m11:50:17.031902 [info ] [MainThread]: 
[0m11:50:17.032131 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:50:17.033644 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m11:50:17.033808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:50:17.378713 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_calvin)
[0m11:50:17.379540 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:50:17.721435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52194a51-6d85-44d8-9a93-ff5a83c3c4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1228a4510>]}
[0m11:50:17.722293 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:50:17.723033 [info ] [MainThread]: 
[0m11:50:17.726693 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__content
[0m11:50:17.727254 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_calvin.stg_kaggle__content ..................... [RUN]
[0m11:50:17.727729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_calvin, now model.curriculum_rec.stg_kaggle__content)
[0m11:50:17.728047 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__content
[0m11:50:17.733633 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__content"
[0m11:50:17.734810 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__content
[0m11:50:17.754153 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__content"
[0m11:50:17.754578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:50:17.755514 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`stg_kaggle__content`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders;


[0m11:50:18.607297 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:ecf496b2-8dcb-44e0-b44f-0ca0875b657b&page=queryresults
[0m11:50:19.159468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52194a51-6d85-44d8-9a93-ff5a83c3c4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122dd6d50>]}
[0m11:50:19.160000 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dbt_calvin.stg_kaggle__content ................ [[32mCREATE VIEW (0 processed)[0m in 1.43s]
[0m11:50:19.160390 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__content
[0m11:50:19.160662 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__topics
[0m11:50:19.161024 [info ] [Thread-1 (]: 2 of 3 START sql view model dbt_calvin.stg_kaggle__topics ...................... [RUN]
[0m11:50:19.161341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__content, now model.curriculum_rec.stg_kaggle__topics)
[0m11:50:19.161565 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__topics
[0m11:50:19.163355 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__topics"
[0m11:50:19.163853 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__topics
[0m11:50:19.165649 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__topics"
[0m11:50:19.166102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:50:19.167166 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__topics: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__topics"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`stg_kaggle__topics`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers;


[0m11:50:19.882606 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:402c61f9-858a-4c9d-8129-f318dd9f5593&page=queryresults
[0m11:50:20.580837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52194a51-6d85-44d8-9a93-ff5a83c3c4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122dd32d0>]}
[0m11:50:20.582750 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dbt_calvin.stg_kaggle__topics ................. [[32mCREATE VIEW (0 processed)[0m in 1.42s]
[0m11:50:20.583805 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__topics
[0m11:50:20.585025 [debug] [Thread-1 (]: Began running node model.curriculum_rec.customers
[0m11:50:20.585680 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_calvin.customers ............................... [RUN]
[0m11:50:20.586076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__topics, now model.curriculum_rec.customers)
[0m11:50:20.586316 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.customers
[0m11:50:20.590914 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.customers"
[0m11:50:20.591527 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.customers
[0m11:50:20.593212 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.customers"
[0m11:50:20.593617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:50:20.594766 [debug] [Thread-1 (]: On model.curriculum_rec.customers: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.customers"} */


  create or replace view `dbt-tutorial-428919`.`dbt_calvin`.`customers`
  OPTIONS()
  as with customers as (

    select * from `dbt-tutorial-428919`.`dbt_calvin`.`stg_kaggle__topics`

),

orders as (

    select * from `dbt-tutorial-428919`.`dbt_calvin`.`stg_kaggle__content`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


[0m11:50:21.421774 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:156bfe3e-a906-4aca-b568-03051689c490&page=queryresults
[0m11:50:21.819536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52194a51-6d85-44d8-9a93-ff5a83c3c4e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121dfd590>]}
[0m11:50:21.820293 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dbt_calvin.customers .......................... [[32mCREATE VIEW (0 processed)[0m in 1.23s]
[0m11:50:21.820792 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.customers
[0m11:50:21.821880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:50:21.822095 [debug] [MainThread]: Connection 'model.curriculum_rec.customers' was properly closed.
[0m11:50:21.822371 [info ] [MainThread]: 
[0m11:50:21.822613 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.79 seconds (4.79s).
[0m11:50:21.823265 [debug] [MainThread]: Command end result
[0m11:50:21.844893 [info ] [MainThread]: 
[0m11:50:21.845175 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:50:21.845359 [info ] [MainThread]: 
[0m11:50:21.845538 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:50:21.846748 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.734828, "process_user_time": 1.678167, "process_kernel_time": 0.179876, "process_mem_max_rss": "210976768", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:50:21.847030 [debug] [MainThread]: Command `dbt run` succeeded at 11:50:21.846984 after 5.74 seconds
[0m11:50:21.847220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052a6950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053fda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105358a50>]}
[0m11:50:21.847409 [debug] [MainThread]: Flushing usage events
[0m13:18:10.991402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107105fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10718c1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10718c810>]}


============================== 13:18:10.993720 | bbb06931-22e3-40f2-9b15-29a898a11e13 ==============================
[0m13:18:10.993720 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:18:10.993994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m13:18:11.002028 [info ] [MainThread]: dbt version: 1.8.3
[0m13:18:11.002217 [info ] [MainThread]: python version: 3.11.7
[0m13:18:11.002358 [info ] [MainThread]: python path: /Users/CalvinLii/dbt-env/bin/python
[0m13:18:11.002478 [info ] [MainThread]: os info: macOS-14.0-arm64-arm-64bit
[0m13:18:11.488039 [info ] [MainThread]: Using profiles dir at /Users/CalvinLii/.dbt
[0m13:18:11.488287 [info ] [MainThread]: Using profiles.yml file at /Users/CalvinLii/.dbt/profiles.yml
[0m13:18:11.488424 [info ] [MainThread]: Using dbt_project.yml file at /Users/CalvinLii/dbt-curriculum-rec/dbt_project.yml
[0m13:18:11.488542 [info ] [MainThread]: adapter type: bigquery
[0m13:18:11.488652 [info ] [MainThread]: adapter version: 1.8.2
[0m13:18:11.508003 [info ] [MainThread]: Configuration:
[0m13:18:11.508158 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:18:11.508288 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m13:18:11.508394 [info ] [MainThread]: Required dependencies:
[0m13:18:11.508539 [debug] [MainThread]: Executing "git --help"
[0m13:18:11.515603 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:18:11.516021 [debug] [MainThread]: STDERR: "b''"
[0m13:18:11.516160 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:18:11.516307 [info ] [MainThread]: Connection:
[0m13:18:11.516488 [info ] [MainThread]:   method: service-account
[0m13:18:11.516591 [info ] [MainThread]:   database: dbt-tutorial-428919
[0m13:18:11.516692 [info ] [MainThread]:   execution_project: dbt-tutorial-428919
[0m13:18:11.516789 [info ] [MainThread]:   schema: dbt_curriculum_rec
[0m13:18:11.516883 [info ] [MainThread]:   location: US
[0m13:18:11.516978 [info ] [MainThread]:   priority: interactive
[0m13:18:11.517072 [info ] [MainThread]:   maximum_bytes_billed: None
[0m13:18:11.517168 [info ] [MainThread]:   impersonate_service_account: None
[0m13:18:11.517259 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m13:18:11.517354 [info ] [MainThread]:   job_retries: 1
[0m13:18:11.517447 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m13:18:11.517540 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m13:18:11.517634 [info ] [MainThread]:   timeout_seconds: 300
[0m13:18:11.517728 [info ] [MainThread]:   client_id: None
[0m13:18:11.517822 [info ] [MainThread]:   token_uri: None
[0m13:18:11.517912 [info ] [MainThread]:   dataproc_region: None
[0m13:18:11.518003 [info ] [MainThread]:   dataproc_cluster_name: None
[0m13:18:11.518092 [info ] [MainThread]:   gcs_bucket: None
[0m13:18:11.518180 [info ] [MainThread]:   dataproc_batch: None
[0m13:18:11.518403 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:18:11.521512 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m13:18:11.522034 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:18:11.523783 [debug] [MainThread]: On debug: select 1 as id
[0m13:18:12.109195 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:c4f15627-5496-4c71-9a92-73be2a1ae0e0&page=queryresults
[0m13:18:12.724247 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:18:12.725950 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:18:12.726867 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  at path []: Additional properties are not allowed ('raw_data' was unexpected)

Error encountered in /Users/CalvinLii/dbt-curriculum-rec/dbt_project.yml


[0m13:18:12.731520 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.7666118, "process_user_time": 0.803038, "process_kernel_time": 0.184357, "process_mem_max_rss": "195870720", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:18:12.732929 [debug] [MainThread]: Command `dbt debug` failed at 13:18:12.732753 after 1.77 seconds
[0m13:18:12.733414 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:18:12.733868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107151590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071508d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c957b50>]}
[0m13:18:12.734365 [debug] [MainThread]: Flushing usage events
[0m13:18:23.860031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10963b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10966b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096bcc50>]}


============================== 13:18:23.861915 | 6ef78d19-81eb-433f-8a5d-5a6a2aab95c9 ==============================
[0m13:18:23.861915 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:18:23.862160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m13:18:23.866092 [info ] [MainThread]: dbt version: 1.8.3
[0m13:18:23.866245 [info ] [MainThread]: python version: 3.11.7
[0m13:18:23.866372 [info ] [MainThread]: python path: /Users/CalvinLii/dbt-env/bin/python
[0m13:18:23.866479 [info ] [MainThread]: os info: macOS-14.0-arm64-arm-64bit
[0m13:18:24.137464 [info ] [MainThread]: Using profiles dir at /Users/CalvinLii/.dbt
[0m13:18:24.137739 [info ] [MainThread]: Using profiles.yml file at /Users/CalvinLii/.dbt/profiles.yml
[0m13:18:24.137880 [info ] [MainThread]: Using dbt_project.yml file at /Users/CalvinLii/dbt-curriculum-rec/dbt_project.yml
[0m13:18:24.138006 [info ] [MainThread]: adapter type: bigquery
[0m13:18:24.138119 [info ] [MainThread]: adapter version: 1.8.2
[0m13:18:24.167351 [info ] [MainThread]: Configuration:
[0m13:18:24.167521 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:18:24.167646 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:18:24.167763 [info ] [MainThread]: Required dependencies:
[0m13:18:24.167905 [debug] [MainThread]: Executing "git --help"
[0m13:18:24.174810 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:18:24.175329 [debug] [MainThread]: STDERR: "b''"
[0m13:18:24.175501 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:18:24.175654 [info ] [MainThread]: Connection:
[0m13:18:24.175852 [info ] [MainThread]:   method: service-account
[0m13:18:24.175966 [info ] [MainThread]:   database: dbt-tutorial-428919
[0m13:18:24.176077 [info ] [MainThread]:   execution_project: dbt-tutorial-428919
[0m13:18:24.176181 [info ] [MainThread]:   schema: dbt_curriculum_rec
[0m13:18:24.176285 [info ] [MainThread]:   location: US
[0m13:18:24.176387 [info ] [MainThread]:   priority: interactive
[0m13:18:24.176495 [info ] [MainThread]:   maximum_bytes_billed: None
[0m13:18:24.176601 [info ] [MainThread]:   impersonate_service_account: None
[0m13:18:24.176703 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m13:18:24.176805 [info ] [MainThread]:   job_retries: 1
[0m13:18:24.176910 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m13:18:24.177012 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m13:18:24.177113 [info ] [MainThread]:   timeout_seconds: 300
[0m13:18:24.177219 [info ] [MainThread]:   client_id: None
[0m13:18:24.177324 [info ] [MainThread]:   token_uri: None
[0m13:18:24.177422 [info ] [MainThread]:   dataproc_region: None
[0m13:18:24.177520 [info ] [MainThread]:   dataproc_cluster_name: None
[0m13:18:24.177618 [info ] [MainThread]:   gcs_bucket: None
[0m13:18:24.177718 [info ] [MainThread]:   dataproc_batch: None
[0m13:18:24.177979 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:18:24.181052 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m13:18:24.181652 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:18:24.182976 [debug] [MainThread]: On debug: select 1 as id
[0m13:18:24.704163 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:03697d95-0fee-4ca7-9543-9ef3f9db17d3&page=queryresults
[0m13:18:25.125548 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:18:25.126769 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:18:25.130989 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.2945284, "process_user_time": 0.808672, "process_kernel_time": 0.12652, "process_mem_max_rss": "197099520", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:18:25.131817 [debug] [MainThread]: Command `dbt debug` succeeded at 13:18:25.131691 after 1.30 seconds
[0m13:18:25.132249 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:18:25.132646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105279a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eca3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb3fbd0>]}
[0m13:18:25.133423 [debug] [MainThread]: Flushing usage events
[0m13:18:28.051255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d26f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106da8750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106da8d90>]}


============================== 13:18:28.052910 | a3200f50-cb24-4844-992b-e73b7fee324b ==============================
[0m13:18:28.052910 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:18:28.053179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/CalvinLii/.dbt', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:18:28.358628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3200f50-cb24-4844-992b-e73b7fee324b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c494e10>]}
[0m13:18:28.377341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3200f50-cb24-4844-992b-e73b7fee324b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10530d150>]}
[0m13:18:28.377580 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:18:28.386415 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:18:28.454737 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:18:28.455001 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:18:28.455166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a3200f50-cb24-4844-992b-e73b7fee324b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a691d0>]}
[0m13:18:28.797189 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_kaggle__topic (models/staging/kaggle/stg_kaggle__topic.sql)
  'dict object' has no attribute 'read_csv'
[0m13:18:28.798249 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7710407, "process_user_time": 1.1581, "process_kernel_time": 0.138556, "process_mem_max_rss": "204406784", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:18:28.798475 [debug] [MainThread]: Command `dbt run` failed at 13:18:28.798434 after 0.77 seconds
[0m13:18:28.798636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106daac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106daa990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c74a090>]}
[0m13:18:28.798781 [debug] [MainThread]: Flushing usage events
[0m13:20:54.214382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107956f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079a61d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079a5750>]}


============================== 13:20:54.216082 | 4d11ee50-0258-4ef5-bd65-451622b9d7ef ==============================
[0m13:20:54.216082 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:20:54.216361 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/CalvinLii/.dbt', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:20:54.514811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d11ee50-0258-4ef5-bd65-451622b9d7ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079ebad0>]}
[0m13:20:54.533182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d11ee50-0258-4ef5-bd65-451622b9d7ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054bcb90>]}
[0m13:20:54.533440 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:20:54.541927 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:20:54.610015 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:20:54.610281 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:20:54.610438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4d11ee50-0258-4ef5-bd65-451622b9d7ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061d5150>]}
[0m13:20:54.967001 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_customers' in the 'models' section of file 'models/schema.yml'
[0m13:20:54.967729 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_orders' in the 'models' section of file 'models/schema.yml'
[0m13:20:55.014847 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.curriculum_rec.customers' (models/customers.sql) depends on a node named 'stg_kaggle__topics' which was not found
[0m13:20:55.015941 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8253447, "process_user_time": 1.235055, "process_kernel_time": 0.136139, "process_mem_max_rss": "206471168", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:20:55.016178 [debug] [MainThread]: Command `dbt run` failed at 13:20:55.016139 after 0.83 seconds
[0m13:20:55.016346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079d8790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117563fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120361b50>]}
[0m13:20:55.016499 [debug] [MainThread]: Flushing usage events
[0m13:21:20.749796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e46f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ec8610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ec8c50>]}


============================== 13:21:20.752030 | 1ca395ee-444d-42b7-9e99-f1a63f109423 ==============================
[0m13:21:20.752030 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:21:20.752321 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:21:21.054602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ca395ee-444d-42b7-9e99-f1a63f109423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad76d0>]}
[0m13:21:21.073022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ca395ee-444d-42b7-9e99-f1a63f109423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742ce90>]}
[0m13:21:21.073253 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:21:21.081970 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:21:21.149988 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:21:21.150252 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:21:21.150414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1ca395ee-444d-42b7-9e99-f1a63f109423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e80ef90>]}
[0m13:21:21.546279 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.curriculum_rec.customers' (models/customers.sql) depends on a node named 'stg_kaggle__topics' which was not found
[0m13:21:21.547323 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.82234967, "process_user_time": 1.222653, "process_kernel_time": 0.137418, "process_mem_max_rss": "205045760", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:21:21.547553 [debug] [MainThread]: Command `dbt run` failed at 13:21:21.547515 after 0.82 seconds
[0m13:21:21.547712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ec8ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea05190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eca910>]}
[0m13:21:21.547853 [debug] [MainThread]: Flushing usage events
[0m13:21:49.833708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b3ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bbc650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b89750>]}


============================== 13:21:49.835377 | 0c6c580d-63e0-4680-a1e7-9b422768d1f3 ==============================
[0m13:21:49.835377 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:21:49.835652 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'profiles_dir': '/Users/CalvinLii/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:21:50.137893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c6c580d-63e0-4680-a1e7-9b422768d1f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af91b50>]}
[0m13:21:50.156322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c6c580d-63e0-4680-a1e7-9b422768d1f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041193d0>]}
[0m13:21:50.156553 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:21:50.165104 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:21:50.233742 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:21:50.234027 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:21:50.234192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0c6c580d-63e0-4680-a1e7-9b422768d1f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10487d090>]}
[0m13:21:50.655596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c6c580d-63e0-4680-a1e7-9b422768d1f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3cc950>]}
[0m13:21:50.689463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c6c580d-63e0-4680-a1e7-9b422768d1f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8abf10>]}
[0m13:21:50.689666 [info ] [MainThread]: Found 3 models, 6 data tests, 472 macros
[0m13:21:50.689807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c6c580d-63e0-4680-a1e7-9b422768d1f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b661dd0>]}
[0m13:21:50.690545 [info ] [MainThread]: 
[0m13:21:50.690754 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:21:50.692270 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m13:21:50.692444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:51.075886 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now create_dbt-tutorial-428919_dbt_curriculum_rec)
[0m13:21:51.077382 [debug] [ThreadPool]: Creating schema "database: "dbt-tutorial-428919"
schema: "dbt_curriculum_rec"
"
[0m13:21:51.090110 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:51.091805 [debug] [ThreadPool]: On create_dbt-tutorial-428919_dbt_curriculum_rec: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "connection_name": "create_dbt-tutorial-428919_dbt_curriculum_rec"} */
create schema if not exists `dbt-tutorial-428919`.`dbt_curriculum_rec`
  
[0m13:21:51.653067 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:cb7504d8-1f4f-4056-95ea-793c27889d8f&page=queryresults
[0m13:21:52.556779 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt-tutorial-428919_dbt_curriculum_rec, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m13:21:52.557426 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:53.087210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c6c580d-63e0-4680-a1e7-9b422768d1f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aca0490>]}
[0m13:21:53.088443 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:21:53.088977 [info ] [MainThread]: 
[0m13:21:53.093295 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__content
[0m13:21:53.094320 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_curriculum_rec.stg_kaggle__content ............. [RUN]
[0m13:21:53.095028 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.curriculum_rec.stg_kaggle__content'
[0m13:21:53.095424 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__content
[0m13:21:53.109046 [debug] [Thread-1 (]: Compilation Error in model stg_kaggle__content (models/staging/kaggle/stg_kaggle__content.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:21:53.110327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c6c580d-63e0-4680-a1e7-9b422768d1f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b799250>]}
[0m13:21:53.110851 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model dbt_curriculum_rec.stg_kaggle__content .... [[31mERROR[0m in 0.01s]
[0m13:21:53.111236 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__content
[0m13:21:53.111526 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__correl
[0m13:21:53.112415 [info ] [Thread-1 (]: 2 of 3 START sql view model dbt_curriculum_rec.stg_kaggle__correl .............. [RUN]
[0m13:21:53.112728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__content, now model.curriculum_rec.stg_kaggle__correl)
[0m13:21:53.112966 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__correl
[0m13:21:53.115735 [debug] [Thread-1 (]: Compilation Error in model stg_kaggle__correl (models/staging/kaggle/stg_kaggle__correl.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:21:53.115994 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c6c580d-63e0-4680-a1e7-9b422768d1f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8c3250>]}
[0m13:21:53.116349 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model dbt_curriculum_rec.stg_kaggle__correl ..... [[31mERROR[0m in 0.00s]
[0m13:21:53.116665 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__correl
[0m13:21:53.116903 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__topic
[0m13:21:53.117228 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_curriculum_rec.stg_kaggle__topic ............... [RUN]
[0m13:21:53.117509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__correl, now model.curriculum_rec.stg_kaggle__topic)
[0m13:21:53.117726 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__topic
[0m13:21:53.120252 [debug] [Thread-1 (]: Compilation Error in model stg_kaggle__topic (models/staging/kaggle/stg_kaggle__topic.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:21:53.120479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c6c580d-63e0-4680-a1e7-9b422768d1f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd4c090>]}
[0m13:21:53.120785 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model dbt_curriculum_rec.stg_kaggle__topic ...... [[31mERROR[0m in 0.00s]
[0m13:21:53.121064 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__topic
[0m13:21:53.121738 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:53.121899 [debug] [MainThread]: Connection 'list_dbt-tutorial-428919_dbt_curriculum_rec' was properly closed.
[0m13:21:53.122044 [debug] [MainThread]: Connection 'model.curriculum_rec.stg_kaggle__topic' was properly closed.
[0m13:21:53.122231 [info ] [MainThread]: 
[0m13:21:53.122412 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.43 seconds (2.43s).
[0m13:21:53.122833 [debug] [MainThread]: Command end result
[0m13:21:53.141310 [info ] [MainThread]: 
[0m13:21:53.141546 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m13:21:53.141700 [info ] [MainThread]: 
[0m13:21:53.141885 [error] [MainThread]:   Compilation Error in model stg_kaggle__content (models/staging/kaggle/stg_kaggle__content.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:21:53.142031 [info ] [MainThread]: 
[0m13:21:53.142206 [error] [MainThread]:   Compilation Error in model stg_kaggle__correl (models/staging/kaggle/stg_kaggle__correl.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:21:53.142344 [info ] [MainThread]: 
[0m13:21:53.142508 [error] [MainThread]:   Compilation Error in model stg_kaggle__topic (models/staging/kaggle/stg_kaggle__topic.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:21:53.142639 [info ] [MainThread]: 
[0m13:21:53.142781 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m13:21:53.143860 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.3341973, "process_user_time": 1.516583, "process_kernel_time": 0.161246, "process_mem_max_rss": "211861504", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:21:53.144104 [debug] [MainThread]: Command `dbt run` failed at 13:21:53.144064 after 3.33 seconds
[0m13:21:53.144281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b89e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b8b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1016d5250>]}
[0m13:21:53.144440 [debug] [MainThread]: Flushing usage events
[0m13:24:36.892365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10776a650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077b9c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e8c50>]}


============================== 13:24:36.894003 | d366d4f3-f85e-4370-bc1d-3cf0e01a08ca ==============================
[0m13:24:36.894003 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:24:36.894271 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:24:37.195606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd366d4f3-f85e-4370-bc1d-3cf0e01a08ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf734d0>]}
[0m13:24:37.214129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd366d4f3-f85e-4370-bc1d-3cf0e01a08ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d00ccd0>]}
[0m13:24:37.214374 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:24:37.222619 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:24:37.301996 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:24:37.302320 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://macros/read_csv.sql
[0m13:24:37.329460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd366d4f3-f85e-4370-bc1d-3cf0e01a08ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfdc410>]}
[0m13:24:37.363418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd366d4f3-f85e-4370-bc1d-3cf0e01a08ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d095e50>]}
[0m13:24:37.363636 [info ] [MainThread]: Found 3 models, 6 data tests, 472 macros
[0m13:24:37.363784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd366d4f3-f85e-4370-bc1d-3cf0e01a08ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d107950>]}
[0m13:24:37.364557 [info ] [MainThread]: 
[0m13:24:37.364802 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:24:37.366336 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m13:24:37.366531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:37.773144 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m13:24:37.774220 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:24:38.206787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd366d4f3-f85e-4370-bc1d-3cf0e01a08ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10768db10>]}
[0m13:24:38.207786 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:24:38.208184 [info ] [MainThread]: 
[0m13:24:38.213455 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__content
[0m13:24:38.214514 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_curriculum_rec.stg_kaggle__content ............. [RUN]
[0m13:24:38.215443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.stg_kaggle__content)
[0m13:24:38.215886 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__content
[0m13:24:38.228188 [debug] [Thread-1 (]: Compilation Error in model stg_kaggle__content (models/staging/kaggle/stg_kaggle__content.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:24:38.229279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd366d4f3-f85e-4370-bc1d-3cf0e01a08ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf29990>]}
[0m13:24:38.229800 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model dbt_curriculum_rec.stg_kaggle__content .... [[31mERROR[0m in 0.01s]
[0m13:24:38.230232 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__content
[0m13:24:38.230572 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__correl
[0m13:24:38.231483 [info ] [Thread-1 (]: 2 of 3 START sql view model dbt_curriculum_rec.stg_kaggle__correl .............. [RUN]
[0m13:24:38.231799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__content, now model.curriculum_rec.stg_kaggle__correl)
[0m13:24:38.232029 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__correl
[0m13:24:38.234863 [debug] [Thread-1 (]: Compilation Error in model stg_kaggle__correl (models/staging/kaggle/stg_kaggle__correl.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:24:38.235117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd366d4f3-f85e-4370-bc1d-3cf0e01a08ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d313850>]}
[0m13:24:38.235465 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model dbt_curriculum_rec.stg_kaggle__correl ..... [[31mERROR[0m in 0.00s]
[0m13:24:38.235776 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__correl
[0m13:24:38.236019 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__topic
[0m13:24:38.236362 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_curriculum_rec.stg_kaggle__topic ............... [RUN]
[0m13:24:38.236703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__correl, now model.curriculum_rec.stg_kaggle__topic)
[0m13:24:38.236953 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__topic
[0m13:24:38.239745 [debug] [Thread-1 (]: Compilation Error in model stg_kaggle__topic (models/staging/kaggle/stg_kaggle__topic.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:24:38.240009 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd366d4f3-f85e-4370-bc1d-3cf0e01a08ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d330950>]}
[0m13:24:38.240364 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model dbt_curriculum_rec.stg_kaggle__topic ...... [[31mERROR[0m in 0.00s]
[0m13:24:38.240679 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__topic
[0m13:24:38.241437 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:24:38.241626 [debug] [MainThread]: Connection 'model.curriculum_rec.stg_kaggle__topic' was properly closed.
[0m13:24:38.241828 [info ] [MainThread]: 
[0m13:24:38.242008 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m13:24:38.242666 [debug] [MainThread]: Command end result
[0m13:24:38.262492 [info ] [MainThread]: 
[0m13:24:38.262757 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m13:24:38.262924 [info ] [MainThread]: 
[0m13:24:38.263116 [error] [MainThread]:   Compilation Error in model stg_kaggle__content (models/staging/kaggle/stg_kaggle__content.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:24:38.263272 [info ] [MainThread]: 
[0m13:24:38.263444 [error] [MainThread]:   Compilation Error in model stg_kaggle__correl (models/staging/kaggle/stg_kaggle__correl.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:24:38.263585 [info ] [MainThread]: 
[0m13:24:38.263739 [error] [MainThread]:   Compilation Error in model stg_kaggle__topic (models/staging/kaggle/stg_kaggle__topic.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:24:38.263871 [info ] [MainThread]: 
[0m13:24:38.264016 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m13:24:38.265135 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3963224, "process_user_time": 1.058467, "process_kernel_time": 0.144169, "process_mem_max_rss": "205635584", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:24:38.265404 [debug] [MainThread]: Command `dbt run` failed at 13:24:38.265355 after 1.40 seconds
[0m13:24:38.265580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103305490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103305390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c37410>]}
[0m13:24:38.265748 [debug] [MainThread]: Flushing usage events
[0m13:28:03.402902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10702ef50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b03d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b0a10>]}


============================== 13:28:03.405168 | aea6579e-a37b-4672-8630-412f374345ce ==============================
[0m13:28:03.405168 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:28:03.405433 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:28:03.911511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aea6579e-a37b-4672-8630-412f374345ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c439710>]}
[0m13:28:03.929898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aea6579e-a37b-4672-8630-412f374345ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105615290>]}
[0m13:28:03.930149 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:28:03.940415 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:28:04.031037 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m13:28:04.031368 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/stg_kaggle__content.sql
[0m13:28:04.031540 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/stg_kaggle__topic.sql
[0m13:28:04.031695 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/stg_kaggle__correl.sql
[0m13:28:04.089364 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_kaggle__content (models/staging/kaggle/stg_kaggle__content.sql)
  expected token ':', got '}'
    line 2
      {% set content_data = {{read_csv('raw_data/content.csv')}} %}
[0m13:28:04.091136 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.71382284, "process_user_time": 0.901807, "process_kernel_time": 0.180185, "process_mem_max_rss": "201113600", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:28:04.091377 [debug] [MainThread]: Command `dbt run` failed at 13:28:04.091341 after 0.71 seconds
[0m13:28:04.091531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10707dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10707dd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bc9250>]}
[0m13:28:04.091681 [debug] [MainThread]: Flushing usage events
[0m13:31:53.655984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107357490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d8b90>]}


============================== 13:31:53.658288 | a35c7e00-49bf-4f0b-b593-34c7ad6c3727 ==============================
[0m13:31:53.658288 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:31:53.658558 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:31:54.201996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a35c7e00-49bf-4f0b-b593-34c7ad6c3727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc8e050>]}
[0m13:31:54.221161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a35c7e00-49bf-4f0b-b593-34c7ad6c3727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104979290>]}
[0m13:31:54.221400 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:31:54.227272 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m13:31:54.229306 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5999843, "process_user_time": 0.782327, "process_kernel_time": 0.181826, "process_mem_max_rss": "195297280", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:31:54.229691 [debug] [MainThread]: Command `dbt run` failed at 13:31:54.229632 after 0.60 seconds
[0m13:31:54.229993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073b3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a50d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c18810>]}
[0m13:31:54.230213 [debug] [MainThread]: Flushing usage events
[0m13:32:14.415631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079caf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a27f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a27fd0>]}


============================== 13:32:14.417305 | c43f164f-7cf2-4d81-aa74-13797f66315b ==============================
[0m13:32:14.417305 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:32:14.417573 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'profiles_dir': '/Users/CalvinLii/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m13:32:14.456866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c43f164f-7cf2-4d81-aa74-13797f66315b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a80f10>]}
[0m13:32:14.467617 [debug] [MainThread]: Set downloads directory='/var/folders/hn/ds6pkb3n5j16s47f26mbf8x40000gn/T/dbt-downloads-auqmwkb8'
[0m13:32:14.467833 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:32:14.520039 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:32:14.520391 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:32:14.569949 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:32:14.577106 [info ] [MainThread]: Updating lock file in file path: /Users/CalvinLii/dbt-curriculum-rec/package-lock.yml
[0m13:32:14.578117 [debug] [MainThread]: Set downloads directory='/var/folders/hn/ds6pkb3n5j16s47f26mbf8x40000gn/T/dbt-downloads-93mqx0py'
[0m13:32:14.580022 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:32:14.733032 [info ] [MainThread]: Installed from version 1.2.0
[0m13:32:14.733273 [info ] [MainThread]: Up to date!
[0m13:32:14.733509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c43f164f-7cf2-4d81-aa74-13797f66315b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107abb190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107abb350>]}
[0m13:32:14.734646 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.34290278, "process_user_time": 0.571383, "process_kernel_time": 0.111191, "process_mem_max_rss": "114278400", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:32:14.734938 [debug] [MainThread]: Command `dbt deps` succeeded at 13:32:14.734887 after 0.34 seconds
[0m13:32:14.735129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079fb410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103609a90>]}
[0m13:32:14.735310 [debug] [MainThread]: Flushing usage events
[0m13:32:19.065356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110256990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102a7b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102d8d10>]}


============================== 13:32:19.067012 | 32e31bbc-de36-4e81-b4a6-011cd648f0d2 ==============================
[0m13:32:19.067012 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:32:19.067277 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:32:19.468418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32e31bbc-de36-4e81-b4a6-011cd648f0d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1178b7d90>]}
[0m13:32:19.487223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32e31bbc-de36-4e81-b4a6-011cd648f0d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105878f50>]}
[0m13:32:19.487455 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:32:19.498980 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:32:19.568711 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:32:19.568987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '32e31bbc-de36-4e81-b4a6-011cd648f0d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061d13d0>]}
[0m13:32:19.991828 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_kaggle__topic (models/staging/kaggle/stg_kaggle__topic.sql)
  expected token ':', got '}'
    line 2
      {% set topics_data = {{read_csv('raw_data/topics.csv') }}%}
[0m13:32:19.992897 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.95264506, "process_user_time": 1.246658, "process_kernel_time": 0.142501, "process_mem_max_rss": "201179136", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:32:19.993131 [debug] [MainThread]: Command `dbt run` failed at 13:32:19.993093 after 0.95 seconds
[0m13:32:19.993287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102b3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065d41d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117bce0d0>]}
[0m13:32:19.993426 [debug] [MainThread]: Flushing usage events
[0m13:32:50.379877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110056e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a3f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100d8b90>]}


============================== 13:32:50.381511 | dd7cdd99-cff0-4b51-825f-f185517fd038 ==============================
[0m13:32:50.381511 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:32:50.381780 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:32:50.692347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd7cdd99-cff0-4b51-825f-f185517fd038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1169176d0>]}
[0m13:32:50.711510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd7cdd99-cff0-4b51-825f-f185517fd038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116770e90>]}
[0m13:32:50.711749 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:32:50.722507 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:32:50.791404 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:32:50.791691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dd7cdd99-cff0-4b51-825f-f185517fd038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aed010>]}
[0m13:32:51.204931 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_kaggle__correl (models/staging/kaggle/stg_kaggle__correl.sql)
  expected token ':', got '}'
    line 2
      {% set correl_data = {{ read_csv('raw_data/correlations.csv') }}%}
[0m13:32:51.205915 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8501224, "process_user_time": 1.245814, "process_kernel_time": 0.139443, "process_mem_max_rss": "201228288", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:32:51.206140 [debug] [MainThread]: Command `dbt run` failed at 13:32:51.206102 after 0.85 seconds
[0m13:32:51.206299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110087710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100da790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1169f45d0>]}
[0m13:32:51.206441 [debug] [MainThread]: Flushing usage events
[0m13:33:19.616304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099e6b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a64850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a64e90>]}


============================== 13:33:19.618206 | db29b6c9-90c2-4ee0-8c25-a0321c400f0c ==============================
[0m13:33:19.618206 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:33:19.618494 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:33:19.930972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db29b6c9-90c2-4ee0-8c25-a0321c400f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f247d50>]}
[0m13:33:19.949907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db29b6c9-90c2-4ee0-8c25-a0321c400f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fcd1d0>]}
[0m13:33:19.950143 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:33:19.961617 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:33:20.033443 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:33:20.033761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'db29b6c9-90c2-4ee0-8c25-a0321c400f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108729310>]}
[0m13:33:20.545052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db29b6c9-90c2-4ee0-8c25-a0321c400f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f321c90>]}
[0m13:33:20.581283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db29b6c9-90c2-4ee0-8c25-a0321c400f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7c3550>]}
[0m13:33:20.581509 [info ] [MainThread]: Found 3 models, 6 data tests, 588 macros
[0m13:33:20.581656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db29b6c9-90c2-4ee0-8c25-a0321c400f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6a82d0>]}
[0m13:33:20.582447 [info ] [MainThread]: 
[0m13:33:20.582676 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:33:20.584234 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m13:33:20.584404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:33:20.943510 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m13:33:20.944279 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:33:21.321413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db29b6c9-90c2-4ee0-8c25-a0321c400f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4ee690>]}
[0m13:33:21.323066 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:33:21.323873 [info ] [MainThread]: 
[0m13:33:21.328481 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__content
[0m13:33:21.329234 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_curriculum_rec.stg_kaggle__content ............. [RUN]
[0m13:33:21.329743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.stg_kaggle__content)
[0m13:33:21.330074 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__content
[0m13:33:21.343149 [debug] [Thread-1 (]: Compilation Error in model stg_kaggle__content (models/staging/kaggle/stg_kaggle__content.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:33:21.344321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db29b6c9-90c2-4ee0-8c25-a0321c400f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f792010>]}
[0m13:33:21.344785 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model dbt_curriculum_rec.stg_kaggle__content .... [[31mERROR[0m in 0.01s]
[0m13:33:21.345179 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__content
[0m13:33:21.345450 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__correl
[0m13:33:21.346261 [info ] [Thread-1 (]: 2 of 3 START sql view model dbt_curriculum_rec.stg_kaggle__correl .............. [RUN]
[0m13:33:21.346565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__content, now model.curriculum_rec.stg_kaggle__correl)
[0m13:33:21.346800 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__correl
[0m13:33:21.349598 [debug] [Thread-1 (]: Compilation Error in model stg_kaggle__correl (models/staging/kaggle/stg_kaggle__correl.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:33:21.349858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db29b6c9-90c2-4ee0-8c25-a0321c400f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f831f10>]}
[0m13:33:21.350210 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model dbt_curriculum_rec.stg_kaggle__correl ..... [[31mERROR[0m in 0.00s]
[0m13:33:21.350524 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__correl
[0m13:33:21.350756 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__topic
[0m13:33:21.351061 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_curriculum_rec.stg_kaggle__topic ............... [RUN]
[0m13:33:21.351298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__correl, now model.curriculum_rec.stg_kaggle__topic)
[0m13:33:21.351483 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__topic
[0m13:33:21.353953 [debug] [Thread-1 (]: Compilation Error in model stg_kaggle__topic (models/staging/kaggle/stg_kaggle__topic.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:33:21.354183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db29b6c9-90c2-4ee0-8c25-a0321c400f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5d7610>]}
[0m13:33:21.354488 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model dbt_curriculum_rec.stg_kaggle__topic ...... [[31mERROR[0m in 0.00s]
[0m13:33:21.354765 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__topic
[0m13:33:21.355433 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:33:21.355590 [debug] [MainThread]: Connection 'model.curriculum_rec.stg_kaggle__topic' was properly closed.
[0m13:33:21.355783 [info ] [MainThread]: 
[0m13:33:21.355967 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m13:33:21.356393 [debug] [MainThread]: Command end result
[0m13:33:21.376883 [info ] [MainThread]: 
[0m13:33:21.377118 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m13:33:21.377266 [info ] [MainThread]: 
[0m13:33:21.377441 [error] [MainThread]:   Compilation Error in model stg_kaggle__content (models/staging/kaggle/stg_kaggle__content.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:33:21.377579 [info ] [MainThread]: 
[0m13:33:21.377735 [error] [MainThread]:   Compilation Error in model stg_kaggle__correl (models/staging/kaggle/stg_kaggle__correl.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:33:21.377864 [info ] [MainThread]: 
[0m13:33:21.378019 [error] [MainThread]:   Compilation Error in model stg_kaggle__topic (models/staging/kaggle/stg_kaggle__topic.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:33:21.378146 [info ] [MainThread]: 
[0m13:33:21.378297 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m13:33:21.379459 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.7888185, "process_user_time": 1.539486, "process_kernel_time": 0.154302, "process_mem_max_rss": "211009536", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:33:21.379722 [debug] [MainThread]: Command `dbt run` failed at 13:33:21.379679 after 1.79 seconds
[0m13:33:21.379914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a66cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a66d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105581350>]}
[0m13:33:21.380077 [debug] [MainThread]: Flushing usage events
[0m13:36:00.588815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a82c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b007d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b00e10>]}


============================== 13:36:00.590978 | 3bda77d7-1ce0-49a5-a3fa-321cf08f1b6b ==============================
[0m13:36:00.590978 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:36:00.591250 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'profiles_dir': '/Users/CalvinLii/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:36:01.017404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3bda77d7-1ce0-49a5-a3fa-321cf08f1b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134ec510>]}
[0m13:36:01.036374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3bda77d7-1ce0-49a5-a3fa-321cf08f1b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135d5610>]}
[0m13:36:01.036613 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:36:01.050814 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:36:01.149797 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m13:36:01.150153 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/stg_kaggle__correl.sql
[0m13:36:01.150347 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/stg_kaggle__content.sql
[0m13:36:01.150507 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/stg_kaggle__topic.sql
[0m13:36:01.210019 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_kaggle__correl (models/staging/kaggle/stg_kaggle__correl.sql)
  'dict object' has no attribute 'read_csv'
[0m13:36:01.211703 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6500258, "process_user_time": 0.925941, "process_kernel_time": 0.156663, "process_mem_max_rss": "200310784", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:36:01.211957 [debug] [MainThread]: Command `dbt run` failed at 13:36:01.211915 after 0.65 seconds
[0m13:36:01.212119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b00b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b00b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10561d250>]}
[0m13:36:01.212272 [debug] [MainThread]: Flushing usage events
[0m13:44:07.334124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104edffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f38510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f61110>]}


============================== 13:44:07.336386 | 2d256f9b-8d67-42ae-a87c-a30ed518c804 ==============================
[0m13:44:07.336386 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:44:07.336650 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/CalvinLii/.dbt', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:44:07.863634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d256f9b-8d67-42ae-a87c-a30ed518c804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10576f790>]}
[0m13:44:07.882750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d256f9b-8d67-42ae-a87c-a30ed518c804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034bd490>]}
[0m13:44:07.882980 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:44:07.894077 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:44:07.987817 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:44:07.988049 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:44:08.002234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d256f9b-8d67-42ae-a87c-a30ed518c804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034be210>]}
[0m13:44:08.042655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d256f9b-8d67-42ae-a87c-a30ed518c804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a766710>]}
[0m13:44:08.042863 [info ] [MainThread]: Found 3 models, 6 data tests, 588 macros
[0m13:44:08.043004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d256f9b-8d67-42ae-a87c-a30ed518c804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f20b50>]}
[0m13:44:08.043761 [info ] [MainThread]: 
[0m13:44:08.043985 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:44:08.045486 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m13:44:08.045653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:08.393230 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m13:44:08.394293 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:08.782609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d256f9b-8d67-42ae-a87c-a30ed518c804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a045310>]}
[0m13:44:08.784296 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:44:08.785009 [info ] [MainThread]: 
[0m13:44:08.789459 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__content
[0m13:44:08.790140 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_curriculum_rec.stg_kaggle__content ............. [RUN]
[0m13:44:08.790607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.stg_kaggle__content)
[0m13:44:08.790896 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__content
[0m13:44:08.804416 [debug] [Thread-1 (]: Compilation Error in model stg_kaggle__content (models/staging/kaggle/stg_kaggle__content.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:44:08.805272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d256f9b-8d67-42ae-a87c-a30ed518c804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7a3350>]}
[0m13:44:08.805693 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model dbt_curriculum_rec.stg_kaggle__content .... [[31mERROR[0m in 0.01s]
[0m13:44:08.806028 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__content
[0m13:44:08.806264 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__correl
[0m13:44:08.807186 [info ] [Thread-1 (]: 2 of 3 START sql view model dbt_curriculum_rec.stg_kaggle__correl .............. [RUN]
[0m13:44:08.807490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__content, now model.curriculum_rec.stg_kaggle__correl)
[0m13:44:08.807713 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__correl
[0m13:44:08.810272 [debug] [Thread-1 (]: Compilation Error in model stg_kaggle__correl (models/staging/kaggle/stg_kaggle__correl.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:44:08.810494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d256f9b-8d67-42ae-a87c-a30ed518c804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8f02d0>]}
[0m13:44:08.810789 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model dbt_curriculum_rec.stg_kaggle__correl ..... [[31mERROR[0m in 0.00s]
[0m13:44:08.811050 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__correl
[0m13:44:08.811253 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__topic
[0m13:44:08.811501 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_curriculum_rec.stg_kaggle__topic ............... [RUN]
[0m13:44:08.811711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__correl, now model.curriculum_rec.stg_kaggle__topic)
[0m13:44:08.811880 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__topic
[0m13:44:08.814112 [debug] [Thread-1 (]: Compilation Error in model stg_kaggle__topic (models/staging/kaggle/stg_kaggle__topic.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:44:08.814308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d256f9b-8d67-42ae-a87c-a30ed518c804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aac9e90>]}
[0m13:44:08.814580 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model dbt_curriculum_rec.stg_kaggle__topic ...... [[31mERROR[0m in 0.00s]
[0m13:44:08.814835 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__topic
[0m13:44:08.815410 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:44:08.815552 [debug] [MainThread]: Connection 'model.curriculum_rec.stg_kaggle__topic' was properly closed.
[0m13:44:08.815726 [info ] [MainThread]: 
[0m13:44:08.815897 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m13:44:08.816276 [debug] [MainThread]: Command end result
[0m13:44:08.834500 [info ] [MainThread]: 
[0m13:44:08.834714 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m13:44:08.834849 [info ] [MainThread]: 
[0m13:44:08.835014 [error] [MainThread]:   Compilation Error in model stg_kaggle__content (models/staging/kaggle/stg_kaggle__content.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:44:08.835146 [info ] [MainThread]: 
[0m13:44:08.835297 [error] [MainThread]:   Compilation Error in model stg_kaggle__correl (models/staging/kaggle/stg_kaggle__correl.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:44:08.835418 [info ] [MainThread]: 
[0m13:44:08.835565 [error] [MainThread]:   Compilation Error in model stg_kaggle__topic (models/staging/kaggle/stg_kaggle__topic.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:44:08.835683 [info ] [MainThread]: 
[0m13:44:08.835813 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m13:44:08.837377 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.5309403, "process_user_time": 1.049042, "process_kernel_time": 0.194345, "process_mem_max_rss": "203145216", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:44:08.837618 [debug] [MainThread]: Command `dbt run` failed at 13:44:08.837580 after 1.53 seconds
[0m13:44:08.837792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f60cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f388d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100a79350>]}
[0m13:44:08.837942 [debug] [MainThread]: Flushing usage events
[0m13:40:15.267056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105187910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051c49d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10520d090>]}


============================== 13:40:15.269439 | 4bc49562-6378-4e65-b295-df7219c3728e ==============================
[0m13:40:15.269439 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:40:15.269722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m13:40:15.277937 [info ] [MainThread]: dbt version: 1.8.3
[0m13:40:15.278135 [info ] [MainThread]: python version: 3.11.7
[0m13:40:15.278278 [info ] [MainThread]: python path: /Users/CalvinLii/dbt-env/bin/python
[0m13:40:15.278407 [info ] [MainThread]: os info: macOS-14.0-arm64-arm-64bit
[0m13:40:15.770483 [info ] [MainThread]: Using profiles dir at /Users/CalvinLii/.dbt
[0m13:40:15.770738 [info ] [MainThread]: Using profiles.yml file at /Users/CalvinLii/.dbt/profiles.yml
[0m13:40:15.770872 [info ] [MainThread]: Using dbt_project.yml file at /Users/CalvinLii/dbt-curriculum-rec/dbt_project.yml
[0m13:40:15.770990 [info ] [MainThread]: adapter type: bigquery
[0m13:40:15.771098 [info ] [MainThread]: adapter version: 1.8.2
[0m13:40:15.803264 [info ] [MainThread]: Configuration:
[0m13:40:15.803437 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:40:15.803561 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:40:15.803670 [info ] [MainThread]: Required dependencies:
[0m13:40:15.803818 [debug] [MainThread]: Executing "git --help"
[0m13:40:15.818327 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:40:15.818766 [debug] [MainThread]: STDERR: "b''"
[0m13:40:15.818907 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:40:15.819052 [info ] [MainThread]: Connection:
[0m13:40:15.819247 [info ] [MainThread]:   method: service-account
[0m13:40:15.819347 [info ] [MainThread]:   database: dbt-tutorial-428919
[0m13:40:15.819449 [info ] [MainThread]:   execution_project: dbt-tutorial-428919
[0m13:40:15.819544 [info ] [MainThread]:   schema: dbt_curriculum_rec
[0m13:40:15.819639 [info ] [MainThread]:   location: US
[0m13:40:15.819739 [info ] [MainThread]:   priority: interactive
[0m13:40:15.819831 [info ] [MainThread]:   maximum_bytes_billed: None
[0m13:40:15.819930 [info ] [MainThread]:   impersonate_service_account: None
[0m13:40:15.820022 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m13:40:15.820119 [info ] [MainThread]:   job_retries: 1
[0m13:40:15.820218 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m13:40:15.820309 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m13:40:15.820401 [info ] [MainThread]:   timeout_seconds: 300
[0m13:40:15.820495 [info ] [MainThread]:   client_id: None
[0m13:40:15.820587 [info ] [MainThread]:   token_uri: None
[0m13:40:15.820678 [info ] [MainThread]:   dataproc_region: None
[0m13:40:15.820774 [info ] [MainThread]:   dataproc_cluster_name: None
[0m13:40:15.820865 [info ] [MainThread]:   gcs_bucket: None
[0m13:40:15.820956 [info ] [MainThread]:   dataproc_batch: None
[0m13:40:15.821218 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:40:15.824951 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m13:40:15.825547 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:40:15.827092 [debug] [MainThread]: On debug: select 1 as id
[0m13:40:16.758151 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:9b6e5389-3f2c-4e40-b441-f70318f7dba4&page=queryresults
[0m13:40:17.270080 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:40:17.271431 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:40:17.277097 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.0382614, "process_user_time": 0.837587, "process_kernel_time": 0.195403, "process_mem_max_rss": "198246400", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:40:17.278440 [debug] [MainThread]: Command `dbt debug` succeeded at 13:40:17.278235 after 2.04 seconds
[0m13:40:17.278971 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:40:17.279433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104da08d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11479e190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105190c90>]}
[0m13:40:17.279963 [debug] [MainThread]: Flushing usage events
[0m13:40:19.711031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114936d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111514c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111515290>]}


============================== 13:40:19.712968 | 9eaece57-cab0-4f72-8f40-42c557ff2ca0 ==============================
[0m13:40:19.712968 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:40:19.713265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:40:20.036043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9eaece57-cab0-4f72-8f40-42c557ff2ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1311cded0>]}
[0m13:40:20.055538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9eaece57-cab0-4f72-8f40-42c557ff2ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10729d0d0>]}
[0m13:40:20.055776 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:40:20.068608 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:40:20.175682 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m13:40:20.176041 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/stg_kaggle__content.sql
[0m13:40:20.176238 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/stg_kaggle__topic.sql
[0m13:40:20.176405 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/stg_kaggle__correl.sql
[0m13:40:20.176562 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://macros/read_csv.sql
[0m13:40:20.322592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9eaece57-cab0-4f72-8f40-42c557ff2ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1315f5590>]}
[0m13:40:20.361026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9eaece57-cab0-4f72-8f40-42c557ff2ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13171d190>]}
[0m13:40:20.361250 [info ] [MainThread]: Found 3 models, 6 data tests, 588 macros
[0m13:40:20.361397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9eaece57-cab0-4f72-8f40-42c557ff2ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1315f7690>]}
[0m13:40:20.362188 [info ] [MainThread]: 
[0m13:40:20.362410 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:40:20.364000 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m13:40:20.364183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:20.784716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m13:40:20.785712 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:21.366420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9eaece57-cab0-4f72-8f40-42c557ff2ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1306ef710>]}
[0m13:40:21.367968 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:40:21.368508 [info ] [MainThread]: 
[0m13:40:21.373092 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__content
[0m13:40:21.373914 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_curriculum_rec.stg_kaggle__content ............. [RUN]
[0m13:40:21.374519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.stg_kaggle__content)
[0m13:40:21.374856 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__content
[0m13:40:21.390013 [debug] [Thread-1 (]: Compilation Error in model stg_kaggle__content (models/staging/kaggle/stg_kaggle__content.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:40:21.391287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eaece57-cab0-4f72-8f40-42c557ff2ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1315d8090>]}
[0m13:40:21.391812 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model dbt_curriculum_rec.stg_kaggle__content .... [[31mERROR[0m in 0.02s]
[0m13:40:21.392209 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__content
[0m13:40:21.392490 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__correl
[0m13:40:21.393334 [info ] [Thread-1 (]: 2 of 3 START sql view model dbt_curriculum_rec.stg_kaggle__correl .............. [RUN]
[0m13:40:21.393672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__content, now model.curriculum_rec.stg_kaggle__correl)
[0m13:40:21.393947 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__correl
[0m13:40:21.397225 [debug] [Thread-1 (]: Compilation Error in model stg_kaggle__correl (models/staging/kaggle/stg_kaggle__correl.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:40:21.397512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eaece57-cab0-4f72-8f40-42c557ff2ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1315d9e90>]}
[0m13:40:21.397934 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model dbt_curriculum_rec.stg_kaggle__correl ..... [[31mERROR[0m in 0.00s]
[0m13:40:21.398261 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__correl
[0m13:40:21.398507 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__topic
[0m13:40:21.398848 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_curriculum_rec.stg_kaggle__topic ............... [RUN]
[0m13:40:21.399131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__correl, now model.curriculum_rec.stg_kaggle__topic)
[0m13:40:21.399326 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__topic
[0m13:40:21.401977 [debug] [Thread-1 (]: Compilation Error in model stg_kaggle__topic (models/staging/kaggle/stg_kaggle__topic.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:40:21.402236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eaece57-cab0-4f72-8f40-42c557ff2ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1321a6710>]}
[0m13:40:21.402555 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model dbt_curriculum_rec.stg_kaggle__topic ...... [[31mERROR[0m in 0.00s]
[0m13:40:21.402841 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__topic
[0m13:40:21.403651 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:21.403824 [debug] [MainThread]: Connection 'model.curriculum_rec.stg_kaggle__topic' was properly closed.
[0m13:40:21.404022 [info ] [MainThread]: 
[0m13:40:21.404205 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 1.04 seconds (1.04s).
[0m13:40:21.404688 [debug] [MainThread]: Command end result
[0m13:40:21.425413 [info ] [MainThread]: 
[0m13:40:21.425606 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m13:40:21.425735 [info ] [MainThread]: 
[0m13:40:21.425909 [error] [MainThread]:   Compilation Error in model stg_kaggle__content (models/staging/kaggle/stg_kaggle__content.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:40:21.426049 [info ] [MainThread]: 
[0m13:40:21.426206 [error] [MainThread]:   Compilation Error in model stg_kaggle__correl (models/staging/kaggle/stg_kaggle__correl.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:40:21.426331 [info ] [MainThread]: 
[0m13:40:21.426482 [error] [MainThread]:   Compilation Error in model stg_kaggle__topic (models/staging/kaggle/stg_kaggle__topic.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:40:21.426611 [info ] [MainThread]: 
[0m13:40:21.426759 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m13:40:21.427850 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.743248, "process_user_time": 1.22501, "process_kernel_time": 0.168041, "process_mem_max_rss": "214007808", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:40:21.428112 [debug] [MainThread]: Command `dbt run` failed at 13:40:21.428072 after 1.74 seconds
[0m13:40:21.428284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111363590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104851650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104851550>]}
[0m13:40:21.428442 [debug] [MainThread]: Flushing usage events
[0m13:47:24.512888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e2f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e5fd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e81650>]}


============================== 13:47:24.515233 | 5ed0e5e8-34da-498a-9b05-0be6781e647c ==============================
[0m13:47:24.515233 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:47:24.515513 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:47:25.037596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ed0e5e8-34da-498a-9b05-0be6781e647c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e81c50>]}
[0m13:47:25.056762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ed0e5e8-34da-498a-9b05-0be6781e647c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccae9d0>]}
[0m13:47:25.057007 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:47:25.069953 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:47:25.163370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:47:25.163704 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/_kaggle__sources.yml
[0m13:47:25.193307 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid sources config given in models/staging/kaggle/_kaggle__sources.yml @ sources: {'name': 'kaggle_correlation', 'type': 'bigquery', 'schema': 'kaggle_curriculum_rec', 'table': 'kaggle_correlation', 'description': 'Data from the kaggle_correlation table in BigQuery'} - at path []: Additional properties are not allowed ('table', 'type' were unexpected)
[0m13:47:25.194729 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7079284, "process_user_time": 0.903556, "process_kernel_time": 0.191502, "process_mem_max_rss": "202752000", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:47:25.194999 [debug] [MainThread]: Command `dbt run` failed at 13:47:25.194955 after 0.71 seconds
[0m13:47:25.195174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e81650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e888d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029c9510>]}
[0m13:47:25.195338 [debug] [MainThread]: Flushing usage events
[0m13:50:21.991948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105393150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105414510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105414b10>]}


============================== 13:50:21.993787 | 03ef0884-f863-4c79-bd72-4fab60c60956 ==============================
[0m13:50:21.993787 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:50:21.994072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'profiles_dir': '/Users/CalvinLii/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:50:22.308562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03ef0884-f863-4c79-bd72-4fab60c60956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0b7310>]}
[0m13:50:22.327981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03ef0884-f863-4c79-bd72-4fab60c60956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037d5190>]}
[0m13:50:22.328232 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:50:22.339086 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:50:22.420605 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m13:50:22.420955 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/_kaggle__models.yml
[0m13:50:22.421134 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/_kaggle__sources.yml
[0m13:50:22.421314 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/stg_kaggle__correl.sql
[0m13:50:22.479085 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_kaggle__correl (models/staging/kaggle/stg_kaggle__correl.sql)
  source() takes exactly two arguments (1 given)
[0m13:50:22.480079 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5132423, "process_user_time": 0.928765, "process_kernel_time": 0.144661, "process_mem_max_rss": "205012992", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:50:22.480302 [debug] [MainThread]: Command `dbt run` failed at 13:50:22.480264 after 0.51 seconds
[0m13:50:22.480459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054250d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105416750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105391250>]}
[0m13:50:22.480610 [debug] [MainThread]: Flushing usage events
[0m13:51:17.896641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106192890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106192850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061e57d0>]}


============================== 13:51:17.898639 | 903da61a-0480-4030-ad17-a08b725912fb ==============================
[0m13:51:17.898639 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:51:17.898932 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:51:18.218890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '903da61a-0480-4030-ad17-a08b725912fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114933ad0>]}
[0m13:51:18.238027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '903da61a-0480-4030-ad17-a08b725912fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10417cb90>]}
[0m13:51:18.238269 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:51:18.249766 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:51:18.334485 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m13:51:18.334856 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/_kaggle__sources.yml
[0m13:51:18.335037 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/_kaggle__models.yml
[0m13:51:18.335213 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/stg_kaggle__correl.sql
[0m13:51:18.393927 [error] [MainThread]: Encountered an error:
BaseSourceResolver.__call__() got an unexpected keyword argument 'type'
[0m13:51:18.398463 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/CalvinLii/dbt-env/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/CalvinLii/dbt-env/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/CalvinLii/dbt-env/lib/python3.11/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/CalvinLii/dbt-env/lib/python3.11/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/CalvinLii/dbt-env/lib/python3.11/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/CalvinLii/dbt-env/lib/python3.11/site-packages/dbt/cli/requires.py", line 320, in wrapper
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/Users/CalvinLii/dbt-env/lib/python3.11/site-packages/dbt/parser/manifest.py", line 1898, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/CalvinLii/dbt-env/lib/python3.11/site-packages/dbt/parser/manifest.py", line 330, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/Users/CalvinLii/dbt-env/lib/python3.11/site-packages/dbt/parser/manifest.py", line 435, in load
    self.parse_project(
  File "/Users/CalvinLii/dbt-env/lib/python3.11/site-packages/dbt/parser/manifest.py", line 733, in parse_project
    parser.parse_file(block)
  File "/Users/CalvinLii/dbt-env/lib/python3.11/site-packages/dbt/parser/base.py", line 484, in parse_file
    self.parse_node(file_block)
  File "/Users/CalvinLii/dbt-env/lib/python3.11/site-packages/dbt/parser/base.py", line 445, in parse_node
    self.render_update(node, config)
  File "/Users/CalvinLii/dbt-env/lib/python3.11/site-packages/dbt/parser/models.py", line 348, in render_update
    super().render_update(node, config)
  File "/Users/CalvinLii/dbt-env/lib/python3.11/site-packages/dbt/parser/base.py", line 421, in render_update
    context = self.render_with_context(node, config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/CalvinLii/dbt-env/lib/python3.11/site-packages/dbt/parser/base.py", line 270, in render_with_context
    get_rendered(parsed_node.raw_code, context, parsed_node, capture_macros=True)
  File "/Users/CalvinLii/dbt-env/lib/python3.11/site-packages/dbt/clients/jinja.py", line 146, in get_rendered
    rendered = render_template(template, ctx, node)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/CalvinLii/dbt-env/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 539, in render_template
    return template.render(ctx)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/CalvinLii/dbt-env/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 144, in render
    return self.environment.handle_exception()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/CalvinLii/dbt-env/lib/python3.11/site-packages/jinja2/environment.py", line 939, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "<template>", line 10, in top-level template code
  File "/Users/CalvinLii/dbt-env/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: BaseSourceResolver.__call__() got an unexpected keyword argument 'type'

[0m13:51:18.399615 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.52833307, "process_user_time": 0.927648, "process_kernel_time": 0.151156, "process_mem_max_rss": "204603392", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:51:18.399836 [debug] [MainThread]: Command `dbt run` failed at 13:51:18.399800 after 0.53 seconds
[0m13:51:18.400020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10622a2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b335d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106215350>]}
[0m13:51:18.400177 [debug] [MainThread]: Flushing usage events
[0m13:52:05.601777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107756890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d8dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d93d0>]}


============================== 13:52:05.603675 | d58e89af-5fc0-4f62-b08a-93f844662c2f ==============================
[0m13:52:05.603675 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:52:05.603968 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/CalvinLii/.dbt', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:52:05.921230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd58e89af-5fc0-4f62-b08a-93f844662c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e9c50>]}
[0m13:52:05.940402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd58e89af-5fc0-4f62-b08a-93f844662c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d3d290>]}
[0m13:52:05.940653 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:52:05.951636 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:52:06.034193 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m13:52:06.034507 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/_kaggle__sources.yml
[0m13:52:06.034682 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/_kaggle__models.yml
[0m13:52:06.034844 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/stg_kaggle__correl.sql
[0m13:52:06.091595 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_kaggle__correl (models/staging/kaggle/stg_kaggle__correl.sql)
  source() takes exactly two arguments (1 given)
[0m13:52:06.092610 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5168827, "process_user_time": 0.921676, "process_kernel_time": 0.143788, "process_mem_max_rss": "203931648", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:52:06.092841 [debug] [MainThread]: Command `dbt run` failed at 13:52:06.092803 after 0.52 seconds
[0m13:52:06.093005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d9150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107370b10>]}
[0m13:52:06.093152 [debug] [MainThread]: Flushing usage events
[0m13:53:19.019579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c57350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cd8d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cd9390>]}


============================== 13:53:19.021478 | 35633f90-4d24-447f-8c45-40f62e08bc74 ==============================
[0m13:53:19.021478 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:53:19.021758 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:53:19.343016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35633f90-4d24-447f-8c45-40f62e08bc74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c62b90>]}
[0m13:53:19.362354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35633f90-4d24-447f-8c45-40f62e08bc74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10350cd90>]}
[0m13:53:19.362639 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:53:19.374606 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:53:19.460841 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m13:53:19.461133 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/_kaggle__sources.yml
[0m13:53:19.461309 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/_kaggle__models.yml
[0m13:53:19.461485 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/stg_kaggle__correl.sql
[0m13:53:19.518829 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_kaggle__correl (models/staging/kaggle/stg_kaggle__correl.sql)
  source() takes exactly two arguments (1 given)
[0m13:53:19.519845 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5253599, "process_user_time": 0.925012, "process_kernel_time": 0.143177, "process_mem_max_rss": "205193216", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:53:19.520085 [debug] [MainThread]: Command `dbt run` failed at 13:53:19.520047 after 0.53 seconds
[0m13:53:19.520246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cd8f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cb08d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144b7f50>]}
[0m13:53:19.520400 [debug] [MainThread]: Flushing usage events
[0m13:56:47.442746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107249fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072ccb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072cd110>]}


============================== 13:56:47.445030 | b563a6d6-f0a6-494b-b1b9-c7e804377041 ==============================
[0m13:56:47.445030 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:56:47.445320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'version_check': 'True', 'profiles_dir': '/Users/CalvinLii/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:56:47.999313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b563a6d6-f0a6-494b-b1b9-c7e804377041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b71250>]}
[0m13:56:48.019114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b563a6d6-f0a6-494b-b1b9-c7e804377041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efaa9d0>]}
[0m13:56:48.019380 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:56:48.032384 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:56:48.128276 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m13:56:48.128583 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/_kaggle__models.yml
[0m13:56:48.128750 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/_kaggle__sources.yml
[0m13:56:48.128916 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/stg_kaggle__correl.sql
[0m13:56:48.187218 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_kaggle__correl (models/staging/kaggle/stg_kaggle__correl.sql)
  expected token ',', got '='
    line 4
      --     materialized='table',
[0m13:56:48.188583 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7724841, "process_user_time": 0.930362, "process_kernel_time": 0.203752, "process_mem_max_rss": "202375168", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:56:48.188826 [debug] [MainThread]: Command `dbt run` failed at 13:56:48.188789 after 0.77 seconds
[0m13:56:48.188990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072a48d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f382f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102de4c10>]}
[0m13:56:48.189148 [debug] [MainThread]: Flushing usage events
[0m14:00:41.089310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061570d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061d8d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061d9390>]}


============================== 14:00:41.091784 | b270de99-4807-460e-96d6-51df1ce6464f ==============================
[0m14:00:41.091784 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:00:41.092070 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:00:41.652228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b270de99-4807-460e-96d6-51df1ce6464f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e46a10>]}
[0m14:00:41.671273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b270de99-4807-460e-96d6-51df1ce6464f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103779090>]}
[0m14:00:41.671505 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:00:41.684731 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:00:41.785786 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m14:00:41.786125 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/_kaggle__models.yml
[0m14:00:41.786307 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/_kaggle__sources.yml
[0m14:00:41.786489 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/stg_kaggle__correl.sql
[0m14:00:41.845067 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_kaggle__correl (models/staging/kaggle/stg_kaggle__correl.sql)
  expected token ',', got '='
    line 4
      --     materialized='table',
[0m14:00:41.846829 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.78588873, "process_user_time": 0.986017, "process_kernel_time": 0.219278, "process_mem_max_rss": "203849728", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:00:41.847076 [debug] [MainThread]: Command `dbt run` failed at 14:00:41.847040 after 0.79 seconds
[0m14:00:41.847249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061d91d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117395190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b08d0>]}
[0m14:00:41.847403 [debug] [MainThread]: Flushing usage events
[0m14:06:56.959478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107493710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107514d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107515350>]}


============================== 14:06:56.961990 | e0f76996-86fb-481e-b523-cc8a9a2f1e85 ==============================
[0m14:06:56.961990 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:06:56.962292 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:57.481054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0f76996-86fb-481e-b523-cc8a9a2f1e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c2c50>]}
[0m14:06:57.500232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0f76996-86fb-481e-b523-cc8a9a2f1e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103444e90>]}
[0m14:06:57.500473 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:06:57.511997 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:06:57.609908 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m14:06:57.610236 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/_kaggle__models.yml
[0m14:06:57.610404 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/_kaggle__sources.yml
[0m14:06:57.610612 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/stg_kaggle__correl.sql
[0m14:06:57.669226 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_kaggle__correl (models/staging/kaggle/stg_kaggle__correl.sql)
  expected token ',', got '='
    line 4
      --     materialized='table',
[0m14:06:57.670945 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.739064, "process_user_time": 0.935972, "process_kernel_time": 0.197123, "process_mem_max_rss": "203489280", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:06:57.671167 [debug] [MainThread]: Command `dbt run` failed at 14:06:57.671131 after 0.74 seconds
[0m14:06:57.671328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075151d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107514fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1009f5410>]}
[0m14:06:57.671478 [debug] [MainThread]: Flushing usage events
[0m14:07:37.677644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10974af90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097cc990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097ccf90>]}


============================== 14:07:37.679524 | 6584cdb8-8a15-4826-ac1e-1fd9c7a8fa9e ==============================
[0m14:07:37.679524 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:07:37.679793 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:07:37.989711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6584cdb8-8a15-4826-ac1e-1fd9c7a8fa9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10977f090>]}
[0m14:07:38.009122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6584cdb8-8a15-4826-ac1e-1fd9c7a8fa9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d311d0>]}
[0m14:07:38.009414 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:07:38.021004 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:07:38.105796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m14:07:38.106103 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/_kaggle__sources.yml
[0m14:07:38.106280 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/_kaggle__models.yml
[0m14:07:38.106454 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/stg_kaggle__correl.sql
[0m14:07:38.195946 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid sources config given in models/staging/kaggle/_kaggle__sources.yml @ sources: {'name': 'kaggle_curriculum_rec', 'database': 'dbt-tutorial-428919', 'tables': [{'name': 'kaggle_correlation', 'identifier': {'schema': 'kaggle_curriculum_rec', 'type': 'bigquery'}}]} - at path ['tables'][0]['identifier']: {'schema': 'kaggle_curriculum_rec', 'type': 'bigquery'} is not valid under any of the given schemas
[0m14:07:38.197058 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5443569, "process_user_time": 0.960974, "process_kernel_time": 0.145293, "process_mem_max_rss": "207405056", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:07:38.197289 [debug] [MainThread]: Command `dbt run` failed at 14:07:38.197251 after 0.54 seconds
[0m14:07:38.197451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10978db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10979d590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f344950>]}
[0m14:07:38.197626 [debug] [MainThread]: Flushing usage events
[0m14:08:04.541210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110057490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100d8d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100d9310>]}


============================== 14:08:04.543115 | 969d74ab-edb6-4573-be8e-f91230a33193 ==============================
[0m14:08:04.543115 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:08:04.543400 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:08:04.859184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '969d74ab-edb6-4573-be8e-f91230a33193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116a652d0>]}
[0m14:08:04.878685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '969d74ab-edb6-4573-be8e-f91230a33193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105571350>]}
[0m14:08:04.878949 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:08:04.891828 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:08:04.975765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m14:08:04.976088 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/_kaggle__models.yml
[0m14:08:04.976264 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/_kaggle__sources.yml
[0m14:08:04.976434 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/stg_kaggle__correl.sql
[0m14:08:05.119816 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid sources config given in models/staging/kaggle/_kaggle__sources.yml @ sources: {'name': 'kaggle_curriculum_rec', 'database': 'dbt-tutorial-428919', 'tables': [{'name': 'kaggle_correlation', 'identifier': {'schema': 'kaggle_curriculum_rec', 'type': 'bigquery'}}]} - at path ['tables'][0]['identifier']: {'schema': 'kaggle_curriculum_rec', 'type': 'bigquery'} is not valid under any of the given schemas
[0m14:08:05.121029 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6046563, "process_user_time": 1.018757, "process_kernel_time": 0.146248, "process_mem_max_rss": "208977920", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:08:05.121275 [debug] [MainThread]: Command `dbt run` failed at 14:08:05.121232 after 0.60 seconds
[0m14:08:05.121441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110087d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aac8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11757ddd0>]}
[0m14:08:05.121602 [debug] [MainThread]: Flushing usage events
[0m14:16:14.476386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071579d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d8810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d8e10>]}


============================== 14:16:14.478782 | db3edead-d034-4bf0-baf0-1e341e7dee13 ==============================
[0m14:16:14.478782 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:16:14.479125 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:16:15.015437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db3edead-d034-4bf0-baf0-1e341e7dee13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116376890>]}
[0m14:16:15.034979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db3edead-d034-4bf0-baf0-1e341e7dee13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125e0b50>]}
[0m14:16:15.035332 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:16:15.048516 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:16:15.147150 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m14:16:15.147458 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/_kaggle__sources.yml
[0m14:16:15.147638 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/_kaggle__models.yml
[0m14:16:15.147801 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/stg_kaggle__correl.sql
[0m14:16:15.205941 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_kaggle__correl (models/staging/kaggle/stg_kaggle__correl.sql)
  expected token ',', got '='
    line 7
      --     materialized='table',
[0m14:16:15.207470 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.75875473, "process_user_time": 0.928075, "process_kernel_time": 0.196717, "process_mem_max_rss": "203816960", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:16:15.207695 [debug] [MainThread]: Command `dbt run` failed at 14:16:15.207656 after 0.76 seconds
[0m14:16:15.207850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071dad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d8bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11690eed0>]}
[0m14:16:15.207997 [debug] [MainThread]: Flushing usage events
[0m14:16:43.437423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a057510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a08fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0d9450>]}


============================== 14:16:43.439129 | 45790ef4-5244-4fcf-adb9-9d7f6e250a6e ==============================
[0m14:16:43.439129 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:16:43.439402 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:16:43.747979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45790ef4-5244-4fcf-adb9-9d7f6e250a6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118c40390>]}
[0m14:16:43.767147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45790ef4-5244-4fcf-adb9-9d7f6e250a6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106479210>]}
[0m14:16:43.767386 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:16:43.778669 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:16:43.860055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m14:16:43.860432 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/_kaggle__sources.yml
[0m14:16:43.860617 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/_kaggle__models.yml
[0m14:16:43.860797 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/stg_kaggle__correl.sql
[0m14:16:43.919441 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_kaggle__correl (models/staging/kaggle/stg_kaggle__correl.sql)
  expected token ',', got '='
    line 7
      --     materialized='table',
[0m14:16:43.920543 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.50784373, "process_user_time": 0.919773, "process_kernel_time": 0.145065, "process_mem_max_rss": "202899456", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:16:43.920788 [debug] [MainThread]: Command `dbt run` failed at 14:16:43.920749 after 0.51 seconds
[0m14:16:43.920968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0d8950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1195a3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0d9310>]}
[0m14:16:43.921132 [debug] [MainThread]: Flushing usage events
[0m14:21:21.140013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10586a890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10586a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058c4990>]}


============================== 14:21:21.142510 | 21bd2abf-1a8c-4cfe-ac21-0c6fbbe602ff ==============================
[0m14:21:21.142510 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:21:21.142808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:21:21.655633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21bd2abf-1a8c-4cfe-ac21-0c6fbbe602ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058681d0>]}
[0m14:21:21.674723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21bd2abf-1a8c-4cfe-ac21-0c6fbbe602ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e50e10>]}
[0m14:21:21.674964 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:21:21.687906 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:21:21.782524 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m14:21:21.782897 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/_kaggle__models.yml
[0m14:21:21.783068 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/_kaggle__sources.yml
[0m14:21:21.783244 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/stg_kaggle__correl.sql
[0m14:21:21.841160 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_kaggle__correl (models/staging/kaggle/stg_kaggle__correl.sql)
  expected token ',', got '='
    line 14
      --     materialized='table',
[0m14:21:21.842490 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.73050296, "process_user_time": 0.923927, "process_kernel_time": 0.190534, "process_mem_max_rss": "203177984", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:21:21.842750 [debug] [MainThread]: Command `dbt run` failed at 14:21:21.842694 after 0.73 seconds
[0m14:21:21.842930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058fe790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058b9f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101405510>]}
[0m14:21:21.843102 [debug] [MainThread]: Flushing usage events
[0m14:21:55.557640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ae2890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b33750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b65810>]}


============================== 14:21:55.559335 | 093aac1a-e522-48f5-9c67-f66026d44776 ==============================
[0m14:21:55.559335 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:21:55.559605 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:21:55.871010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '093aac1a-e522-48f5-9c67-f66026d44776', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af8f190>]}
[0m14:21:55.890418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '093aac1a-e522-48f5-9c67-f66026d44776', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040c9010>]}
[0m14:21:55.890708 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:21:55.902533 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:21:55.984386 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m14:21:55.984697 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/_kaggle__models.yml
[0m14:21:55.984866 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/_kaggle__sources.yml
[0m14:21:55.985036 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/stg_kaggle__correl.sql
[0m14:21:56.041920 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_kaggle__correl (models/staging/kaggle/stg_kaggle__correl.sql)
  Encountered unknown tag 'config'.
    line 4
      {% config %}
[0m14:21:56.042958 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5102759, "process_user_time": 0.918471, "process_kernel_time": 0.144088, "process_mem_max_rss": "205864960", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:21:56.043205 [debug] [MainThread]: Command `dbt run` failed at 14:21:56.043168 after 0.51 seconds
[0m14:21:56.043368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b71950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b67250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10167d510>]}
[0m14:21:56.043519 [debug] [MainThread]: Flushing usage events
[0m14:25:18.705936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053e2890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105437350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105465750>]}


============================== 14:25:18.707674 | 089cf04b-f400-4715-b846-171a32710a98 ==============================
[0m14:25:18.707674 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:25:18.707947 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:25:19.017670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '089cf04b-f400-4715-b846-171a32710a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1c3290>]}
[0m14:25:19.036718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '089cf04b-f400-4715-b846-171a32710a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039c8fd0>]}
[0m14:25:19.036983 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:25:19.048385 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:25:19.129759 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m14:25:19.130059 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/_kaggle__sources.yml
[0m14:25:19.130235 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/_kaggle__models.yml
[0m14:25:19.130398 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/stg_kaggle__correl.sql
[0m14:25:19.300755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '089cf04b-f400-4715-b846-171a32710a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104040650>]}
[0m14:25:19.344220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '089cf04b-f400-4715-b846-171a32710a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0080d0>]}
[0m14:25:19.344442 [info ] [MainThread]: Found 3 models, 6 data tests, 1 source, 588 macros
[0m14:25:19.344590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '089cf04b-f400-4715-b846-171a32710a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b172350>]}
[0m14:25:19.345337 [info ] [MainThread]: 
[0m14:25:19.345550 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:25:19.347045 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m14:25:19.347216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:19.859234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m14:25:19.860347 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:25:20.318191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '089cf04b-f400-4715-b846-171a32710a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5471d0>]}
[0m14:25:20.320077 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:25:20.320803 [info ] [MainThread]: 
[0m14:25:20.326222 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__content
[0m14:25:20.327062 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_curriculum_rec.stg_kaggle__content ............. [RUN]
[0m14:25:20.327678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.stg_kaggle__content)
[0m14:25:20.328094 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__content
[0m14:25:20.342209 [debug] [Thread-1 (]: Compilation Error in model stg_kaggle__content (models/staging/kaggle/stg_kaggle__content.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:25:20.343511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '089cf04b-f400-4715-b846-171a32710a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b27aa90>]}
[0m14:25:20.344004 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model dbt_curriculum_rec.stg_kaggle__content .... [[31mERROR[0m in 0.02s]
[0m14:25:20.344401 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__content
[0m14:25:20.344673 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__correl
[0m14:25:20.345751 [info ] [Thread-1 (]: 2 of 3 START sql view model dbt_curriculum_rec.stg_kaggle__correl .............. [RUN]
[0m14:25:20.346076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__content, now model.curriculum_rec.stg_kaggle__correl)
[0m14:25:20.346312 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__correl
[0m14:25:20.348341 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__correl"
[0m14:25:20.348862 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__correl
[0m14:25:20.366713 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__correl"
[0m14:25:20.367128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:20.368175 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__correl: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__correl"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__correl.sql
SELECT *
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_correlation`;


[0m14:25:21.070173 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:dd66c85f-9ffa-43a0-9cf2-4726d063e3d9&page=queryresults
[0m14:25:21.625827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '089cf04b-f400-4715-b846-171a32710a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b314610>]}
[0m14:25:21.626660 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dbt_curriculum_rec.stg_kaggle__correl ......... [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m14:25:21.627209 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__correl
[0m14:25:21.627558 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__topic
[0m14:25:21.627994 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_curriculum_rec.stg_kaggle__topic ............... [RUN]
[0m14:25:21.628377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__correl, now model.curriculum_rec.stg_kaggle__topic)
[0m14:25:21.628636 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__topic
[0m14:25:21.632178 [debug] [Thread-1 (]: Compilation Error in model stg_kaggle__topic (models/staging/kaggle/stg_kaggle__topic.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:25:21.632495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '089cf04b-f400-4715-b846-171a32710a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b34ecd0>]}
[0m14:25:21.632877 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model dbt_curriculum_rec.stg_kaggle__topic ...... [[31mERROR[0m in 0.00s]
[0m14:25:21.633214 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__topic
[0m14:25:21.634121 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:21.634325 [debug] [MainThread]: Connection 'model.curriculum_rec.stg_kaggle__topic' was properly closed.
[0m14:25:21.634566 [info ] [MainThread]: 
[0m14:25:21.634776 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.29 seconds (2.29s).
[0m14:25:21.635300 [debug] [MainThread]: Command end result
[0m14:25:21.656785 [info ] [MainThread]: 
[0m14:25:21.656994 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:25:21.657132 [info ] [MainThread]: 
[0m14:25:21.657311 [error] [MainThread]:   Compilation Error in model stg_kaggle__content (models/staging/kaggle/stg_kaggle__content.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:25:21.657450 [info ] [MainThread]: 
[0m14:25:21.657613 [error] [MainThread]:   Compilation Error in model stg_kaggle__topic (models/staging/kaggle/stg_kaggle__topic.sql)
  'macros' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:25:21.657751 [info ] [MainThread]: 
[0m14:25:21.657897 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m14:25:21.659050 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.9780257, "process_user_time": 1.334767, "process_kernel_time": 0.174756, "process_mem_max_rss": "215646208", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:25:21.659311 [debug] [MainThread]: Command `dbt run` failed at 14:25:21.659270 after 2.98 seconds
[0m14:25:21.659489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105465250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ffc8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100f7cc50>]}
[0m14:25:21.659647 [debug] [MainThread]: Flushing usage events
[0m14:26:29.862385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dfae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dfa850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e2bd90>]}


============================== 14:26:29.864080 | 76cbff38-aa7f-4920-858e-39851188feaf ==============================
[0m14:26:29.864080 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:26:29.864356 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/CalvinLii/.dbt', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:26:30.171163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76cbff38-aa7f-4920-858e-39851188feaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b922450>]}
[0m14:26:30.190288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76cbff38-aa7f-4920-858e-39851188feaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c698f10>]}
[0m14:26:30.190521 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:26:30.201720 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:26:30.287847 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m14:26:30.288197 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/_kaggle__sources.yml
[0m14:26:30.288378 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/stg_kaggle__content.sql
[0m14:26:30.288536 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/stg_kaggle__topic.sql
[0m14:26:30.463060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76cbff38-aa7f-4920-858e-39851188feaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9841d0>]}
[0m14:26:30.502278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76cbff38-aa7f-4920-858e-39851188feaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc003d0>]}
[0m14:26:30.502508 [info ] [MainThread]: Found 3 models, 6 data tests, 3 sources, 588 macros
[0m14:26:30.502660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76cbff38-aa7f-4920-858e-39851188feaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb17c50>]}
[0m14:26:30.503493 [info ] [MainThread]: 
[0m14:26:30.503763 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:26:30.505437 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m14:26:30.505599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:26:31.114648 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m14:26:31.115665 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:26:31.535152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76cbff38-aa7f-4920-858e-39851188feaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c656650>]}
[0m14:26:31.536535 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:26:31.537111 [info ] [MainThread]: 
[0m14:26:31.541140 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__content
[0m14:26:31.542210 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_curriculum_rec.stg_kaggle__content ............. [RUN]
[0m14:26:31.542943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.stg_kaggle__content)
[0m14:26:31.543387 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__content
[0m14:26:31.551398 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__content"
[0m14:26:31.553551 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__content
[0m14:26:31.577185 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__content"
[0m14:26:31.577888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:31.579036 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__content.sql
SELECT *
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_content`;


[0m14:26:32.529591 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:2f86409b-23f7-4a17-8f2b-8f168c46589f&page=queryresults
[0m14:26:33.089381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76cbff38-aa7f-4920-858e-39851188feaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c95c3d0>]}
[0m14:26:33.090184 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dbt_curriculum_rec.stg_kaggle__content ........ [[32mCREATE VIEW (0 processed)[0m in 1.55s]
[0m14:26:33.090707 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__content
[0m14:26:33.091057 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__correl
[0m14:26:33.091514 [info ] [Thread-1 (]: 2 of 3 START sql view model dbt_curriculum_rec.stg_kaggle__correl .............. [RUN]
[0m14:26:33.091938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__content, now model.curriculum_rec.stg_kaggle__correl)
[0m14:26:33.092241 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__correl
[0m14:26:33.094730 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__correl"
[0m14:26:33.095405 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__correl
[0m14:26:33.097264 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__correl"
[0m14:26:33.097750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:33.098979 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__correl: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__correl"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__correl.sql
SELECT *
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_correlation`;


[0m14:26:33.845197 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:32fd3781-5ce6-49c8-aac4-c1b7372bfd4a&page=queryresults
[0m14:26:34.226518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76cbff38-aa7f-4920-858e-39851188feaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10caec750>]}
[0m14:26:34.227991 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dbt_curriculum_rec.stg_kaggle__correl ......... [[32mCREATE VIEW (0 processed)[0m in 1.13s]
[0m14:26:34.228925 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__correl
[0m14:26:34.229505 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__topic
[0m14:26:34.230242 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_curriculum_rec.stg_kaggle__topic ............... [RUN]
[0m14:26:34.230900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__correl, now model.curriculum_rec.stg_kaggle__topic)
[0m14:26:34.231282 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__topic
[0m14:26:34.234784 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__topic"
[0m14:26:34.235703 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__topic
[0m14:26:34.238501 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__topic"
[0m14:26:34.239574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:34.241233 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__topic: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__topic"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__topics.sql
SELECT *
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_topic`;


[0m14:26:34.916287 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:3817b21c-b045-4237-a4d5-2748f96a5222&page=queryresults
[0m14:26:35.517225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76cbff38-aa7f-4920-858e-39851188feaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9857d0>]}
[0m14:26:35.518576 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dbt_curriculum_rec.stg_kaggle__topic .......... [[32mCREATE VIEW (0 processed)[0m in 1.29s]
[0m14:26:35.519497 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__topic
[0m14:26:35.521548 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:26:35.522197 [debug] [MainThread]: Connection 'model.curriculum_rec.stg_kaggle__topic' was properly closed.
[0m14:26:35.522670 [info ] [MainThread]: 
[0m14:26:35.523052 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 5.02 seconds (5.02s).
[0m14:26:35.524080 [debug] [MainThread]: Command end result
[0m14:26:35.552591 [info ] [MainThread]: 
[0m14:26:35.552849 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:26:35.553035 [info ] [MainThread]: 
[0m14:26:35.553214 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:26:35.554625 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.7167826, "process_user_time": 1.504307, "process_kernel_time": 0.185484, "process_mem_max_rss": "215564288", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:26:35.555013 [debug] [MainThread]: Command `dbt run` succeeded at 14:26:35.554952 after 5.72 seconds
[0m14:26:35.555240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e4ad10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e7f090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102994c10>]}
[0m14:26:35.555450 [debug] [MainThread]: Flushing usage events
[0m15:47:13.995855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091dac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10922f350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10925dad0>]}


============================== 15:47:13.998986 | 5f6a2391-f4bd-4482-86ca-7fc2019c813d ==============================
[0m15:47:13.998986 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:47:13.999285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:47:14.541066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f6a2391-f4bd-4482-86ca-7fc2019c813d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9b9b90>]}
[0m15:47:14.561578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f6a2391-f4bd-4482-86ca-7fc2019c813d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077b9310>]}
[0m15:47:14.561948 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:47:14.575188 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:47:14.684166 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m15:47:14.684489 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/_kaggle__sources.yml
[0m15:47:14.684673 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/stg_kaggle__correl.sql
[0m15:47:14.684828 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/stg_kaggle__topic.sql
[0m15:47:14.684973 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/stg_kaggle__content.sql
[0m15:47:14.837830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f6a2391-f4bd-4482-86ca-7fc2019c813d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee5a5d0>]}
[0m15:47:14.884518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f6a2391-f4bd-4482-86ca-7fc2019c813d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed63a50>]}
[0m15:47:14.884755 [info ] [MainThread]: Found 3 models, 6 data tests, 3 sources, 588 macros
[0m15:47:14.884905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f6a2391-f4bd-4482-86ca-7fc2019c813d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eef6410>]}
[0m15:47:14.885685 [info ] [MainThread]: 
[0m15:47:14.885903 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:47:14.887458 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m15:47:14.887623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:15.407937 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m15:47:15.408918 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:15.902858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f6a2391-f4bd-4482-86ca-7fc2019c813d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef55610>]}
[0m15:47:15.904142 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:47:15.904656 [info ] [MainThread]: 
[0m15:47:15.909244 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__content
[0m15:47:15.910044 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_curriculum_rec.stg_kaggle__content ............. [RUN]
[0m15:47:15.910655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.stg_kaggle__content)
[0m15:47:15.911060 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__content
[0m15:47:15.917888 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__content"
[0m15:47:15.919154 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__content
[0m15:47:15.940649 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__content"
[0m15:47:15.941192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:15.942391 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__content.sql
SELECT 
    id as id_content, 
    title as cat_content_title, 
    description as cat_content_description, 
    kind as cat_content_kind 
    text as cat_content_text 
    copyright_holder as cat_content_copyright_holder,
    license as id_content_license 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_content`;


[0m15:47:16.438039 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:22268a9d-edd2-444f-8cb4-90c52fa02850&page=queryresults
[0m15:47:16.439267 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got identifier "text" at [12:5]; reason: invalidQuery, location: query, message: Syntax error: Expected end of input but got identifier "text" at [12:5]')
[0m15:47:17.218005 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:b144a9d8-3ed7-45c0-90d3-262a96bdd6b7&page=queryresults
[0m15:47:17.219649 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:b144a9d8-3ed7-45c0-90d3-262a96bdd6b7&page=queryresults
[0m15:47:17.232139 [debug] [Thread-1 (]: Database Error in model stg_kaggle__content (models/staging/kaggle/stg_kaggle__content.sql)
  Syntax error: Expected end of input but got identifier "text" at [12:5]
  compiled Code at target/run/curriculum_rec/models/staging/kaggle/stg_kaggle__content.sql
[0m15:47:17.233780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f6a2391-f4bd-4482-86ca-7fc2019c813d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f053450>]}
[0m15:47:17.234445 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model dbt_curriculum_rec.stg_kaggle__content .... [[31mERROR[0m in 1.32s]
[0m15:47:17.234951 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__content
[0m15:47:17.235306 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__correl
[0m15:47:17.236742 [info ] [Thread-1 (]: 2 of 3 START sql view model dbt_curriculum_rec.stg_kaggle__correl .............. [RUN]
[0m15:47:17.237190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__content, now model.curriculum_rec.stg_kaggle__correl)
[0m15:47:17.237475 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__correl
[0m15:47:17.240261 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__correl"
[0m15:47:17.240896 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__correl
[0m15:47:17.242817 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__correl"
[0m15:47:17.243275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:17.244537 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__correl: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__correl"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__correl.sql
SELECT 
    topic_id as id_topic, 
    content_ids as id_content_list
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_correlation`;


[0m15:47:18.292739 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:3b07d373-dae3-4b18-8d5e-4c5a870ec587&page=queryresults
[0m15:47:18.867065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f6a2391-f4bd-4482-86ca-7fc2019c813d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f03b050>]}
[0m15:47:18.867895 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dbt_curriculum_rec.stg_kaggle__correl ......... [[32mCREATE VIEW (0 processed)[0m in 1.63s]
[0m15:47:18.868414 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__correl
[0m15:47:18.868769 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__topic
[0m15:47:18.869270 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_curriculum_rec.stg_kaggle__topic ............... [RUN]
[0m15:47:18.869709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__correl, now model.curriculum_rec.stg_kaggle__topic)
[0m15:47:18.870007 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__topic
[0m15:47:18.872619 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__topic"
[0m15:47:18.873338 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__topic
[0m15:47:18.877792 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__topic"
[0m15:47:18.878350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:18.879604 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__topic: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__topic"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__topics.sql
SELECT  
    id as id_topic, 
    title as cat_topic_title, 
    description as cat_topic_description, 
    channel as id_topic_description, 
    -- already encoded don't need to use case when -- 
    category as cat_topic_category, 
    level as val_topic_level, 
    parent as id_topic_parent, 
    has_content as ind_topic_has_content
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_topic`;


[0m15:47:19.625019 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:507d08ee-1f59-4564-b604-ff0bc4383171&page=queryresults
[0m15:47:19.961101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f6a2391-f4bd-4482-86ca-7fc2019c813d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f074fd0>]}
[0m15:47:19.962160 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dbt_curriculum_rec.stg_kaggle__topic .......... [[32mCREATE VIEW (0 processed)[0m in 1.09s]
[0m15:47:19.962734 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__topic
[0m15:47:19.964118 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:47:19.964471 [debug] [MainThread]: Connection 'model.curriculum_rec.stg_kaggle__topic' was properly closed.
[0m15:47:19.964812 [info ] [MainThread]: 
[0m15:47:19.965098 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 5.08 seconds (5.08s).
[0m15:47:19.965911 [debug] [MainThread]: Command end result
[0m15:47:19.991998 [info ] [MainThread]: 
[0m15:47:19.992373 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:47:19.992610 [info ] [MainThread]: 
[0m15:47:19.992870 [error] [MainThread]:   Database Error in model stg_kaggle__content (models/staging/kaggle/stg_kaggle__content.sql)
  Syntax error: Expected end of input but got identifier "text" at [12:5]
  compiled Code at target/run/curriculum_rec/models/staging/kaggle/stg_kaggle__content.sql
[0m15:47:19.993054 [info ] [MainThread]: 
[0m15:47:19.993255 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m15:47:19.995078 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.0293427, "process_user_time": 1.495149, "process_kernel_time": 0.242073, "process_mem_max_rss": "213680128", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:47:19.995475 [debug] [MainThread]: Command `dbt run` failed at 15:47:19.995422 after 6.03 seconds
[0m15:47:19.995701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092348d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d75550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10922e3d0>]}
[0m15:47:19.995915 [debug] [MainThread]: Flushing usage events
[0m15:47:30.368046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107057410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10708fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b0790>]}


============================== 15:47:30.370121 | 34ed17fc-acbb-4e95-b4ff-f8b02ffba5dd ==============================
[0m15:47:30.370121 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:47:30.370434 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:47:30.690876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34ed17fc-acbb-4e95-b4ff-f8b02ffba5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d55e790>]}
[0m15:47:30.710534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34ed17fc-acbb-4e95-b4ff-f8b02ffba5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d79050>]}
[0m15:47:30.710790 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:47:30.721258 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:47:30.811212 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:47:30.811595 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/stg_kaggle__content.sql
[0m15:47:30.951834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34ed17fc-acbb-4e95-b4ff-f8b02ffba5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6f5f50>]}
[0m15:47:30.993267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34ed17fc-acbb-4e95-b4ff-f8b02ffba5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da4e850>]}
[0m15:47:30.993513 [info ] [MainThread]: Found 3 models, 6 data tests, 3 sources, 588 macros
[0m15:47:30.993666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34ed17fc-acbb-4e95-b4ff-f8b02ffba5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da43810>]}
[0m15:47:30.994471 [info ] [MainThread]: 
[0m15:47:30.994705 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:47:30.996331 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m15:47:30.996523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:31.421558 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m15:47:31.422239 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:31.848282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34ed17fc-acbb-4e95-b4ff-f8b02ffba5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da81650>]}
[0m15:47:31.849436 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:47:31.849897 [info ] [MainThread]: 
[0m15:47:31.853327 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__content
[0m15:47:31.854314 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_curriculum_rec.stg_kaggle__content ............. [RUN]
[0m15:47:31.854975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.stg_kaggle__content)
[0m15:47:31.855403 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__content
[0m15:47:31.863728 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__content"
[0m15:47:31.864570 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__content
[0m15:47:31.885357 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__content"
[0m15:47:31.885791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:31.886898 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__content.sql
SELECT 
    id as id_content, 
    title as cat_content_title, 
    description as cat_content_description, 
    kind as cat_content_kind,
    text as cat_content_text,
    copyright_holder as cat_content_copyright_holder,
    license as id_content_license 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_content`;


[0m15:47:32.833512 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:c17a2adc-f42e-48cb-a664-3ad5771d39b0&page=queryresults
[0m15:47:33.257584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34ed17fc-acbb-4e95-b4ff-f8b02ffba5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd28850>]}
[0m15:47:33.258867 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dbt_curriculum_rec.stg_kaggle__content ........ [[32mCREATE VIEW (0 processed)[0m in 1.40s]
[0m15:47:33.259625 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__content
[0m15:47:33.260144 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__correl
[0m15:47:33.260725 [info ] [Thread-1 (]: 2 of 3 START sql view model dbt_curriculum_rec.stg_kaggle__correl .............. [RUN]
[0m15:47:33.261190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__content, now model.curriculum_rec.stg_kaggle__correl)
[0m15:47:33.261494 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__correl
[0m15:47:33.263766 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__correl"
[0m15:47:33.264446 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__correl
[0m15:47:33.266250 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__correl"
[0m15:47:33.266726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:33.268049 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__correl: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__correl"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__correl.sql
SELECT 
    topic_id as id_topic, 
    content_ids as id_content_list
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_correlation`;


[0m15:47:33.961135 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:568f91ad-5499-49df-87b6-83d828b665f2&page=queryresults
[0m15:47:34.666579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34ed17fc-acbb-4e95-b4ff-f8b02ffba5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd29310>]}
[0m15:47:34.667797 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dbt_curriculum_rec.stg_kaggle__correl ......... [[32mCREATE VIEW (0 processed)[0m in 1.41s]
[0m15:47:34.668451 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__correl
[0m15:47:34.668926 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__topic
[0m15:47:34.669529 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_curriculum_rec.stg_kaggle__topic ............... [RUN]
[0m15:47:34.670599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__correl, now model.curriculum_rec.stg_kaggle__topic)
[0m15:47:34.671185 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__topic
[0m15:47:34.675405 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__topic"
[0m15:47:34.676198 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__topic
[0m15:47:34.678769 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__topic"
[0m15:47:34.679428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:34.681206 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__topic: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__topic"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__topics.sql
SELECT  
    id as id_topic, 
    title as cat_topic_title, 
    description as cat_topic_description, 
    channel as id_topic_description, 
    -- already encoded don't need to use case when -- 
    category as cat_topic_category, 
    level as val_topic_level, 
    parent as id_topic_parent, 
    has_content as ind_topic_has_content
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_topic`;


[0m15:47:35.394482 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:65c770dc-acdc-4340-b0aa-ccd7efe8b357&page=queryresults
[0m15:47:35.908260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34ed17fc-acbb-4e95-b4ff-f8b02ffba5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcd0610>]}
[0m15:47:35.909405 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dbt_curriculum_rec.stg_kaggle__topic .......... [[32mCREATE VIEW (0 processed)[0m in 1.24s]
[0m15:47:35.910176 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__topic
[0m15:47:35.912550 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:47:35.913192 [debug] [MainThread]: Connection 'model.curriculum_rec.stg_kaggle__topic' was properly closed.
[0m15:47:35.913690 [info ] [MainThread]: 
[0m15:47:35.914116 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.92 seconds (4.92s).
[0m15:47:35.915132 [debug] [MainThread]: Command end result
[0m15:47:35.943766 [info ] [MainThread]: 
[0m15:47:35.944044 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:47:35.944230 [info ] [MainThread]: 
[0m15:47:35.944417 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:47:35.945730 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.6024656, "process_user_time": 1.47507, "process_kernel_time": 0.184368, "process_mem_max_rss": "214122496", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:47:35.946148 [debug] [MainThread]: Command `dbt run` succeeded at 15:47:35.946072 after 5.60 seconds
[0m15:47:35.946396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070a6a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ee9d50>]}
[0m15:47:35.946624 [debug] [MainThread]: Flushing usage events
[0m16:35:28.164218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119491890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119514790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119514d90>]}


============================== 16:35:28.167084 | 71abb6e2-bc41-4c50-81eb-28f213fa327b ==============================
[0m16:35:28.167084 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:35:28.167420 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'profiles_dir': '/Users/CalvinLii/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:35:28.723893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71abb6e2-bc41-4c50-81eb-28f213fa327b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139bfc950>]}
[0m16:35:28.744575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71abb6e2-bc41-4c50-81eb-28f213fa327b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b790d0>]}
[0m16:35:28.744949 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m16:35:28.758413 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:35:28.862253 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:35:28.862608 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/stg_kaggle__correl.sql
[0m16:35:29.012684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71abb6e2-bc41-4c50-81eb-28f213fa327b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139fb4b50>]}
[0m16:35:29.058377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71abb6e2-bc41-4c50-81eb-28f213fa327b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a923cd0>]}
[0m16:35:29.058611 [info ] [MainThread]: Found 3 models, 6 data tests, 3 sources, 588 macros
[0m16:35:29.058762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71abb6e2-bc41-4c50-81eb-28f213fa327b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139e168d0>]}
[0m16:35:29.059560 [info ] [MainThread]: 
[0m16:35:29.059782 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:35:29.061314 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m16:35:29.061504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:29.677140 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m16:35:29.678001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:30.120406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71abb6e2-bc41-4c50-81eb-28f213fa327b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139c00bd0>]}
[0m16:35:30.121664 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:35:30.122082 [info ] [MainThread]: 
[0m16:35:30.126547 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__content
[0m16:35:30.127469 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_curriculum_rec.stg_kaggle__content ............. [RUN]
[0m16:35:30.128178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.stg_kaggle__content)
[0m16:35:30.128611 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__content
[0m16:35:30.136719 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__content"
[0m16:35:30.137962 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__content
[0m16:35:30.159298 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__content"
[0m16:35:30.159829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:30.160915 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__content.sql
SELECT 
    id as id_content, 
    title as cat_content_title, 
    description as cat_content_description, 
    kind as cat_content_kind,
    text as cat_content_text,
    copyright_holder as cat_content_copyright_holder,
    license as id_content_license 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_content`;


[0m16:35:30.801856 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:60d58798-32e6-457b-ab9a-01f544eb1f9a&page=queryresults
[0m16:35:31.402112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71abb6e2-bc41-4c50-81eb-28f213fa327b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ab8ebd0>]}
[0m16:35:31.402546 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dbt_curriculum_rec.stg_kaggle__content ........ [[32mCREATE VIEW (0 processed)[0m in 1.27s]
[0m16:35:31.402865 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__content
[0m16:35:31.403083 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__correl
[0m16:35:31.403404 [info ] [Thread-1 (]: 2 of 3 START sql view model dbt_curriculum_rec.stg_kaggle__correl .............. [RUN]
[0m16:35:31.403683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__content, now model.curriculum_rec.stg_kaggle__correl)
[0m16:35:31.403876 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__correl
[0m16:35:31.405549 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__correl"
[0m16:35:31.407219 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__correl
[0m16:35:31.409281 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__correl"
[0m16:35:31.409956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:31.411221 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__correl: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__correl"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__correl.sql
SELECT 
    topic_id as id_correl_topic, 
    -- probably can do some sort of transformation here it should be a list not a string --  
    -- sql doesn't natively use lists though -- 
    -- have to make the table better don't use lists -- 
    content_id as id_correl_content 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_correlation`;


[0m16:35:32.136803 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:e0a4d16e-adca-41e1-a23c-028b68ea3db3&page=queryresults
[0m16:35:32.635997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71abb6e2-bc41-4c50-81eb-28f213fa327b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a850590>]}
[0m16:35:32.636915 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dbt_curriculum_rec.stg_kaggle__correl ......... [[32mCREATE VIEW (0 processed)[0m in 1.23s]
[0m16:35:32.637666 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__correl
[0m16:35:32.638076 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__topic
[0m16:35:32.638618 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_curriculum_rec.stg_kaggle__topic ............... [RUN]
[0m16:35:32.639093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__correl, now model.curriculum_rec.stg_kaggle__topic)
[0m16:35:32.639431 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__topic
[0m16:35:32.641283 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__topic"
[0m16:35:32.641684 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__topic
[0m16:35:32.642913 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__topic"
[0m16:35:32.643234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:32.645110 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__topic: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__topic"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__topics.sql
SELECT  
    id as id_topic, 
    title as cat_topic_title, 
    description as cat_topic_description, 
    channel as id_topic_description, 
    -- already encoded don't need to use case when -- 
    category as cat_topic_category, 
    level as val_topic_level, 
    parent as id_topic_parent, 
    has_content as ind_topic_has_content
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_topic`;


[0m16:35:34.250433 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:2dc76ae9-2451-4ef0-ab05-029ed8ac2b31&page=queryresults
[0m16:35:34.940275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71abb6e2-bc41-4c50-81eb-28f213fa327b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e30b7d0>]}
[0m16:35:34.941350 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dbt_curriculum_rec.stg_kaggle__topic .......... [[32mCREATE VIEW (0 processed)[0m in 2.30s]
[0m16:35:34.942050 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__topic
[0m16:35:34.943519 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:34.944034 [debug] [MainThread]: Connection 'model.curriculum_rec.stg_kaggle__topic' was properly closed.
[0m16:35:34.944507 [info ] [MainThread]: 
[0m16:35:34.944796 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 5.88 seconds (5.88s).
[0m16:35:34.945513 [debug] [MainThread]: Command end result
[0m16:35:34.970340 [info ] [MainThread]: 
[0m16:35:34.970751 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:35:34.971024 [info ] [MainThread]: 
[0m16:35:34.971242 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:35:34.973221 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.8396835, "process_user_time": 1.464835, "process_kernel_time": 0.241657, "process_mem_max_rss": "213794816", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:35:34.973633 [debug] [MainThread]: Command `dbt run` succeeded at 16:35:34.973574 after 6.84 seconds
[0m16:35:34.973854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119123e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103491c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033ed510>]}
[0m16:35:34.974047 [debug] [MainThread]: Flushing usage events
[0m12:02:18.446282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064934d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e2150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e3190>]}


============================== 12:02:18.448852 | ee8370f5-b5d5-4130-baac-7ae2c005d9ef ==============================
[0m12:02:18.448852 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:02:18.449158 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/CalvinLii/.dbt', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:02:18.990394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee8370f5-b5d5-4130-baac-7ae2c005d9ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10649ead0>]}
[0m12:02:19.009983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee8370f5-b5d5-4130-baac-7ae2c005d9ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a41410>]}
[0m12:02:19.010238 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m12:02:19.023144 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m12:02:19.125874 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 3 files changed.
[0m12:02:19.126150 [debug] [MainThread]: Partial parsing: added file: curriculum_rec://models/intermediate/placeholder.sql
[0m12:02:19.126325 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/stg_kaggle__content.sql
[0m12:02:19.126477 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/stg_kaggle__topic.sql
[0m12:02:19.126627 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/staging/kaggle/stg_kaggle__correl.sql
[0m12:02:19.275196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee8370f5-b5d5-4130-baac-7ae2c005d9ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1cd550>]}
[0m12:02:19.321746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee8370f5-b5d5-4130-baac-7ae2c005d9ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea0bbd0>]}
[0m12:02:19.322115 [info ] [MainThread]: Found 4 models, 6 data tests, 3 sources, 588 macros
[0m12:02:19.322287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee8370f5-b5d5-4130-baac-7ae2c005d9ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e93ea90>]}
[0m12:02:19.323110 [info ] [MainThread]: 
[0m12:02:19.323320 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:02:19.324925 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m12:02:19.325141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:20.074639 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m12:02:20.075537 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:20.444977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee8370f5-b5d5-4130-baac-7ae2c005d9ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7eefd0>]}
[0m12:02:20.446042 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:02:20.446493 [info ] [MainThread]: 
[0m12:02:20.450948 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__content
[0m12:02:20.451578 [info ] [Thread-1 (]: 1 of 4 START sql view model dbt_curriculum_rec.stg_kaggle__content ............. [RUN]
[0m12:02:20.452064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.stg_kaggle__content)
[0m12:02:20.452387 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__content
[0m12:02:20.459908 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__content"
[0m12:02:20.460799 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__content
[0m12:02:20.480886 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__content"
[0m12:02:20.481316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:20.482389 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__content.sql
WITH raw_content AS 
(
SELECT 
    id as id_content, 
    title as cat_content_title, 
    description as cat_content_description, 
    kind as cat_content_kind,
    text as cat_content_text,
    copyright_holder as cat_content_copyright_holder,
    license as id_content_license 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_content`
) 

SELECT 
    * 
FROM raw_content;


[0m12:02:21.046979 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:a181ab33-4dcd-4073-866d-62f395ddeb93&page=queryresults
[0m12:02:21.588430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee8370f5-b5d5-4130-baac-7ae2c005d9ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea9a910>]}
[0m12:02:21.589216 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbt_curriculum_rec.stg_kaggle__content ........ [[32mCREATE VIEW (0 processed)[0m in 1.14s]
[0m12:02:21.589727 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__content
[0m12:02:21.590056 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__correl
[0m12:02:21.590481 [info ] [Thread-1 (]: 2 of 4 START sql view model dbt_curriculum_rec.stg_kaggle__correl .............. [RUN]
[0m12:02:21.590867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__content, now model.curriculum_rec.stg_kaggle__correl)
[0m12:02:21.591126 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__correl
[0m12:02:21.593575 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__correl"
[0m12:02:21.595656 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__correl
[0m12:02:21.597569 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__correl"
[0m12:02:21.598264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:21.599676 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__correl: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__correl"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__correl.sql
WITH raw_correl AS 
(
    SELECT 
    topic_id as id_topic, 
    -- probably can do some sort of transformation here it should be a list not a string --  
    -- sql doesn't natively use lists though -- 
    -- have to make the table better don't use lists -- 
    content_id as id_content 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_correlation`
)

SELECT 
    * 
FROM raw_correl;


[0m12:02:22.256020 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:182677b1-6f2a-4feb-a154-ee3a496cbf6f&page=queryresults
[0m12:02:23.007689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee8370f5-b5d5-4130-baac-7ae2c005d9ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2e26d0>]}
[0m12:02:23.009005 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dbt_curriculum_rec.stg_kaggle__correl ......... [[32mCREATE VIEW (0 processed)[0m in 1.42s]
[0m12:02:23.009793 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__correl
[0m12:02:23.010162 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__topic
[0m12:02:23.011034 [info ] [Thread-1 (]: 3 of 4 START sql view model dbt_curriculum_rec.stg_kaggle__topic ............... [RUN]
[0m12:02:23.011513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__correl, now model.curriculum_rec.stg_kaggle__topic)
[0m12:02:23.011863 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__topic
[0m12:02:23.015318 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__topic"
[0m12:02:23.015974 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__topic
[0m12:02:23.019828 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__topic"
[0m12:02:23.020373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:23.021637 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__topic: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__topic"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__topics.sql
WITH raw_topics AS 
(
SELECT  
    id as id_topic, 
    title as cat_topic_title, 
    description as cat_topic_description, 
    channel as id_topic_description, 
    -- already encoded don't need to use case when -- 
    category as cat_topic_category, 
    level as val_topic_level, 
    parent as id_topic_parent, 
    has_content as ind_topic_has_content
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_topic`
) 

SELECT 
    *
FROM raw_topics;


[0m12:02:23.719738 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:a471b9f6-62fa-4e88-85ba-8f2c3da9bcda&page=queryresults
[0m12:02:24.039798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee8370f5-b5d5-4130-baac-7ae2c005d9ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eae74d0>]}
[0m12:02:24.040989 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dbt_curriculum_rec.stg_kaggle__topic .......... [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m12:02:24.041586 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__topic
[0m12:02:24.042522 [debug] [Thread-1 (]: Began running node model.curriculum_rec.placeholder
[0m12:02:24.043249 [info ] [Thread-1 (]: 4 of 4 START sql view model dbt_curriculum_rec.placeholder ..................... [RUN]
[0m12:02:24.043722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__topic, now model.curriculum_rec.placeholder)
[0m12:02:24.044025 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.placeholder
[0m12:02:24.047467 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.placeholder"
[0m12:02:24.048675 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.placeholder
[0m12:02:24.050654 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.placeholder"
[0m12:02:24.051212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:24.052501 [debug] [Thread-1 (]: On model.curriculum_rec.placeholder: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.placeholder"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`placeholder`
  OPTIONS()
  as with 
correlation as (
    SELECT * FROM  `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
)

content as (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
)

topic as (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
);


[0m12:02:24.377846 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:21dd616d-15ea-4598-a840-fe5cb1bdccd9&page=queryresults
[0m12:02:24.379503 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected identifier "content" at [11:1]; reason: invalidQuery, location: query, message: Syntax error: Unexpected identifier "content" at [11:1]')
[0m12:02:25.001672 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:e9666849-2b89-4672-8a8f-1d1534fbcc97&page=queryresults
[0m12:02:25.003619 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:e9666849-2b89-4672-8a8f-1d1534fbcc97&page=queryresults
[0m12:02:25.017036 [debug] [Thread-1 (]: Database Error in model placeholder (models/intermediate/placeholder.sql)
  Syntax error: Unexpected identifier "content" at [11:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/placeholder.sql
[0m12:02:25.017611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee8370f5-b5d5-4130-baac-7ae2c005d9ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea7a990>]}
[0m12:02:25.018233 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model dbt_curriculum_rec.placeholder ............ [[31mERROR[0m in 0.97s]
[0m12:02:25.018691 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.placeholder
[0m12:02:25.020361 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:02:25.020596 [debug] [MainThread]: Connection 'model.curriculum_rec.placeholder' was properly closed.
[0m12:02:25.020868 [info ] [MainThread]: 
[0m12:02:25.021108 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 5.70 seconds (5.70s).
[0m12:02:25.021876 [debug] [MainThread]: Command end result
[0m12:02:25.046252 [info ] [MainThread]: 
[0m12:02:25.046501 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:02:25.046665 [info ] [MainThread]: 
[0m12:02:25.046862 [error] [MainThread]:   Database Error in model placeholder (models/intermediate/placeholder.sql)
  Syntax error: Unexpected identifier "content" at [11:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/placeholder.sql
[0m12:02:25.047023 [info ] [MainThread]: 
[0m12:02:25.047183 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m12:02:25.048903 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.632226, "process_user_time": 1.526507, "process_kernel_time": 0.246877, "process_mem_max_rss": "216399872", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:02:25.049194 [debug] [MainThread]: Command `dbt run` failed at 12:02:25.049150 after 6.63 seconds
[0m12:02:25.049386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106516fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064ec8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ff5510>]}
[0m12:02:25.049559 [debug] [MainThread]: Flushing usage events
[0m14:25:55.653890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f562d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fa7e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fb0550>]}


============================== 14:25:55.656361 | d1ae37d3-a4db-42c8-ae37-11d66ae7f71e ==============================
[0m14:25:55.656361 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:25:55.656674 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:25:56.196866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1ae37d3-a4db-42c8-ae37-11d66ae7f71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150ae050>]}
[0m14:25:56.216185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1ae37d3-a4db-42c8-ae37-11d66ae7f71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104471390>]}
[0m14:25:56.216424 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:25:56.228495 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:25:56.335999 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 0 files changed.
[0m14:25:56.336341 [debug] [MainThread]: Partial parsing: added file: curriculum_rec://macros/generate_topic_hierarchy.sql
[0m14:25:56.336488 [debug] [MainThread]: Partial parsing: added file: curriculum_rec://models/marts/education/content.sql
[0m14:25:56.336607 [debug] [MainThread]: Partial parsing: added file: curriculum_rec://models/intermediate/education/placeholder.sql
[0m14:25:56.336712 [debug] [MainThread]: Partial parsing: deleted file: curriculum_rec://models/intermediate/placeholder.sql
[0m14:25:56.430856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1ae37d3-a4db-42c8-ae37-11d66ae7f71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b9aad0>]}
[0m14:25:56.477104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1ae37d3-a4db-42c8-ae37-11d66ae7f71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156e2250>]}
[0m14:25:56.477340 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m14:25:56.477489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1ae37d3-a4db-42c8-ae37-11d66ae7f71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115916910>]}
[0m14:25:56.478351 [info ] [MainThread]: 
[0m14:25:56.478590 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:25:56.480140 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m14:25:56.480329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:56.873046 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m14:25:56.874014 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:25:57.338492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1ae37d3-a4db-42c8-ae37-11d66ae7f71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c74450>]}
[0m14:25:57.339370 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:25:57.339734 [info ] [MainThread]: 
[0m14:25:57.343016 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__content
[0m14:25:57.343828 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__content ............. [RUN]
[0m14:25:57.344552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.stg_kaggle__content)
[0m14:25:57.344900 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__content
[0m14:25:57.351903 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__content"
[0m14:25:57.353107 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__content
[0m14:25:57.375146 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__content"
[0m14:25:57.375638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:57.376686 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__content.sql
WITH raw_content AS 
(
SELECT 
    id as id_content, 
    title as cat_content_title, 
    description as cat_content_description, 
    kind as cat_content_kind,
    text as cat_content_text,
    copyright_holder as cat_content_copyright_holder,
    license as id_content_license 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_content`
) 

SELECT 
    * 
FROM raw_content;


[0m14:25:58.112179 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:17e8c98b-a8ec-493a-8a7f-57b8bb25c6d9&page=queryresults
[0m14:25:58.744005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1ae37d3-a4db-42c8-ae37-11d66ae7f71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115bde750>]}
[0m14:25:58.744751 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__content ........ [[32mCREATE VIEW (0 processed)[0m in 1.40s]
[0m14:25:58.745254 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__content
[0m14:25:58.745605 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__correl
[0m14:25:58.746076 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__correl .............. [RUN]
[0m14:25:58.746513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__content, now model.curriculum_rec.stg_kaggle__correl)
[0m14:25:58.746802 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__correl
[0m14:25:58.749214 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__correl"
[0m14:25:58.750902 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__correl
[0m14:25:58.752795 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__correl"
[0m14:25:58.753258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:58.754529 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__correl: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__correl"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__correl.sql
WITH raw_correl AS 
(
    SELECT 
    topic_id as id_topic, 
    -- probably can do some sort of transformation here it should be a list not a string --  
    -- sql doesn't natively use lists though -- 
    -- have to make the table better don't use lists -- 
    content_id as id_content 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_correlation`
)

SELECT 
    * 
FROM raw_correl;


[0m14:25:59.475594 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:03ad45bf-0835-488d-b077-7a6f3ad330fd&page=queryresults
[0m14:25:59.814814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1ae37d3-a4db-42c8-ae37-11d66ae7f71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d49090>]}
[0m14:25:59.815808 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__correl ......... [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m14:25:59.816323 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__correl
[0m14:25:59.816685 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__topic
[0m14:25:59.817129 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__topic ............... [RUN]
[0m14:25:59.817599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__correl, now model.curriculum_rec.stg_kaggle__topic)
[0m14:25:59.817921 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__topic
[0m14:25:59.820929 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__topic"
[0m14:25:59.821654 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__topic
[0m14:25:59.823697 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__topic"
[0m14:25:59.824179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:59.825423 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__topic: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__topic"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__topics.sql
WITH raw_topics AS 
(
SELECT  
    id as id_topic, 
    title as cat_topic_title, 
    description as cat_topic_description, 
    channel as id_topic_description, 
    -- already encoded don't need to use case when -- 
    category as cat_topic_category, 
    level as val_topic_level, 
    parent as id_topic_parent, 
    has_content as ind_topic_has_content
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_topic`
) 

SELECT 
    *
FROM raw_topics;


[0m14:26:00.498494 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:e842493e-e886-4817-a9fc-9f68d18f8c19&page=queryresults
[0m14:26:00.869573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1ae37d3-a4db-42c8-ae37-11d66ae7f71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b3ba50>]}
[0m14:26:00.870855 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__topic .......... [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m14:26:00.871580 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__topic
[0m14:26:00.872914 [debug] [Thread-1 (]: Began running node model.curriculum_rec.content
[0m14:26:00.873848 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_curriculum_rec.content ......................... [RUN]
[0m14:26:00.874504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__topic, now model.curriculum_rec.content)
[0m14:26:00.874901 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.content
[0m14:26:00.887172 [debug] [Thread-1 (]: Compilation Error in model content (models/marts/education/content.sql)
  'correlation' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:26:00.887561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1ae37d3-a4db-42c8-ae37-11d66ae7f71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115e0eed0>]}
[0m14:26:00.888059 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model dbt_curriculum_rec.content ................ [[31mERROR[0m in 0.01s]
[0m14:26:00.888473 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.content
[0m14:26:00.888770 [debug] [Thread-1 (]: Began running node model.curriculum_rec.placeholder
[0m14:26:00.889655 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt_curriculum_rec.placeholder ..................... [RUN]
[0m14:26:00.890009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.content, now model.curriculum_rec.placeholder)
[0m14:26:00.890273 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.placeholder
[0m14:26:00.892769 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.placeholder"
[0m14:26:00.893398 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.placeholder
[0m14:26:00.897398 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.placeholder"
[0m14:26:00.897946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:00.899156 [debug] [Thread-1 (]: On model.curriculum_rec.placeholder: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.placeholder"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`placeholder`
  OPTIONS()
  as -- with 
-- correlation as (
--     SELECT * FROM  `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
-- )

-- content as (
--     SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
-- )

-- topic as (
--     SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
-- );


[0m14:26:01.208561 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:d4bb6ff6-e77d-430b-b7f9-c750aeb4715d&page=queryresults
[0m14:26:01.209750 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected end of script at [18:1]; reason: invalidQuery, location: query, message: Syntax error: Unexpected end of script at [18:1]')
[0m14:26:02.615413 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:9d1a1e71-51bd-4567-9742-7e2dedc8312d&page=queryresults
[0m14:26:02.617391 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:9d1a1e71-51bd-4567-9742-7e2dedc8312d&page=queryresults
[0m14:26:02.628650 [debug] [Thread-1 (]: Database Error in model placeholder (models/intermediate/education/placeholder.sql)
  Syntax error: Unexpected end of script at [18:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/placeholder.sql
[0m14:26:02.629282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1ae37d3-a4db-42c8-ae37-11d66ae7f71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117c338d0>]}
[0m14:26:02.629947 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model dbt_curriculum_rec.placeholder ............ [[31mERROR[0m in 1.74s]
[0m14:26:02.630469 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.placeholder
[0m14:26:02.631666 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:26:02.631978 [debug] [MainThread]: Connection 'model.curriculum_rec.placeholder' was properly closed.
[0m14:26:02.632322 [info ] [MainThread]: 
[0m14:26:02.632612 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 6.15 seconds (6.15s).
[0m14:26:02.633549 [debug] [MainThread]: Command end result
[0m14:26:02.659860 [info ] [MainThread]: 
[0m14:26:02.660096 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:26:02.660254 [info ] [MainThread]: 
[0m14:26:02.660445 [error] [MainThread]:   Compilation Error in model content (models/marts/education/content.sql)
  'correlation' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:26:02.660596 [info ] [MainThread]: 
[0m14:26:02.660773 [error] [MainThread]:   Database Error in model placeholder (models/intermediate/education/placeholder.sql)
  Syntax error: Unexpected end of script at [18:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/placeholder.sql
[0m14:26:02.660923 [info ] [MainThread]: 
[0m14:26:02.661081 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m14:26:02.662771 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.035713, "process_user_time": 1.477238, "process_kernel_time": 0.239921, "process_mem_max_rss": "212189184", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:26:02.663051 [debug] [MainThread]: Command `dbt run` failed at 14:26:02.663005 after 7.04 seconds
[0m14:26:02.663243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fa7e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fa5f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd89d0>]}
[0m14:26:02.663425 [debug] [MainThread]: Flushing usage events
[0m14:27:05.613241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d3b450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dbcd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dbd390>]}


============================== 14:27:05.614958 | 733fbf0b-47b1-4fe1-9047-8823c3c596d8 ==============================
[0m14:27:05.614958 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:27:05.615253 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'profiles_dir': '/Users/CalvinLii/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:27:05.918899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '733fbf0b-47b1-4fe1-9047-8823c3c596d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069dc350>]}
[0m14:27:05.937969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '733fbf0b-47b1-4fe1-9047-8823c3c596d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105320d50>]}
[0m14:27:05.938207 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:27:05.948973 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:27:06.035167 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:27:06.035478 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/marts/education/content.sql
[0m14:27:06.123548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '733fbf0b-47b1-4fe1-9047-8823c3c596d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c54a790>]}
[0m14:27:06.163174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '733fbf0b-47b1-4fe1-9047-8823c3c596d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c92dc50>]}
[0m14:27:06.163396 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m14:27:06.163583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '733fbf0b-47b1-4fe1-9047-8823c3c596d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c746b90>]}
[0m14:27:06.164459 [info ] [MainThread]: 
[0m14:27:06.164693 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:27:06.166253 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m14:27:06.166426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:06.502683 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m14:27:06.503530 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:27:06.882234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '733fbf0b-47b1-4fe1-9047-8823c3c596d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c74e290>]}
[0m14:27:06.883376 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:27:06.883877 [info ] [MainThread]: 
[0m14:27:06.887477 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__content
[0m14:27:06.888240 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__content ............. [RUN]
[0m14:27:06.888756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.stg_kaggle__content)
[0m14:27:06.889088 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__content
[0m14:27:06.897015 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__content"
[0m14:27:06.897906 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__content
[0m14:27:06.919911 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__content"
[0m14:27:06.920565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:06.921936 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__content.sql
WITH raw_content AS 
(
SELECT 
    id as id_content, 
    title as cat_content_title, 
    description as cat_content_description, 
    kind as cat_content_kind,
    text as cat_content_text,
    copyright_holder as cat_content_copyright_holder,
    license as id_content_license 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_content`
) 

SELECT 
    * 
FROM raw_content;


[0m14:27:07.571873 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:2ebff26d-cc89-4376-8f52-c0cd68ae44da&page=queryresults
[0m14:27:08.104327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '733fbf0b-47b1-4fe1-9047-8823c3c596d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca27f50>]}
[0m14:27:08.105079 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__content ........ [[32mCREATE VIEW (0 processed)[0m in 1.21s]
[0m14:27:08.105587 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__content
[0m14:27:08.105941 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__correl
[0m14:27:08.106404 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__correl .............. [RUN]
[0m14:27:08.106826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__content, now model.curriculum_rec.stg_kaggle__correl)
[0m14:27:08.107127 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__correl
[0m14:27:08.109520 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__correl"
[0m14:27:08.110197 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__correl
[0m14:27:08.112044 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__correl"
[0m14:27:08.112517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:08.113710 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__correl: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__correl"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__correl.sql
WITH raw_correl AS 
(
    SELECT 
    topic_id as id_topic, 
    -- probably can do some sort of transformation here it should be a list not a string --  
    -- sql doesn't natively use lists though -- 
    -- have to make the table better don't use lists -- 
    content_id as id_content 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_correlation`
)

SELECT 
    * 
FROM raw_correl;


[0m14:27:08.634026 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:cb72fc41-57b3-4653-a7eb-5d1c881f91ca&page=queryresults
[0m14:27:09.165605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '733fbf0b-47b1-4fe1-9047-8823c3c596d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8b3b50>]}
[0m14:27:09.167013 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__correl ......... [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m14:27:09.167926 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__correl
[0m14:27:09.168313 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__topic
[0m14:27:09.168762 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__topic ............... [RUN]
[0m14:27:09.169160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__correl, now model.curriculum_rec.stg_kaggle__topic)
[0m14:27:09.169413 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__topic
[0m14:27:09.172128 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__topic"
[0m14:27:09.172832 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__topic
[0m14:27:09.174646 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__topic"
[0m14:27:09.175064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:09.176177 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__topic: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__topic"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__topics.sql
WITH raw_topics AS 
(
SELECT  
    id as id_topic, 
    title as cat_topic_title, 
    description as cat_topic_description, 
    channel as id_topic_description, 
    -- already encoded don't need to use case when -- 
    category as cat_topic_category, 
    level as val_topic_level, 
    parent as id_topic_parent, 
    has_content as ind_topic_has_content
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_topic`
) 

SELECT 
    *
FROM raw_topics;


[0m14:27:09.828039 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:445c8e40-d409-46b8-b112-5b9df0b6174f&page=queryresults
[0m14:27:10.172439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '733fbf0b-47b1-4fe1-9047-8823c3c596d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8b1750>]}
[0m14:27:10.173600 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__topic .......... [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m14:27:10.174324 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__topic
[0m14:27:10.175388 [debug] [Thread-1 (]: Began running node model.curriculum_rec.content
[0m14:27:10.175973 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_curriculum_rec.content ......................... [RUN]
[0m14:27:10.176373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__topic, now model.curriculum_rec.content)
[0m14:27:10.176689 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.content
[0m14:27:10.180995 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.content"
[0m14:27:10.183136 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.content
[0m14:27:10.185451 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.content"
[0m14:27:10.186138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:10.187641 [debug] [Thread-1 (]: On model.curriculum_rec.content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`content`
  OPTIONS()
  as WITH content AS (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
)

correlation as (
    SELECT * FROM  `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
)

topic as (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
)

-- combined_content AS ( 
--     SELECT content.*, correlation.id_topic FROM content 
--     LEFT OUTER JOIN correlation ON content.id_content = correlation.id_content
-- )

-- SELECT * FROM combined_content

hierarchy AS (
    SELECT correlation.id_topic, 
WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = 'correlation.id_topic'

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
SELECT * FROM hierarchy;
 as hierarchy_data
    FROM correlation
),

json_hierarchy AS (
    SELECT id_topic, JSON_AGG(hierarchy_data) as topic_hierarchy
    FROM hierarchy
    GROUP BY id_topic
),

combined_content AS ( 
    SELECT content.*, json_hierarchy.topic_hierarchy
    FROM content 
    LEFT JOIN correlation ON content.id_content = correlation.id_content
    LEFT JOIN json_hierarchy ON correlation.id_topic = json_hierarchy.id_topic
)

SELECT * FROM combined_content;




-- distinct_content AS ( 
--     SELECT DISTINCT id_content 
--     FROM content 
-- )

-- SELECT * FROM distinct_content;


[0m14:27:10.556470 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:744c3445-b4b5-4b30-b705-33afbf013823&page=queryresults
[0m14:27:10.558396 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected identifier "correlation" at [10:1]; reason: invalidQuery, location: query, message: Syntax error: Unexpected identifier "correlation" at [10:1]')
[0m14:27:10.894196 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:89b4954a-7727-4c35-9ec0-20b7bfdb7427&page=queryresults
[0m14:27:10.896171 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:89b4954a-7727-4c35-9ec0-20b7bfdb7427&page=queryresults
[0m14:27:10.904029 [debug] [Thread-1 (]: Database Error in model content (models/marts/education/content.sql)
  Syntax error: Unexpected identifier "correlation" at [10:1]
  compiled Code at target/run/curriculum_rec/models/marts/education/content.sql
[0m14:27:10.904738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '733fbf0b-47b1-4fe1-9047-8823c3c596d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cab6e50>]}
[0m14:27:10.905455 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model dbt_curriculum_rec.content ................ [[31mERROR[0m in 0.73s]
[0m14:27:10.906016 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.content
[0m14:27:10.906399 [debug] [Thread-1 (]: Began running node model.curriculum_rec.placeholder
[0m14:27:10.907571 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt_curriculum_rec.placeholder ..................... [RUN]
[0m14:27:10.908101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.content, now model.curriculum_rec.placeholder)
[0m14:27:10.908451 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.placeholder
[0m14:27:10.912157 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.placeholder"
[0m14:27:10.912905 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.placeholder
[0m14:27:10.915223 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.placeholder"
[0m14:27:10.915775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:10.917167 [debug] [Thread-1 (]: On model.curriculum_rec.placeholder: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.placeholder"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`placeholder`
  OPTIONS()
  as -- with 
-- correlation as (
--     SELECT * FROM  `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
-- )

-- content as (
--     SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
-- )

-- topic as (
--     SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
-- );


[0m14:27:11.248620 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:37476563-6324-4f10-835f-113f2c6aabce&page=queryresults
[0m14:27:11.250265 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected end of script at [18:1]; reason: invalidQuery, location: query, message: Syntax error: Unexpected end of script at [18:1]')
[0m14:27:11.570889 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:91edafa2-2156-4a06-a609-6a1b8fd3c9d3&page=queryresults
[0m14:27:11.572365 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:91edafa2-2156-4a06-a609-6a1b8fd3c9d3&page=queryresults
[0m14:27:11.576693 [debug] [Thread-1 (]: Database Error in model placeholder (models/intermediate/education/placeholder.sql)
  Syntax error: Unexpected end of script at [18:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/placeholder.sql
[0m14:27:11.577329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '733fbf0b-47b1-4fe1-9047-8823c3c596d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca66e10>]}
[0m14:27:11.577998 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model dbt_curriculum_rec.placeholder ............ [[31mERROR[0m in 0.67s]
[0m14:27:11.578521 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.placeholder
[0m14:27:11.579723 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:11.579985 [debug] [MainThread]: Connection 'model.curriculum_rec.placeholder' was properly closed.
[0m14:27:11.580311 [info ] [MainThread]: 
[0m14:27:11.580591 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.42 seconds (5.42s).
[0m14:27:11.581556 [debug] [MainThread]: Command end result
[0m14:27:11.607133 [info ] [MainThread]: 
[0m14:27:11.607368 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:27:11.607528 [info ] [MainThread]: 
[0m14:27:11.607719 [error] [MainThread]:   Database Error in model content (models/marts/education/content.sql)
  Syntax error: Unexpected identifier "correlation" at [10:1]
  compiled Code at target/run/curriculum_rec/models/marts/education/content.sql
[0m14:27:11.607876 [info ] [MainThread]: 
[0m14:27:11.608053 [error] [MainThread]:   Database Error in model placeholder (models/intermediate/education/placeholder.sql)
  Syntax error: Unexpected end of script at [18:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/placeholder.sql
[0m14:27:11.608204 [info ] [MainThread]: 
[0m14:27:11.608363 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m14:27:11.609827 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.0212, "process_user_time": 1.541119, "process_kernel_time": 0.184911, "process_mem_max_rss": "211550208", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:27:11.610299 [debug] [MainThread]: Command `dbt run` failed at 14:27:11.610231 after 6.02 seconds
[0m14:27:11.610530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dd2610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dbd050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068cfe10>]}
[0m14:27:11.610746 [debug] [MainThread]: Flushing usage events
[0m14:30:46.600408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10919a890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10921ced0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10921d510>]}


============================== 14:30:46.603004 | f424df0c-4405-4000-a6ff-c3e67150c275 ==============================
[0m14:30:46.603004 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:30:46.603279 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:30:47.136095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f424df0c-4405-4000-a6ff-c3e67150c275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e977810>]}
[0m14:30:47.158392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f424df0c-4405-4000-a6ff-c3e67150c275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107780e50>]}
[0m14:30:47.158717 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:30:47.173007 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:30:47.286514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:30:47.286910 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://macros/generate_topic_hierarchy.sql
[0m14:30:47.287061 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/marts/education/content.sql
[0m14:30:47.350681 [error] [MainThread]: Encountered an error:
Compilation Error in model content (models/marts/education/content.sql)
  expected token ',', got 'stg_kaggle__correl'
    line 30
      {% for id in execute('SELECT DISTINCT id_topic FROM {{ ref('stg_kaggle__correl') }}') %}
[0m14:30:47.352550 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7780913, "process_user_time": 0.952822, "process_kernel_time": 0.201174, "process_mem_max_rss": "205078528", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:30:47.352944 [debug] [MainThread]: Command `dbt run` failed at 14:30:47.352886 after 0.78 seconds
[0m14:30:47.353136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091f47d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108db48d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed26710>]}
[0m14:30:47.353293 [debug] [MainThread]: Flushing usage events
[0m14:32:11.807958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d39990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d3a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dbd810>]}


============================== 14:32:11.809632 | 8b787469-9a51-4455-8357-7af97656e430 ==============================
[0m14:32:11.809632 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:32:11.809897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'profiles_dir': '/Users/CalvinLii/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:32:12.114950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b787469-9a51-4455-8357-7af97656e430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c14e890>]}
[0m14:32:12.134077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b787469-9a51-4455-8357-7af97656e430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105324b50>]}
[0m14:32:12.134327 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:32:12.145267 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:32:12.231150 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:32:12.231469 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://macros/generate_topic_hierarchy.sql
[0m14:32:12.231618 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/marts/education/content.sql
[0m14:32:12.288780 [error] [MainThread]: Encountered an error:
Compilation Error in model content (models/marts/education/content.sql)
  expected token ',', got 'stg_kaggle__correl'
    line 30
      {% for id in execute('SELECT DISTINCT id_topic FROM {{ ref('stg_kaggle__correl') }}') %}
[0m14:32:12.289772 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.50587445, "process_user_time": 0.907542, "process_kernel_time": 0.141753, "process_mem_max_rss": "204603392", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:32:12.290011 [debug] [MainThread]: Command `dbt run` failed at 14:32:12.289970 after 0.51 seconds
[0m14:32:12.290176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dbf090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8fb5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8daf10>]}
[0m14:32:12.290333 [debug] [MainThread]: Flushing usage events
[0m14:38:02.751168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110855510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108d8a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108d9050>]}


============================== 14:38:02.753438 | 88885f4b-f932-46d8-a9af-67c7b289e470 ==============================
[0m14:38:02.753438 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:38:02.753721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'debug': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:38:03.261687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88885f4b-f932-46d8-a9af-67c7b289e470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11785d9d0>]}
[0m14:38:03.281120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88885f4b-f932-46d8-a9af-67c7b289e470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e78fd0>]}
[0m14:38:03.281356 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:38:03.293021 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:38:03.392964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:38:03.393283 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/marts/education/content.sql
[0m14:38:03.393458 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://macros/generate_topic_hierarchy.sql
[0m14:38:03.451696 [error] [MainThread]: Encountered an error:
Compilation Error in model content (models/marts/education/content.sql)
  expected token ',', got 'stg_kaggle__correl'
    line 33
      --     {% for id in execute('SELECT DISTINCT id_topic FROM {{ ref('stg_kaggle__correl') }}') %}
[0m14:38:03.453156 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.72758263, "process_user_time": 0.917451, "process_kernel_time": 0.186843, "process_mem_max_rss": "200720384", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:38:03.453387 [debug] [MainThread]: Command `dbt run` failed at 14:38:03.453349 after 0.73 seconds
[0m14:38:03.453543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108daf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101ac8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117de3d10>]}
[0m14:38:03.453694 [debug] [MainThread]: Flushing usage events
[0m14:38:23.074681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba577d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bad8b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bad9150>]}


============================== 14:38:23.076410 | d781ac44-a71e-4613-b512-e8b291c1d599 ==============================
[0m14:38:23.076410 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:38:23.076692 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:38:23.383215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd781ac44-a71e-4613-b512-e8b291c1d599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1189a0210>]}
[0m14:38:23.402385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd781ac44-a71e-4613-b512-e8b291c1d599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f71350>]}
[0m14:38:23.402624 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:38:23.413350 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:38:23.498744 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:38:23.499063 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://macros/generate_topic_hierarchy.sql
[0m14:38:23.499210 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/marts/education/content.sql
[0m14:38:23.588080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd781ac44-a71e-4613-b512-e8b291c1d599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ae96250>]}
[0m14:38:23.632013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd781ac44-a71e-4613-b512-e8b291c1d599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ab63b10>]}
[0m14:38:23.632227 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m14:38:23.632379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd781ac44-a71e-4613-b512-e8b291c1d599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11acff010>]}
[0m14:38:23.633183 [info ] [MainThread]: 
[0m14:38:23.633397 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:38:23.634976 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m14:38:23.635147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:23.985804 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m14:38:23.986533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:38:24.345973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd781ac44-a71e-4613-b512-e8b291c1d599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11abd0710>]}
[0m14:38:24.347052 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:38:24.347528 [info ] [MainThread]: 
[0m14:38:24.352045 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__content
[0m14:38:24.352897 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__content ............. [RUN]
[0m14:38:24.353481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.stg_kaggle__content)
[0m14:38:24.353881 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__content
[0m14:38:24.363095 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__content"
[0m14:38:24.363838 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__content
[0m14:38:24.384380 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__content"
[0m14:38:24.384881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:38:24.385963 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__content.sql
WITH raw_content AS 
(
SELECT 
    id as id_content, 
    title as cat_content_title, 
    description as cat_content_description, 
    kind as cat_content_kind,
    text as cat_content_text,
    copyright_holder as cat_content_copyright_holder,
    license as id_content_license 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_content`
) 

SELECT 
    * 
FROM raw_content;


[0m14:38:24.953905 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:59d48ec9-bb61-48bf-b5d7-6f9a52e5932b&page=queryresults
[0m14:38:25.341515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd781ac44-a71e-4613-b512-e8b291c1d599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b036b90>]}
[0m14:38:25.342226 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__content ........ [[32mCREATE VIEW (0 processed)[0m in 0.99s]
[0m14:38:25.342726 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__content
[0m14:38:25.343068 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__correl
[0m14:38:25.343557 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__correl .............. [RUN]
[0m14:38:25.343961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__content, now model.curriculum_rec.stg_kaggle__correl)
[0m14:38:25.344242 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__correl
[0m14:38:25.346852 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__correl"
[0m14:38:25.347541 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__correl
[0m14:38:25.349487 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__correl"
[0m14:38:25.349944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:38:25.351153 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__correl: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__correl"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__correl.sql
WITH raw_correl AS 
(
    SELECT 
    topic_id as id_topic, 
    -- probably can do some sort of transformation here it should be a list not a string --  
    -- sql doesn't natively use lists though -- 
    -- have to make the table better don't use lists -- 
    content_id as id_content 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_correlation`
)

SELECT 
    * 
FROM raw_correl;


[0m14:38:26.082393 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:7dde5dac-74c4-4726-9982-51a1ae75e35d&page=queryresults
[0m14:38:26.494654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd781ac44-a71e-4613-b512-e8b291c1d599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ae4db90>]}
[0m14:38:26.495790 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__correl ......... [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m14:38:26.496465 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__correl
[0m14:38:26.496961 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__topic
[0m14:38:26.497646 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__topic ............... [RUN]
[0m14:38:26.498233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__correl, now model.curriculum_rec.stg_kaggle__topic)
[0m14:38:26.498567 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__topic
[0m14:38:26.501908 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__topic"
[0m14:38:26.502703 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__topic
[0m14:38:26.505003 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__topic"
[0m14:38:26.505502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:38:26.506878 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__topic: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__topic"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__topics.sql
WITH raw_topics AS 
(
SELECT  
    id as id_topic, 
    title as cat_topic_title, 
    description as cat_topic_description, 
    channel as id_topic_description, 
    -- already encoded don't need to use case when -- 
    category as cat_topic_category, 
    level as val_topic_level, 
    parent as id_topic_parent, 
    has_content as ind_topic_has_content
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_topic`
) 

SELECT 
    *
FROM raw_topics;


[0m14:38:27.104205 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:c3618894-70e5-4749-b0ce-7828ed55ee9d&page=queryresults
[0m14:38:27.583916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd781ac44-a71e-4613-b512-e8b291c1d599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a5130d0>]}
[0m14:38:27.585166 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__topic .......... [[32mCREATE VIEW (0 processed)[0m in 1.09s]
[0m14:38:27.585968 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__topic
[0m14:38:27.587036 [debug] [Thread-1 (]: Began running node model.curriculum_rec.content
[0m14:38:27.587446 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_curriculum_rec.content ......................... [RUN]
[0m14:38:27.587866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__topic, now model.curriculum_rec.content)
[0m14:38:27.588170 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.content
[0m14:38:27.592112 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.content"
[0m14:38:27.592920 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.content
[0m14:38:27.597395 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.content"
[0m14:38:27.597934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:38:27.599313 [debug] [Thread-1 (]: On model.curriculum_rec.content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`content`
  OPTIONS()
  as WITH 
content AS (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
),

correlation AS (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
),

topic AS (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
),

combined_content AS ( 
    SELECT content.*, correlation.id_topic FROM content 
    LEFT OUTER JOIN correlation ON content.id_content = correlation.id_content
)

topic_hierarchy AS (
    SELECT id_topic, JSON_AGG(
WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = ''

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
SELECT * FROM hierarchy;
) as hierarchy_data
    FROM combined_content
)

SELECT * FROM topic_hierarchy;


[0m14:38:27.962292 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:997737c6-9a4d-4280-8d63-b581f14c23cf&page=queryresults
[0m14:38:27.963942 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected identifier "topic_hierarchy" at [24:1]; reason: invalidQuery, location: query, message: Syntax error: Unexpected identifier "topic_hierarchy" at [24:1]')
[0m14:38:29.167316 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:03c4a401-cc3d-4c8f-ac39-f7fe4428ab11&page=queryresults
[0m14:38:29.168432 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:03c4a401-cc3d-4c8f-ac39-f7fe4428ab11&page=queryresults
[0m14:38:29.181566 [debug] [Thread-1 (]: Database Error in model content (models/marts/education/content.sql)
  Syntax error: Unexpected identifier "topic_hierarchy" at [24:1]
  compiled Code at target/run/curriculum_rec/models/marts/education/content.sql
[0m14:38:29.182308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd781ac44-a71e-4613-b512-e8b291c1d599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b0afc50>]}
[0m14:38:29.183077 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model dbt_curriculum_rec.content ................ [[31mERROR[0m in 1.59s]
[0m14:38:29.183710 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.content
[0m14:38:29.184125 [debug] [Thread-1 (]: Began running node model.curriculum_rec.placeholder
[0m14:38:29.185285 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt_curriculum_rec.placeholder ..................... [RUN]
[0m14:38:29.185782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.content, now model.curriculum_rec.placeholder)
[0m14:38:29.186117 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.placeholder
[0m14:38:29.189712 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.placeholder"
[0m14:38:29.190419 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.placeholder
[0m14:38:29.192520 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.placeholder"
[0m14:38:29.193009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:38:29.194487 [debug] [Thread-1 (]: On model.curriculum_rec.placeholder: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.placeholder"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`placeholder`
  OPTIONS()
  as -- with 
-- correlation as (
--     SELECT * FROM  `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
-- )

-- content as (
--     SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
-- )

-- topic as (
--     SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
-- );


[0m14:38:29.522063 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:2b5afa32-d3b7-45d4-96ed-fa5ab8f72dfd&page=queryresults
[0m14:38:29.523598 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected end of script at [18:1]; reason: invalidQuery, location: query, message: Syntax error: Unexpected end of script at [18:1]')
[0m14:38:30.043965 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:3e700b84-bf1e-4804-b18b-892d670123d8&page=queryresults
[0m14:38:30.045694 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:3e700b84-bf1e-4804-b18b-892d670123d8&page=queryresults
[0m14:38:30.052729 [debug] [Thread-1 (]: Database Error in model placeholder (models/intermediate/education/placeholder.sql)
  Syntax error: Unexpected end of script at [18:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/placeholder.sql
[0m14:38:30.053369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd781ac44-a71e-4613-b512-e8b291c1d599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b088110>]}
[0m14:38:30.053924 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model dbt_curriculum_rec.placeholder ............ [[31mERROR[0m in 0.87s]
[0m14:38:30.054327 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.placeholder
[0m14:38:30.055395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:38:30.055653 [debug] [MainThread]: Connection 'model.curriculum_rec.placeholder' was properly closed.
[0m14:38:30.055936 [info ] [MainThread]: 
[0m14:38:30.056157 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 6.42 seconds (6.42s).
[0m14:38:30.056927 [debug] [MainThread]: Command end result
[0m14:38:30.079213 [info ] [MainThread]: 
[0m14:38:30.079430 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:38:30.079579 [info ] [MainThread]: 
[0m14:38:30.079762 [error] [MainThread]:   Database Error in model content (models/marts/education/content.sql)
  Syntax error: Unexpected identifier "topic_hierarchy" at [24:1]
  compiled Code at target/run/curriculum_rec/models/marts/education/content.sql
[0m14:38:30.079907 [info ] [MainThread]: 
[0m14:38:30.080072 [error] [MainThread]:   Database Error in model placeholder (models/intermediate/education/placeholder.sql)
  Syntax error: Unexpected end of script at [18:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/placeholder.sql
[0m14:38:30.080218 [info ] [MainThread]: 
[0m14:38:30.080365 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m14:38:30.081439 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.0315824, "process_user_time": 1.548815, "process_kernel_time": 0.196831, "process_mem_max_rss": "211779584", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:38:30.081693 [debug] [MainThread]: Command `dbt run` failed at 14:38:30.081654 after 7.03 seconds
[0m14:38:30.081867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bad8d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba87d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050ad510>]}
[0m14:38:30.082028 [debug] [MainThread]: Flushing usage events
[0m14:40:03.614833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105196890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051ebe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105219950>]}


============================== 14:40:03.616490 | 89333bd4-8c13-4433-9150-6fc435deb829 ==============================
[0m14:40:03.616490 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:40:03.616764 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:40:03.942597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89333bd4-8c13-4433-9150-6fc435deb829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092b1290>]}
[0m14:40:03.961682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89333bd4-8c13-4433-9150-6fc435deb829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10377cf50>]}
[0m14:40:03.961928 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:40:03.972834 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:40:04.061640 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:40:04.061947 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/marts/education/content.sql
[0m14:40:04.151429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89333bd4-8c13-4433-9150-6fc435deb829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10391c910>]}
[0m14:40:04.191833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89333bd4-8c13-4433-9150-6fc435deb829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad82610>]}
[0m14:40:04.192050 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m14:40:04.192202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89333bd4-8c13-4433-9150-6fc435deb829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa1c310>]}
[0m14:40:04.192985 [info ] [MainThread]: 
[0m14:40:04.193206 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:40:04.194749 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m14:40:04.194919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:04.696038 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m14:40:04.697004 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:05.058923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89333bd4-8c13-4433-9150-6fc435deb829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa11190>]}
[0m14:40:05.060601 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:40:05.061268 [info ] [MainThread]: 
[0m14:40:05.065113 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__content
[0m14:40:05.066263 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__content ............. [RUN]
[0m14:40:05.066866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.stg_kaggle__content)
[0m14:40:05.067269 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__content
[0m14:40:05.075281 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__content"
[0m14:40:05.076117 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__content
[0m14:40:05.098712 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__content"
[0m14:40:05.099216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:05.100383 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__content.sql
WITH raw_content AS 
(
SELECT 
    id as id_content, 
    title as cat_content_title, 
    description as cat_content_description, 
    kind as cat_content_kind,
    text as cat_content_text,
    copyright_holder as cat_content_copyright_holder,
    license as id_content_license 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_content`
) 

SELECT 
    * 
FROM raw_content;


[0m14:40:05.820249 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:2b5de2c1-4be6-4f0a-8d6c-1665550b4df1&page=queryresults
[0m14:40:06.208830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89333bd4-8c13-4433-9150-6fc435deb829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad17a90>]}
[0m14:40:06.209586 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__content ........ [[32mCREATE VIEW (0 processed)[0m in 1.14s]
[0m14:40:06.210093 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__content
[0m14:40:06.210443 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__correl
[0m14:40:06.210928 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__correl .............. [RUN]
[0m14:40:06.211336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__content, now model.curriculum_rec.stg_kaggle__correl)
[0m14:40:06.211626 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__correl
[0m14:40:06.213921 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__correl"
[0m14:40:06.214813 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__correl
[0m14:40:06.216674 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__correl"
[0m14:40:06.217143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:06.218396 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__correl: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__correl"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__correl.sql
WITH raw_correl AS 
(
    SELECT 
    topic_id as id_topic, 
    -- probably can do some sort of transformation here it should be a list not a string --  
    -- sql doesn't natively use lists though -- 
    -- have to make the table better don't use lists -- 
    content_id as id_content 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_correlation`
)

SELECT 
    * 
FROM raw_correl;


[0m14:40:06.843918 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:9891bb47-0570-49f9-a847-e086e2fbfc95&page=queryresults
[0m14:40:07.231618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89333bd4-8c13-4433-9150-6fc435deb829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a99c450>]}
[0m14:40:07.232862 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__correl ......... [[32mCREATE VIEW (0 processed)[0m in 1.02s]
[0m14:40:07.233655 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__correl
[0m14:40:07.234175 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__topic
[0m14:40:07.234817 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__topic ............... [RUN]
[0m14:40:07.235341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__correl, now model.curriculum_rec.stg_kaggle__topic)
[0m14:40:07.236155 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__topic
[0m14:40:07.240429 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__topic"
[0m14:40:07.241336 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__topic
[0m14:40:07.243822 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__topic"
[0m14:40:07.244454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:07.245983 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__topic: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__topic"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__topics.sql
WITH raw_topics AS 
(
SELECT  
    id as id_topic, 
    title as cat_topic_title, 
    description as cat_topic_description, 
    channel as id_topic_description, 
    -- already encoded don't need to use case when -- 
    category as cat_topic_category, 
    level as val_topic_level, 
    parent as id_topic_parent, 
    has_content as ind_topic_has_content
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_topic`
) 

SELECT 
    *
FROM raw_topics;


[0m14:40:07.867863 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:f4c12f28-7110-441d-9c20-4efc05a919d1&page=queryresults
[0m14:40:09.149585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89333bd4-8c13-4433-9150-6fc435deb829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad3e7d0>]}
[0m14:40:09.151541 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__topic .......... [[32mCREATE VIEW (0 processed)[0m in 1.91s]
[0m14:40:09.153084 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__topic
[0m14:40:09.154808 [debug] [Thread-1 (]: Began running node model.curriculum_rec.content
[0m14:40:09.155531 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_curriculum_rec.content ......................... [RUN]
[0m14:40:09.156113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__topic, now model.curriculum_rec.content)
[0m14:40:09.156497 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.content
[0m14:40:09.163355 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.content"
[0m14:40:09.164504 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.content
[0m14:40:09.167344 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.content"
[0m14:40:09.167947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:09.169575 [debug] [Thread-1 (]: On model.curriculum_rec.content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`content`
  OPTIONS()
  as 

WITH 
content AS (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
),

correlation AS (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
),

combined_content AS ( 
    SELECT content.*, correlation.id_topic 
    FROM content 
    LEFT OUTER JOIN correlation ON content.id_content = correlation.id_content
),

hierarchy_data AS (
    SELECT 
        id_topic,
        (SELECT ARRAY_AGG(STRUCT(id_topic, id_topic_parent, val_topic_level, cat_topic_title))
         FROM 
WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = 'combined_content.id_topic'

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
SELECT * FROM hierarchy;
 ) as hierarchy_data
    FROM combined_content
),

json_hierarchy AS (
    SELECT 
        id_topic,
        JSON_AGG(hierarchy_data) as topic_hierarchy
    FROM hierarchy_data
    GROUP BY id_topic
)

SELECT * FROM json_hierarchy;;


[0m14:40:09.521074 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:a61003f5-ee2b-44bc-9189-ac2f1ff99717&page=queryresults
[0m14:40:09.522771 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword WITH at [28:1]; reason: invalidQuery, location: query, message: Syntax error: Unexpected keyword WITH at [28:1]')
[0m14:40:10.470438 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:5de2c36d-806b-4164-9a14-e3e43a2c682c&page=queryresults
[0m14:40:10.472384 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:5de2c36d-806b-4164-9a14-e3e43a2c682c&page=queryresults
[0m14:40:10.483406 [debug] [Thread-1 (]: Database Error in model content (models/marts/education/content.sql)
  Syntax error: Unexpected keyword WITH at [28:1]
  compiled Code at target/run/curriculum_rec/models/marts/education/content.sql
[0m14:40:10.483972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89333bd4-8c13-4433-9150-6fc435deb829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af624d0>]}
[0m14:40:10.484495 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model dbt_curriculum_rec.content ................ [[31mERROR[0m in 1.33s]
[0m14:40:10.484910 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.content
[0m14:40:10.485218 [debug] [Thread-1 (]: Began running node model.curriculum_rec.placeholder
[0m14:40:10.486095 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt_curriculum_rec.placeholder ..................... [RUN]
[0m14:40:10.486470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.content, now model.curriculum_rec.placeholder)
[0m14:40:10.486714 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.placeholder
[0m14:40:10.489478 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.placeholder"
[0m14:40:10.490032 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.placeholder
[0m14:40:10.491706 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.placeholder"
[0m14:40:10.492102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:10.493132 [debug] [Thread-1 (]: On model.curriculum_rec.placeholder: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.placeholder"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`placeholder`
  OPTIONS()
  as -- with 
-- correlation as (
--     SELECT * FROM  `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
-- )

-- content as (
--     SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
-- )

-- topic as (
--     SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
-- );


[0m14:40:10.939668 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:73d7fc74-df63-4ac5-9552-f805ad4370d3&page=queryresults
[0m14:40:10.941428 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected end of script at [18:1]; reason: invalidQuery, location: query, message: Syntax error: Unexpected end of script at [18:1]')
[0m14:40:11.499966 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:8ea1c6f4-2e07-4544-b9b7-440cd37ca157&page=queryresults
[0m14:40:11.501782 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:8ea1c6f4-2e07-4544-b9b7-440cd37ca157&page=queryresults
[0m14:40:11.506894 [debug] [Thread-1 (]: Database Error in model placeholder (models/intermediate/education/placeholder.sql)
  Syntax error: Unexpected end of script at [18:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/placeholder.sql
[0m14:40:11.507742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89333bd4-8c13-4433-9150-6fc435deb829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aeaae10>]}
[0m14:40:11.508544 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model dbt_curriculum_rec.placeholder ............ [[31mERROR[0m in 1.02s]
[0m14:40:11.509137 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.placeholder
[0m14:40:11.510481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:40:11.510831 [debug] [MainThread]: Connection 'model.curriculum_rec.placeholder' was properly closed.
[0m14:40:11.511186 [info ] [MainThread]: 
[0m14:40:11.511487 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 7.32 seconds (7.32s).
[0m14:40:11.512520 [debug] [MainThread]: Command end result
[0m14:40:11.539925 [info ] [MainThread]: 
[0m14:40:11.540247 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:40:11.540424 [info ] [MainThread]: 
[0m14:40:11.540651 [error] [MainThread]:   Database Error in model content (models/marts/education/content.sql)
  Syntax error: Unexpected keyword WITH at [28:1]
  compiled Code at target/run/curriculum_rec/models/marts/education/content.sql
[0m14:40:11.540809 [info ] [MainThread]: 
[0m14:40:11.540997 [error] [MainThread]:   Database Error in model placeholder (models/intermediate/education/placeholder.sql)
  Syntax error: Unexpected end of script at [18:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/placeholder.sql
[0m14:40:11.541146 [info ] [MainThread]: 
[0m14:40:11.541310 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m14:40:11.542539 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.952227, "process_user_time": 1.555599, "process_kernel_time": 0.19375, "process_mem_max_rss": "210223104", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:40:11.542840 [debug] [MainThread]: Command `dbt run` failed at 14:40:11.542790 after 7.95 seconds
[0m14:40:11.543060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10521b590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105219410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d31510>]}
[0m14:40:11.543278 [debug] [MainThread]: Flushing usage events
[0m14:46:03.666170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106657290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066abe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d9290>]}


============================== 14:46:03.667922 | 00aa48bf-8ad2-4220-9cad-ded77029d26a ==============================
[0m14:46:03.667922 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:46:03.668202 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:46:03.974358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00aa48bf-8ad2-4220-9cad-ded77029d26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10687f1d0>]}
[0m14:46:03.993457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00aa48bf-8ad2-4220-9cad-ded77029d26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b78d10>]}
[0m14:46:03.993692 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:46:04.004449 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:46:04.089952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:46:04.090254 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/marts/education/content.sql
[0m14:46:04.179920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00aa48bf-8ad2-4220-9cad-ded77029d26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104316950>]}
[0m14:46:04.219559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00aa48bf-8ad2-4220-9cad-ded77029d26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118fa2bd0>]}
[0m14:46:04.219771 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m14:46:04.219918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00aa48bf-8ad2-4220-9cad-ded77029d26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b64250>]}
[0m14:46:04.220707 [info ] [MainThread]: 
[0m14:46:04.220930 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:46:04.222477 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m14:46:04.222675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:46:04.604026 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m14:46:04.605001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:46:05.250949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00aa48bf-8ad2-4220-9cad-ded77029d26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118d6a710>]}
[0m14:46:05.252245 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:46:05.253272 [info ] [MainThread]: 
[0m14:46:05.257316 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__content
[0m14:46:05.258092 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__content ............. [RUN]
[0m14:46:05.258589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.stg_kaggle__content)
[0m14:46:05.258911 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__content
[0m14:46:05.266460 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__content"
[0m14:46:05.267201 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__content
[0m14:46:05.289186 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__content"
[0m14:46:05.289784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:46:05.290958 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__content.sql
WITH raw_content AS 
(
SELECT 
    id as id_content, 
    title as cat_content_title, 
    description as cat_content_description, 
    kind as cat_content_kind,
    text as cat_content_text,
    copyright_holder as cat_content_copyright_holder,
    license as id_content_license 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_content`
) 

SELECT 
    * 
FROM raw_content;


[0m14:46:05.863500 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:e059ab83-50d0-45bd-89e0-ded00ee2f010&page=queryresults
[0m14:46:06.349620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00aa48bf-8ad2-4220-9cad-ded77029d26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118df9ed0>]}
[0m14:46:06.350421 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__content ........ [[32mCREATE VIEW (0 processed)[0m in 1.09s]
[0m14:46:06.350924 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__content
[0m14:46:06.351300 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__correl
[0m14:46:06.351832 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__correl .............. [RUN]
[0m14:46:06.352233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__content, now model.curriculum_rec.stg_kaggle__correl)
[0m14:46:06.352482 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__correl
[0m14:46:06.354880 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__correl"
[0m14:46:06.355526 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__correl
[0m14:46:06.357376 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__correl"
[0m14:46:06.357813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:46:06.359005 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__correl: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__correl"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__correl.sql
WITH raw_correl AS 
(
    SELECT 
    topic_id as id_topic, 
    -- probably can do some sort of transformation here it should be a list not a string --  
    -- sql doesn't natively use lists though -- 
    -- have to make the table better don't use lists -- 
    content_id as id_content 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_correlation`
)

SELECT 
    * 
FROM raw_correl;


[0m14:46:06.990104 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:f05c7c9f-b082-46f6-868f-77e0813e3d0a&page=queryresults
[0m14:46:07.313724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00aa48bf-8ad2-4220-9cad-ded77029d26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118db4190>]}
[0m14:46:07.314960 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__correl ......... [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m14:46:07.316054 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__correl
[0m14:46:07.316784 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__topic
[0m14:46:07.317540 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__topic ............... [RUN]
[0m14:46:07.318176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__correl, now model.curriculum_rec.stg_kaggle__topic)
[0m14:46:07.318583 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__topic
[0m14:46:07.321941 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__topic"
[0m14:46:07.322753 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__topic
[0m14:46:07.325174 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__topic"
[0m14:46:07.325718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:46:07.327116 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__topic: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__topic"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__topics.sql
WITH raw_topics AS 
(
SELECT  
    id as id_topic, 
    title as cat_topic_title, 
    description as cat_topic_description, 
    channel as id_topic_description, 
    -- already encoded don't need to use case when -- 
    category as cat_topic_category, 
    level as val_topic_level, 
    parent as id_topic_parent, 
    has_content as ind_topic_has_content
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_topic`
) 

SELECT 
    *
FROM raw_topics;


[0m14:46:07.911252 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:6f969448-0a5e-45c0-a17a-358367436bd2&page=queryresults
[0m14:46:08.426451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00aa48bf-8ad2-4220-9cad-ded77029d26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a973550>]}
[0m14:46:08.427667 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__topic .......... [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m14:46:08.428727 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__topic
[0m14:46:08.430447 [debug] [Thread-1 (]: Began running node model.curriculum_rec.content
[0m14:46:08.431213 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_curriculum_rec.content ......................... [RUN]
[0m14:46:08.431775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__topic, now model.curriculum_rec.content)
[0m14:46:08.432160 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.content
[0m14:46:08.436082 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.content"
[0m14:46:08.436865 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.content
[0m14:46:08.439290 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.content"
[0m14:46:08.439772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:46:08.441177 [debug] [Thread-1 (]: On model.curriculum_rec.content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`content`
  OPTIONS()
  as WITH 
content AS (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
),

correlation AS (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
),

combined_content AS ( 
    SELECT content.*, correlation.id_topic 
    FROM content 
    LEFT OUTER JOIN correlation ON content.id_content = correlation.id_content
),

hierarchy_data AS (
    SELECT 
        id_topic,
        (SELECT ARRAY_AGG(STRUCT(id_topic, id_topic_parent, val_topic_level, cat_topic_title))
         FROM 
WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = 'combined_content.id_topic'

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
SELECT * FROM hierarchy;
 ) as hierarchy_data
    FROM combined_content
),

json_hierarchy AS (
    SELECT 
        id_topic,
        JSON_AGG(hierarchy_data) as topic_hierarchy
    FROM hierarchy_data
    GROUP BY id_topic
)

SELECT * FROM json_hierarchy;;


[0m14:46:08.902853 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:c14d9a45-e9df-4644-ae0d-09ee6697f657&page=queryresults
[0m14:46:08.904641 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword WITH at [26:1]; reason: invalidQuery, location: query, message: Syntax error: Unexpected keyword WITH at [26:1]')
[0m14:46:09.696222 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:37f83773-57b8-48d7-b206-894f3dbf1f58&page=queryresults
[0m14:46:09.697564 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:37f83773-57b8-48d7-b206-894f3dbf1f58&page=queryresults
[0m14:46:09.706276 [debug] [Thread-1 (]: Database Error in model content (models/marts/education/content.sql)
  Syntax error: Unexpected keyword WITH at [26:1]
  compiled Code at target/run/curriculum_rec/models/marts/education/content.sql
[0m14:46:09.706939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00aa48bf-8ad2-4220-9cad-ded77029d26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1199b9650>]}
[0m14:46:09.707671 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model dbt_curriculum_rec.content ................ [[31mERROR[0m in 1.28s]
[0m14:46:09.708241 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.content
[0m14:46:09.708639 [debug] [Thread-1 (]: Began running node model.curriculum_rec.placeholder
[0m14:46:09.709979 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt_curriculum_rec.placeholder ..................... [RUN]
[0m14:46:09.710504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.content, now model.curriculum_rec.placeholder)
[0m14:46:09.710897 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.placeholder
[0m14:46:09.714509 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.placeholder"
[0m14:46:09.715153 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.placeholder
[0m14:46:09.717359 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.placeholder"
[0m14:46:09.717894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:46:09.719493 [debug] [Thread-1 (]: On model.curriculum_rec.placeholder: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.placeholder"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`placeholder`
  OPTIONS()
  as -- with 
-- correlation as (
--     SELECT * FROM  `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
-- )

-- content as (
--     SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
-- )

-- topic as (
--     SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
-- );


[0m14:46:10.085765 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:6d54449e-4be1-443d-8330-e2d2925c02de&page=queryresults
[0m14:46:10.087688 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected end of script at [18:1]; reason: invalidQuery, location: query, message: Syntax error: Unexpected end of script at [18:1]')
[0m14:46:10.941085 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:4d00dbbc-ede0-4c85-9cff-99dc4fda4831&page=queryresults
[0m14:46:10.942760 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:4d00dbbc-ede0-4c85-9cff-99dc4fda4831&page=queryresults
[0m14:46:10.948240 [debug] [Thread-1 (]: Database Error in model placeholder (models/intermediate/education/placeholder.sql)
  Syntax error: Unexpected end of script at [18:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/placeholder.sql
[0m14:46:10.948987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00aa48bf-8ad2-4220-9cad-ded77029d26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119910790>]}
[0m14:46:10.949839 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model dbt_curriculum_rec.placeholder ............ [[31mERROR[0m in 1.24s]
[0m14:46:10.950453 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.placeholder
[0m14:46:10.951736 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:46:10.952067 [debug] [MainThread]: Connection 'model.curriculum_rec.placeholder' was properly closed.
[0m14:46:10.952419 [info ] [MainThread]: 
[0m14:46:10.952701 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 6.73 seconds (6.73s).
[0m14:46:10.953720 [debug] [MainThread]: Command end result
[0m14:46:10.981088 [info ] [MainThread]: 
[0m14:46:10.981351 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:46:10.981524 [info ] [MainThread]: 
[0m14:46:10.981739 [error] [MainThread]:   Database Error in model content (models/marts/education/content.sql)
  Syntax error: Unexpected keyword WITH at [26:1]
  compiled Code at target/run/curriculum_rec/models/marts/education/content.sql
[0m14:46:10.981907 [info ] [MainThread]: 
[0m14:46:10.982088 [error] [MainThread]:   Database Error in model placeholder (models/intermediate/education/placeholder.sql)
  Syntax error: Unexpected end of script at [18:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/placeholder.sql
[0m14:46:10.982246 [info ] [MainThread]: 
[0m14:46:10.982411 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m14:46:10.983628 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.3419933, "process_user_time": 1.548553, "process_kernel_time": 0.186678, "process_mem_max_rss": "210927616", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:46:10.983919 [debug] [MainThread]: Command `dbt run` failed at 14:46:10.983873 after 7.34 seconds
[0m14:46:10.984123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ee190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e39650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e39890>]}
[0m14:46:10.984309 [debug] [MainThread]: Flushing usage events
[0m14:51:28.962222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108857150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068489d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d9190>]}


============================== 14:51:28.964156 | 74b0caf4-0808-4613-b298-2abdedae4c00 ==============================
[0m14:51:28.964156 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:51:28.964439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:51:29.304147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74b0caf4-0808-4613-b298-2abdedae4c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3d9890>]}
[0m14:51:29.324546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74b0caf4-0808-4613-b298-2abdedae4c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f78e90>]}
[0m14:51:29.324862 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:51:29.336966 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:51:29.431151 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:51:29.431494 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/marts/education/content.sql
[0m14:51:29.431665 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://macros/generate_topic_hierarchy.sql
[0m14:51:29.524710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74b0caf4-0808-4613-b298-2abdedae4c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fab7290>]}
[0m14:51:29.567516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74b0caf4-0808-4613-b298-2abdedae4c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11808b590>]}
[0m14:51:29.567809 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m14:51:29.567963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74b0caf4-0808-4613-b298-2abdedae4c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118091890>]}
[0m14:51:29.568806 [info ] [MainThread]: 
[0m14:51:29.569061 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:51:29.570681 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m14:51:29.570869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:30.045007 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m14:51:30.046143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:30.407521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74b0caf4-0808-4613-b298-2abdedae4c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fad1850>]}
[0m14:51:30.408826 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:51:30.409423 [info ] [MainThread]: 
[0m14:51:30.413092 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__content
[0m14:51:30.413952 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__content ............. [RUN]
[0m14:51:30.414555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.stg_kaggle__content)
[0m14:51:30.414964 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__content
[0m14:51:30.423270 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__content"
[0m14:51:30.423999 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__content
[0m14:51:30.444796 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__content"
[0m14:51:30.445382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:30.446442 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__content.sql
WITH raw_content AS 
(
SELECT 
    id as id_content, 
    title as cat_content_title, 
    description as cat_content_description, 
    kind as cat_content_kind,
    text as cat_content_text,
    copyright_holder as cat_content_copyright_holder,
    license as id_content_license 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_content`
) 

SELECT 
    * 
FROM raw_content;


[0m14:51:31.043289 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:09a6f665-5f53-4091-a03b-8b61b61297c4&page=queryresults
[0m14:51:31.527240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74b0caf4-0808-4613-b298-2abdedae4c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118235f10>]}
[0m14:51:31.527819 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__content ........ [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m14:51:31.528279 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__content
[0m14:51:31.528612 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__correl
[0m14:51:31.529078 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__correl .............. [RUN]
[0m14:51:31.529510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__content, now model.curriculum_rec.stg_kaggle__correl)
[0m14:51:31.529804 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__correl
[0m14:51:31.532397 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__correl"
[0m14:51:31.533035 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__correl
[0m14:51:31.535119 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__correl"
[0m14:51:31.535676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:31.536891 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__correl: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__correl"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__correl.sql
WITH raw_correl AS 
(
    SELECT 
    topic_id as id_topic, 
    -- probably can do some sort of transformation here it should be a list not a string --  
    -- sql doesn't natively use lists though -- 
    -- have to make the table better don't use lists -- 
    content_id as id_content 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_correlation`
)

SELECT 
    * 
FROM raw_correl;


[0m14:51:32.026991 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:2dd5afa3-09b2-4bd1-be7e-62c7c8c660c2&page=queryresults
[0m14:51:32.499225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74b0caf4-0808-4613-b298-2abdedae4c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108872790>]}
[0m14:51:32.500602 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__correl ......... [[32mCREATE VIEW (0 processed)[0m in 0.97s]
[0m14:51:32.501445 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__correl
[0m14:51:32.502003 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__topic
[0m14:51:32.503109 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__topic ............... [RUN]
[0m14:51:32.503737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__correl, now model.curriculum_rec.stg_kaggle__topic)
[0m14:51:32.504096 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__topic
[0m14:51:32.507568 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__topic"
[0m14:51:32.508384 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__topic
[0m14:51:32.510903 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__topic"
[0m14:51:32.511777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:32.513468 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__topic: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__topic"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__topics.sql
WITH raw_topics AS 
(
SELECT  
    id as id_topic, 
    title as cat_topic_title, 
    description as cat_topic_description, 
    channel as id_topic_description, 
    -- already encoded don't need to use case when -- 
    category as cat_topic_category, 
    level as val_topic_level, 
    parent as id_topic_parent, 
    has_content as ind_topic_has_content
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_topic`
) 

SELECT 
    *
FROM raw_topics;


[0m14:51:33.008192 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:84316ef2-edaa-47ba-b98d-17d968155e3a&page=queryresults
[0m14:51:33.469625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74b0caf4-0808-4613-b298-2abdedae4c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1180efb90>]}
[0m14:51:33.470557 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__topic .......... [[32mCREATE VIEW (0 processed)[0m in 0.97s]
[0m14:51:33.471274 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__topic
[0m14:51:33.472447 [debug] [Thread-1 (]: Began running node model.curriculum_rec.content
[0m14:51:33.473020 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_curriculum_rec.content ......................... [RUN]
[0m14:51:33.473780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__topic, now model.curriculum_rec.content)
[0m14:51:33.474195 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.content
[0m14:51:33.477545 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.content"
[0m14:51:33.478165 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.content
[0m14:51:33.482434 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.content"
[0m14:51:33.483161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:33.484350 [debug] [Thread-1 (]: On model.curriculum_rec.content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`content`
  OPTIONS()
  as WITH 
content AS (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
),

correlation AS (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
),

combined_content AS ( 
    SELECT content.*, correlation.id_topic 
    FROM content 
    LEFT OUTER JOIN correlation ON content.id_content = correlation.id_content
),

hierarchy_data AS (
    SELECT 
        id_topic,
        (SELECT ARRAY_AGG(STRUCT(id_topic, id_topic_parent, val_topic_level, cat_topic_title))
         FROM 
WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = 'id_topic'

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
SELECT * FROM hierarchy;
 ) as hierarchy_data
    FROM combined_content
),

json_hierarchy AS (
    SELECT 
        id_topic,
        JSON_AGG(hierarchy_data) as topic_hierarchy
    FROM hierarchy_data
    GROUP BY id_topic
)

SELECT * FROM json_hierarchy;;


[0m14:51:33.840244 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:7ee700d5-1284-4b6e-a6a8-99241e1ef7b6&page=queryresults
[0m14:51:33.841937 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword WITH at [26:1]; reason: invalidQuery, location: query, message: Syntax error: Unexpected keyword WITH at [26:1]')
[0m14:51:34.350969 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:71e305ed-d249-4ddf-a573-b982c2be98a2&page=queryresults
[0m14:51:34.351861 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:71e305ed-d249-4ddf-a573-b982c2be98a2&page=queryresults
[0m14:51:34.358670 [debug] [Thread-1 (]: Database Error in model content (models/marts/education/content.sql)
  Syntax error: Unexpected keyword WITH at [26:1]
  compiled Code at target/run/curriculum_rec/models/marts/education/content.sql
[0m14:51:34.359436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74b0caf4-0808-4613-b298-2abdedae4c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118031ed0>]}
[0m14:51:34.360150 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model dbt_curriculum_rec.content ................ [[31mERROR[0m in 0.89s]
[0m14:51:34.360631 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.content
[0m14:51:34.360966 [debug] [Thread-1 (]: Began running node model.curriculum_rec.placeholder
[0m14:51:34.361921 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt_curriculum_rec.placeholder ..................... [RUN]
[0m14:51:34.362340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.content, now model.curriculum_rec.placeholder)
[0m14:51:34.362589 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.placeholder
[0m14:51:34.366121 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.placeholder"
[0m14:51:34.366742 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.placeholder
[0m14:51:34.368949 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.placeholder"
[0m14:51:34.369414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:34.370788 [debug] [Thread-1 (]: On model.curriculum_rec.placeholder: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.placeholder"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`placeholder`
  OPTIONS()
  as -- with 
-- correlation as (
--     SELECT * FROM  `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
-- )

-- content as (
--     SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
-- )

-- topic as (
--     SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
-- );


[0m14:51:34.689236 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:ea7a7e47-d418-4308-a596-5dab909f27e8&page=queryresults
[0m14:51:34.690841 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected end of script at [18:1]; reason: invalidQuery, location: query, message: Syntax error: Unexpected end of script at [18:1]')
[0m14:51:34.918056 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:5f8885ba-5cdf-44e4-90da-cfe4d59fefac&page=queryresults
[0m14:51:34.918935 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:5f8885ba-5cdf-44e4-90da-cfe4d59fefac&page=queryresults
[0m14:51:34.923308 [debug] [Thread-1 (]: Database Error in model placeholder (models/intermediate/education/placeholder.sql)
  Syntax error: Unexpected end of script at [18:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/placeholder.sql
[0m14:51:34.923949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74b0caf4-0808-4613-b298-2abdedae4c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118267050>]}
[0m14:51:34.924833 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model dbt_curriculum_rec.placeholder ............ [[31mERROR[0m in 0.56s]
[0m14:51:34.925610 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.placeholder
[0m14:51:34.926720 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:34.927010 [debug] [MainThread]: Connection 'model.curriculum_rec.placeholder' was properly closed.
[0m14:51:34.927309 [info ] [MainThread]: 
[0m14:51:34.927545 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.36 seconds (5.36s).
[0m14:51:34.928323 [debug] [MainThread]: Command end result
[0m14:51:34.955496 [info ] [MainThread]: 
[0m14:51:34.955867 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:51:34.956060 [info ] [MainThread]: 
[0m14:51:34.956295 [error] [MainThread]:   Database Error in model content (models/marts/education/content.sql)
  Syntax error: Unexpected keyword WITH at [26:1]
  compiled Code at target/run/curriculum_rec/models/marts/education/content.sql
[0m14:51:34.956479 [info ] [MainThread]: 
[0m14:51:34.956680 [error] [MainThread]:   Database Error in model placeholder (models/intermediate/education/placeholder.sql)
  Syntax error: Unexpected end of script at [18:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/placeholder.sql
[0m14:51:34.956852 [info ] [MainThread]: 
[0m14:51:34.957045 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m14:51:34.959036 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.022348, "process_user_time": 1.610966, "process_kernel_time": 0.206093, "process_mem_max_rss": "212533248", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:51:34.959477 [debug] [MainThread]: Command `dbt run` failed at 14:51:34.959414 after 6.02 seconds
[0m14:51:34.959745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088ea190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d8a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103254c50>]}
[0m14:51:34.959985 [debug] [MainThread]: Flushing usage events
[0m14:58:05.089428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074abad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10752ce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10752d450>]}


============================== 14:58:05.091764 | 1679e39f-6ab9-478d-9bdf-596a0801f28a ==============================
[0m14:58:05.091764 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:58:05.092053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'debug': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:58:05.611226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1679e39f-6ab9-478d-9bdf-596a0801f28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc526d0>]}
[0m14:58:05.630312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1679e39f-6ab9-478d-9bdf-596a0801f28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc28e10>]}
[0m14:58:05.630541 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:58:05.643067 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:58:05.742073 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m14:58:05.742359 [debug] [MainThread]: Partial parsing: added file: curriculum_rec://models/intermediate/education/topic_hierarchy.sql
[0m14:58:05.742489 [debug] [MainThread]: Partial parsing: deleted file: curriculum_rec://models/intermediate/education/placeholder.sql
[0m14:58:05.742642 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/marts/education/content.sql
[0m14:58:05.838330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1679e39f-6ab9-478d-9bdf-596a0801f28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce9bad0>]}
[0m14:58:05.882834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1679e39f-6ab9-478d-9bdf-596a0801f28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0e84d0>]}
[0m14:58:05.883059 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m14:58:05.883213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1679e39f-6ab9-478d-9bdf-596a0801f28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0ba510>]}
[0m14:58:05.884030 [info ] [MainThread]: 
[0m14:58:05.884258 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:58:05.885857 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m14:58:05.886029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:06.360115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m14:58:06.361106 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:06.703030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1679e39f-6ab9-478d-9bdf-596a0801f28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c60dfd0>]}
[0m14:58:06.704325 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:58:06.704916 [info ] [MainThread]: 
[0m14:58:06.709819 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__content
[0m14:58:06.710653 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__content ............. [RUN]
[0m14:58:06.711216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.stg_kaggle__content)
[0m14:58:06.711607 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__content
[0m14:58:06.720788 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__content"
[0m14:58:06.721520 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__content
[0m14:58:06.741968 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__content"
[0m14:58:06.742463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:06.743566 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__content.sql
WITH raw_content AS 
(
SELECT 
    id as id_content, 
    title as cat_content_title, 
    description as cat_content_description, 
    kind as cat_content_kind,
    text as cat_content_text,
    copyright_holder as cat_content_copyright_holder,
    license as id_content_license 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_content`
) 

SELECT 
    * 
FROM raw_content;


[0m14:58:07.410610 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:7b514ea3-eac1-407c-9d1a-5df8bb3382ac&page=queryresults
[0m14:58:07.952712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1679e39f-6ab9-478d-9bdf-596a0801f28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d102a10>]}
[0m14:58:07.953511 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__content ........ [[32mCREATE VIEW (0 processed)[0m in 1.24s]
[0m14:58:07.954016 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__content
[0m14:58:07.954390 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__correl
[0m14:58:07.954886 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__correl .............. [RUN]
[0m14:58:07.955338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__content, now model.curriculum_rec.stg_kaggle__correl)
[0m14:58:07.955627 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__correl
[0m14:58:07.957938 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__correl"
[0m14:58:07.958604 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__correl
[0m14:58:07.960438 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__correl"
[0m14:58:07.960863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:07.962052 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__correl: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__correl"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__correl.sql
WITH raw_correl AS 
(
    SELECT 
    topic_id as id_topic, 
    -- probably can do some sort of transformation here it should be a list not a string --  
    -- sql doesn't natively use lists though -- 
    -- have to make the table better don't use lists -- 
    content_id as id_content 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_correlation`
)

SELECT 
    * 
FROM raw_correl;


[0m14:58:08.714430 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:95b16f7c-1990-4929-aa94-5be9af1f7463&page=queryresults
[0m14:58:09.058196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1679e39f-6ab9-478d-9bdf-596a0801f28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd6a790>]}
[0m14:58:09.059546 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__correl ......... [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m14:58:09.060341 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__correl
[0m14:58:09.060837 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__topic
[0m14:58:09.061674 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__topic ............... [RUN]
[0m14:58:09.062558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__correl, now model.curriculum_rec.stg_kaggle__topic)
[0m14:58:09.063033 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__topic
[0m14:58:09.066868 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__topic"
[0m14:58:09.067735 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__topic
[0m14:58:09.070258 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__topic"
[0m14:58:09.070867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:09.072423 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__topic: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__topic"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__topics.sql
WITH raw_topics AS 
(
SELECT  
    id as id_topic, 
    title as cat_topic_title, 
    description as cat_topic_description, 
    channel as id_topic_description, 
    -- already encoded don't need to use case when -- 
    category as cat_topic_category, 
    level as val_topic_level, 
    parent as id_topic_parent, 
    has_content as ind_topic_has_content
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_topic`
) 

SELECT 
    *
FROM raw_topics;


[0m14:58:09.737928 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:df5ea723-5317-4926-828b-6fbf29580b19&page=queryresults
[0m14:58:10.274584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1679e39f-6ab9-478d-9bdf-596a0801f28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd1c050>]}
[0m14:58:10.275638 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__topic .......... [[32mCREATE VIEW (0 processed)[0m in 1.21s]
[0m14:58:10.276304 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__topic
[0m14:58:10.277410 [debug] [Thread-1 (]: Began running node model.curriculum_rec.topic_hierarchy
[0m14:58:10.278211 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_curriculum_rec.topic_hierarchy ................. [RUN]
[0m14:58:10.278751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__topic, now model.curriculum_rec.topic_hierarchy)
[0m14:58:10.279110 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.topic_hierarchy
[0m14:58:10.282837 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.topic_hierarchy"
[0m14:58:10.283628 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.topic_hierarchy
[0m14:58:10.288162 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.topic_hierarchy"
[0m14:58:10.288700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:10.290136 [debug] [Thread-1 (]: On model.curriculum_rec.topic_hierarchy: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.topic_hierarchy"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`topic_hierarchy`
  OPTIONS()
  as -- topic_hierarchy.sql
WITH recursive_hierarchy AS (
  SELECT
    id_topic,
    
WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = 'id_topic'

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
SELECT * FROM hierarchy;
 AS hierarchy
  FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
)

SELECT * FROM recursive_hierarchy;


[0m14:58:10.614329 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:e0c092ba-aec7-4b82-881f-714f9b25e90b&page=queryresults
[0m14:58:10.616067 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword WITH at [11:1]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got keyword WITH at [11:1]')
[0m14:58:11.684705 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:6e56a1cb-70a5-43ce-a75b-050a8f8a8bdd&page=queryresults
[0m14:58:11.686519 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:6e56a1cb-70a5-43ce-a75b-050a8f8a8bdd&page=queryresults
[0m14:58:11.699418 [debug] [Thread-1 (]: Database Error in model topic_hierarchy (models/intermediate/education/topic_hierarchy.sql)
  Syntax error: Expected ")" but got keyword WITH at [11:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/topic_hierarchy.sql
[0m14:58:11.700009 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1679e39f-6ab9-478d-9bdf-596a0801f28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf94a90>]}
[0m14:58:11.700683 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model dbt_curriculum_rec.topic_hierarchy ........ [[31mERROR[0m in 1.42s]
[0m14:58:11.701236 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.topic_hierarchy
[0m14:58:11.702466 [debug] [Thread-1 (]: Began running node model.curriculum_rec.content
[0m14:58:11.702908 [info ] [Thread-1 (]: 5 of 5 SKIP relation dbt_curriculum_rec.content ................................ [[33mSKIP[0m]
[0m14:58:11.703225 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.content
[0m14:58:11.704100 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:58:11.704311 [debug] [MainThread]: Connection 'model.curriculum_rec.topic_hierarchy' was properly closed.
[0m14:58:11.704598 [info ] [MainThread]: 
[0m14:58:11.704836 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.82 seconds (5.82s).
[0m14:58:11.705618 [debug] [MainThread]: Command end result
[0m14:58:11.730794 [info ] [MainThread]: 
[0m14:58:11.731075 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:58:11.731238 [info ] [MainThread]: 
[0m14:58:11.731435 [error] [MainThread]:   Database Error in model topic_hierarchy (models/intermediate/education/topic_hierarchy.sql)
  Syntax error: Expected ")" but got keyword WITH at [11:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/topic_hierarchy.sql
[0m14:58:11.731604 [info ] [MainThread]: 
[0m14:58:11.731761 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m14:58:11.733607 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.670055, "process_user_time": 1.482244, "process_kernel_time": 0.233948, "process_mem_max_rss": "210337792", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:58:11.733938 [debug] [MainThread]: Command `dbt run` failed at 14:58:11.733889 after 6.67 seconds
[0m14:58:11.734162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075047d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10752d090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074b4650>]}
[0m14:58:11.734354 [debug] [MainThread]: Flushing usage events
[0m15:03:53.132347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10954a890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095ccd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095cd390>]}


============================== 15:03:53.134080 | bb22b082-7646-4ad8-8118-c9bf27339d05 ==============================
[0m15:03:53.134080 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:03:53.134349 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'debug': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:03:53.438012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb22b082-7646-4ad8-8118-c9bf27339d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9ed250>]}
[0m15:03:53.457158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb22b082-7646-4ad8-8118-c9bf27339d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b29390>]}
[0m15:03:53.457410 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:03:53.469369 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:03:53.555932 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:03:53.556279 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://macros/generate_topic_hierarchy.sql
[0m15:03:53.556423 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/marts/education/content.sql
[0m15:03:53.647979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb22b082-7646-4ad8-8118-c9bf27339d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a4c6150>]}
[0m15:03:53.687698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb22b082-7646-4ad8-8118-c9bf27339d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a3b9250>]}
[0m15:03:53.687913 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m15:03:53.688062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb22b082-7646-4ad8-8118-c9bf27339d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a3ac310>]}
[0m15:03:53.688847 [info ] [MainThread]: 
[0m15:03:53.689068 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:03:53.690613 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m15:03:53.690793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:54.069654 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m15:03:54.070688 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:03:54.436444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb22b082-7646-4ad8-8118-c9bf27339d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a5fb610>]}
[0m15:03:54.437549 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:03:54.438041 [info ] [MainThread]: 
[0m15:03:54.443175 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__content
[0m15:03:54.443929 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__content ............. [RUN]
[0m15:03:54.444451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.stg_kaggle__content)
[0m15:03:54.444777 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__content
[0m15:03:54.452316 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__content"
[0m15:03:54.453070 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__content
[0m15:03:54.474069 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__content"
[0m15:03:54.474567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:54.475649 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__content.sql
WITH raw_content AS 
(
SELECT 
    id as id_content, 
    title as cat_content_title, 
    description as cat_content_description, 
    kind as cat_content_kind,
    text as cat_content_text,
    copyright_holder as cat_content_copyright_holder,
    license as id_content_license 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_content`
) 

SELECT 
    * 
FROM raw_content;


[0m15:03:55.136969 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:0049d1eb-6219-4567-a1a3-9225bb51512d&page=queryresults
[0m15:03:55.816076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb22b082-7646-4ad8-8118-c9bf27339d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a6ede10>]}
[0m15:03:55.816820 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__content ........ [[32mCREATE VIEW (0 processed)[0m in 1.37s]
[0m15:03:55.817317 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__content
[0m15:03:55.817677 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__correl
[0m15:03:55.818145 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__correl .............. [RUN]
[0m15:03:55.818571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__content, now model.curriculum_rec.stg_kaggle__correl)
[0m15:03:55.818857 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__correl
[0m15:03:55.821409 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__correl"
[0m15:03:55.822023 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__correl
[0m15:03:55.823826 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__correl"
[0m15:03:55.824261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:55.825519 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__correl: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__correl"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__correl.sql
WITH raw_correl AS 
(
    SELECT 
    topic_id as id_topic, 
    -- probably can do some sort of transformation here it should be a list not a string --  
    -- sql doesn't natively use lists though -- 
    -- have to make the table better don't use lists -- 
    content_id as id_content 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_correlation`
)

SELECT 
    * 
FROM raw_correl;


[0m15:03:56.469024 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:481f1d9a-01dc-4510-841a-525928290684&page=queryresults
[0m15:03:56.990222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb22b082-7646-4ad8-8118-c9bf27339d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108200f10>]}
[0m15:03:56.991511 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__correl ......... [[32mCREATE VIEW (0 processed)[0m in 1.17s]
[0m15:03:56.992795 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__correl
[0m15:03:56.993379 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__topic
[0m15:03:56.994094 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__topic ............... [RUN]
[0m15:03:56.994694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__correl, now model.curriculum_rec.stg_kaggle__topic)
[0m15:03:56.995103 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__topic
[0m15:03:56.998849 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__topic"
[0m15:03:56.999654 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__topic
[0m15:03:57.002089 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__topic"
[0m15:03:57.002654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:57.004189 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__topic: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__topic"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__topics.sql
WITH raw_topics AS 
(
SELECT  
    id as id_topic, 
    title as cat_topic_title, 
    description as cat_topic_description, 
    channel as id_topic_description, 
    -- already encoded don't need to use case when -- 
    category as cat_topic_category, 
    level as val_topic_level, 
    parent as id_topic_parent, 
    has_content as ind_topic_has_content
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_topic`
) 

SELECT 
    *
FROM raw_topics;


[0m15:03:57.632923 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:928364db-6876-40df-8089-2c47b65f27d7&page=queryresults
[0m15:03:58.221426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb22b082-7646-4ad8-8118-c9bf27339d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a6eddd0>]}
[0m15:03:58.222731 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__topic .......... [[32mCREATE VIEW (0 processed)[0m in 1.23s]
[0m15:03:58.223598 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__topic
[0m15:03:58.225105 [debug] [Thread-1 (]: Began running node model.curriculum_rec.topic_hierarchy
[0m15:03:58.226000 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_curriculum_rec.topic_hierarchy ................. [RUN]
[0m15:03:58.226612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__topic, now model.curriculum_rec.topic_hierarchy)
[0m15:03:58.227018 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.topic_hierarchy
[0m15:03:58.233106 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.topic_hierarchy"
[0m15:03:58.233899 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.topic_hierarchy
[0m15:03:58.236001 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.topic_hierarchy"
[0m15:03:58.236506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:58.237903 [debug] [Thread-1 (]: On model.curriculum_rec.topic_hierarchy: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.topic_hierarchy"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`topic_hierarchy`
  OPTIONS()
  as -- topic_hierarchy.sql
WITH recursive_hierarchy AS (
  SELECT
    id_topic,
    
WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = 'id_topic'

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
-- SELECT * FROM hierarchy;
SELECT 
    ARRAY_AGG(
        STRUCT(
            id_topic,
            id_topic_parent,
            val_topic_level,
            cat_topic_title
        )
    ) AS hierarchy_json
FROM hierarchy;
 AS hierarchy
  FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
)

SELECT * FROM recursive_hierarchy;


[0m15:03:58.580639 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:8f0fb582-b1dd-4883-b9da-93d824fa15cb&page=queryresults
[0m15:03:58.582391 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword WITH at [11:1]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got keyword WITH at [11:1]')
[0m15:03:59.712297 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:3302455c-80f3-4863-8e71-6a37affc2664&page=queryresults
[0m15:03:59.714106 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:3302455c-80f3-4863-8e71-6a37affc2664&page=queryresults
[0m15:03:59.721940 [debug] [Thread-1 (]: Database Error in model topic_hierarchy (models/intermediate/education/topic_hierarchy.sql)
  Syntax error: Expected ")" but got keyword WITH at [11:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/topic_hierarchy.sql
[0m15:03:59.722731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb22b082-7646-4ad8-8118-c9bf27339d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aa20950>]}
[0m15:03:59.723534 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model dbt_curriculum_rec.topic_hierarchy ........ [[31mERROR[0m in 1.50s]
[0m15:03:59.724118 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.topic_hierarchy
[0m15:03:59.725437 [debug] [Thread-1 (]: Began running node model.curriculum_rec.content
[0m15:03:59.725927 [info ] [Thread-1 (]: 5 of 5 SKIP relation dbt_curriculum_rec.content ................................ [[33mSKIP[0m]
[0m15:03:59.726294 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.content
[0m15:03:59.727332 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:03:59.727588 [debug] [MainThread]: Connection 'model.curriculum_rec.topic_hierarchy' was properly closed.
[0m15:03:59.727917 [info ] [MainThread]: 
[0m15:03:59.728190 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 6.04 seconds (6.04s).
[0m15:03:59.729105 [debug] [MainThread]: Command end result
[0m15:03:59.755684 [info ] [MainThread]: 
[0m15:03:59.755947 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:03:59.756115 [info ] [MainThread]: 
[0m15:03:59.756312 [error] [MainThread]:   Database Error in model topic_hierarchy (models/intermediate/education/topic_hierarchy.sql)
  Syntax error: Expected ")" but got keyword WITH at [11:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/topic_hierarchy.sql
[0m15:03:59.756476 [info ] [MainThread]: 
[0m15:03:59.756639 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m15:03:59.757830 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.6502223, "process_user_time": 1.485215, "process_kernel_time": 0.187415, "process_mem_max_rss": "212566016", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:03:59.758109 [debug] [MainThread]: Command `dbt run` failed at 15:03:59.758062 after 6.65 seconds
[0m15:03:59.758305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095cd090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091648d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10785ce50>]}
[0m15:03:59.758487 [debug] [MainThread]: Flushing usage events
[0m15:07:04.099662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106356890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063abe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106398e10>]}


============================== 15:07:04.101541 | 5ef82753-4ea5-4537-b90a-847062dcb17f ==============================
[0m15:07:04.101541 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:07:04.101829 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:07:04.409281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ef82753-4ea5-4537-b90a-847062dcb17f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b457650>]}
[0m15:07:04.428441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ef82753-4ea5-4537-b90a-847062dcb17f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038ad250>]}
[0m15:07:04.428674 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:07:04.439525 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:07:04.525513 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m15:07:04.525875 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://macros/generate_topic_hierarchy.sql
[0m15:07:04.526023 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/marts/education/content.sql
[0m15:07:04.526143 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/intermediate/education/topic_hierarchy.sql
[0m15:07:04.619538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ef82753-4ea5-4537-b90a-847062dcb17f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d98c290>]}
[0m15:07:04.659905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ef82753-4ea5-4537-b90a-847062dcb17f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d765310>]}
[0m15:07:04.660118 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m15:07:04.660276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ef82753-4ea5-4537-b90a-847062dcb17f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7b2e10>]}
[0m15:07:04.661106 [info ] [MainThread]: 
[0m15:07:04.661338 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:07:04.662908 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m15:07:04.663092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:06.045238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m15:07:06.046201 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:06.418030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ef82753-4ea5-4537-b90a-847062dcb17f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dca0b50>]}
[0m15:07:06.419414 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:07:06.420009 [info ] [MainThread]: 
[0m15:07:06.425495 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__content
[0m15:07:06.426335 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__content ............. [RUN]
[0m15:07:06.427008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.stg_kaggle__content)
[0m15:07:06.427437 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__content
[0m15:07:06.435212 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__content"
[0m15:07:06.435965 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__content
[0m15:07:06.457013 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__content"
[0m15:07:06.457510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:06.458583 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__content.sql
WITH raw_content AS 
(
SELECT 
    id as id_content, 
    title as cat_content_title, 
    description as cat_content_description, 
    kind as cat_content_kind,
    text as cat_content_text,
    copyright_holder as cat_content_copyright_holder,
    license as id_content_license 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_content`
) 

SELECT 
    * 
FROM raw_content;


[0m15:07:07.257023 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:fb3aa5d2-5e44-4c39-933b-774b99718e86&page=queryresults
[0m15:07:07.996124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ef82753-4ea5-4537-b90a-847062dcb17f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9ccdd0>]}
[0m15:07:07.996888 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__content ........ [[32mCREATE VIEW (0 processed)[0m in 1.57s]
[0m15:07:07.997409 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__content
[0m15:07:07.997761 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__correl
[0m15:07:07.998221 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__correl .............. [RUN]
[0m15:07:07.998641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__content, now model.curriculum_rec.stg_kaggle__correl)
[0m15:07:07.998926 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__correl
[0m15:07:08.001398 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__correl"
[0m15:07:08.002034 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__correl
[0m15:07:08.003831 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__correl"
[0m15:07:08.004298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:08.005581 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__correl: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__correl"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__correl.sql
WITH raw_correl AS 
(
    SELECT 
    topic_id as id_topic, 
    -- probably can do some sort of transformation here it should be a list not a string --  
    -- sql doesn't natively use lists though -- 
    -- have to make the table better don't use lists -- 
    content_id as id_content 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_correlation`
)

SELECT 
    * 
FROM raw_correl;


[0m15:07:08.693810 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:5f11ac7e-3e37-4314-87af-0948049a82be&page=queryresults
[0m15:07:09.057065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ef82753-4ea5-4537-b90a-847062dcb17f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d93d710>]}
[0m15:07:09.058408 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__correl ......... [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m15:07:09.059141 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__correl
[0m15:07:09.059635 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__topic
[0m15:07:09.060254 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__topic ............... [RUN]
[0m15:07:09.061273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__correl, now model.curriculum_rec.stg_kaggle__topic)
[0m15:07:09.061806 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__topic
[0m15:07:09.065581 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__topic"
[0m15:07:09.066321 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__topic
[0m15:07:09.068717 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__topic"
[0m15:07:09.069267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:09.070787 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__topic: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__topic"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__topics.sql
WITH raw_topics AS 
(
SELECT  
    id as id_topic, 
    title as cat_topic_title, 
    description as cat_topic_description, 
    channel as id_topic_description, 
    -- already encoded don't need to use case when -- 
    category as cat_topic_category, 
    level as val_topic_level, 
    parent as id_topic_parent, 
    has_content as ind_topic_has_content
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_topic`
) 

SELECT 
    *
FROM raw_topics;


[0m15:07:09.805121 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:d6228e4b-b36a-4240-b626-3e8f364f20eb&page=queryresults
[0m15:07:10.434594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ef82753-4ea5-4537-b90a-847062dcb17f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9ebb10>]}
[0m15:07:10.435825 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__topic .......... [[32mCREATE VIEW (0 processed)[0m in 1.37s]
[0m15:07:10.437066 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__topic
[0m15:07:10.438125 [debug] [Thread-1 (]: Began running node model.curriculum_rec.topic_hierarchy
[0m15:07:10.438656 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_curriculum_rec.topic_hierarchy ................. [RUN]
[0m15:07:10.439139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__topic, now model.curriculum_rec.topic_hierarchy)
[0m15:07:10.439502 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.topic_hierarchy
[0m15:07:10.446295 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.topic_hierarchy"
[0m15:07:10.447138 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.topic_hierarchy
[0m15:07:10.449385 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.topic_hierarchy"
[0m15:07:10.449977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:10.451519 [debug] [Thread-1 (]: On model.curriculum_rec.topic_hierarchy: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.topic_hierarchy"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`topic_hierarchy`
  OPTIONS()
  as -- topic_hierarchy.sql
-- WITH recursive_hierarchy AS (
--   SELECT
--     id_topic,
--     
WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = 'id_topic'

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
-- SELECT * FROM hierarchy;
SELECT 
    id_topic,
    ARRAY_AGG(
        STRUCT(
            id_topic,
            id_topic_parent,
            val_topic_level,
            cat_topic_title
        )
    ) AS hierarchy_json
FROM hierarchy;
 AS hierarchy
--   FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
-- )

-- SELECT * FROM recursive_hierarchy

-- Test the generate_topic_hierarchy macro
WITH 
-- Execute the macro to generate hierarchical JSON for a specific topic
generated_hierarchy AS (
    SELECT * FROM 
WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = 't_0868a6d7f4fe'

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
-- SELECT * FROM hierarchy;
SELECT 
    id_topic,
    ARRAY_AGG(
        STRUCT(
            id_topic,
            id_topic_parent,
            val_topic_level,
            cat_topic_title
        )
    ) AS hierarchy_json
FROM hierarchy;

)

-- Select the result to view the generated JSON
SELECT * FROM generated_hierarchy;;


[0m15:07:10.839538 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:37b6d4c4-2999-4712-abea-e6d0bb8df805&page=queryresults
[0m15:07:10.840859 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword AS at [34:2]; reason: invalidQuery, location: query, message: Syntax error: Unexpected keyword AS at [34:2]')
[0m15:07:11.179248 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:a6d4596d-de00-43d3-b92d-8ec48bd74816&page=queryresults
[0m15:07:11.181274 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:a6d4596d-de00-43d3-b92d-8ec48bd74816&page=queryresults
[0m15:07:11.190634 [debug] [Thread-1 (]: Database Error in model topic_hierarchy (models/intermediate/education/topic_hierarchy.sql)
  Syntax error: Unexpected keyword AS at [34:2]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/topic_hierarchy.sql
[0m15:07:11.191217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ef82753-4ea5-4537-b90a-847062dcb17f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dda6990>]}
[0m15:07:11.191794 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model dbt_curriculum_rec.topic_hierarchy ........ [[31mERROR[0m in 0.75s]
[0m15:07:11.192276 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.topic_hierarchy
[0m15:07:11.193538 [debug] [Thread-1 (]: Began running node model.curriculum_rec.content
[0m15:07:11.193926 [info ] [Thread-1 (]: 5 of 5 SKIP relation dbt_curriculum_rec.content ................................ [[33mSKIP[0m]
[0m15:07:11.194256 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.content
[0m15:07:11.195139 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:11.195390 [debug] [MainThread]: Connection 'model.curriculum_rec.topic_hierarchy' was properly closed.
[0m15:07:11.195676 [info ] [MainThread]: 
[0m15:07:11.195919 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 6.53 seconds (6.53s).
[0m15:07:11.196688 [debug] [MainThread]: Command end result
[0m15:07:11.220353 [info ] [MainThread]: 
[0m15:07:11.220586 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:07:11.220751 [info ] [MainThread]: 
[0m15:07:11.220939 [error] [MainThread]:   Database Error in model topic_hierarchy (models/intermediate/education/topic_hierarchy.sql)
  Syntax error: Unexpected keyword AS at [34:2]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/topic_hierarchy.sql
[0m15:07:11.221088 [info ] [MainThread]: 
[0m15:07:11.221236 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m15:07:11.222349 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.1474376, "process_user_time": 1.494969, "process_kernel_time": 0.192987, "process_mem_max_rss": "211566592", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:07:11.222612 [debug] [MainThread]: Command `dbt run` failed at 15:07:11.222569 after 7.15 seconds
[0m15:07:11.222793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063db090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063d94d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e61410>]}
[0m15:07:11.222962 [debug] [MainThread]: Flushing usage events
[0m15:07:34.310226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f5e890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb3e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fe16d0>]}


============================== 15:07:34.312117 | 6f2fc6ab-b25c-493a-bf1e-2ce6af81f2ef ==============================
[0m15:07:34.312117 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:07:34.312392 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/CalvinLii/.dbt', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:07:34.616257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f2fc6ab-b25c-493a-bf1e-2ce6af81f2ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fec3d0>]}
[0m15:07:34.635292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f2fc6ab-b25c-493a-bf1e-2ce6af81f2ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10753d3d0>]}
[0m15:07:34.635535 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:07:34.646473 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:07:34.732451 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:07:34.732754 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/intermediate/education/topic_hierarchy.sql
[0m15:07:34.820447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f2fc6ab-b25c-493a-bf1e-2ce6af81f2ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae2b50>]}
[0m15:07:34.863365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f2fc6ab-b25c-493a-bf1e-2ce6af81f2ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb042d0>]}
[0m15:07:34.863646 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m15:07:34.863812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f2fc6ab-b25c-493a-bf1e-2ce6af81f2ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eaeab90>]}
[0m15:07:34.864675 [info ] [MainThread]: 
[0m15:07:34.864903 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:07:34.866549 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m15:07:34.866740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:35.183426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m15:07:35.184351 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:35.516715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f2fc6ab-b25c-493a-bf1e-2ce6af81f2ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7ec090>]}
[0m15:07:35.518125 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:07:35.518698 [info ] [MainThread]: 
[0m15:07:35.522861 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__content
[0m15:07:35.523688 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__content ............. [RUN]
[0m15:07:35.524302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.stg_kaggle__content)
[0m15:07:35.524715 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__content
[0m15:07:35.532767 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__content"
[0m15:07:35.533594 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__content
[0m15:07:35.555646 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__content"
[0m15:07:35.556132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:35.557202 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__content.sql
WITH raw_content AS 
(
SELECT 
    id as id_content, 
    title as cat_content_title, 
    description as cat_content_description, 
    kind as cat_content_kind,
    text as cat_content_text,
    copyright_holder as cat_content_copyright_holder,
    license as id_content_license 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_content`
) 

SELECT 
    * 
FROM raw_content;


[0m15:07:36.123945 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:181a76db-7cf4-4e80-94a3-54716bdf4d4a&page=queryresults
[0m15:07:36.612871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f2fc6ab-b25c-493a-bf1e-2ce6af81f2ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e813c90>]}
[0m15:07:36.614113 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__content ........ [[32mCREATE VIEW (0 processed)[0m in 1.09s]
[0m15:07:36.615012 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__content
[0m15:07:36.615597 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__correl
[0m15:07:36.616301 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__correl .............. [RUN]
[0m15:07:36.616886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__content, now model.curriculum_rec.stg_kaggle__correl)
[0m15:07:36.617328 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__correl
[0m15:07:36.621636 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__correl"
[0m15:07:36.622928 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__correl
[0m15:07:36.625740 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__correl"
[0m15:07:36.626515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:36.627953 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__correl: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__correl"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__correl.sql
WITH raw_correl AS 
(
    SELECT 
    topic_id as id_topic, 
    -- probably can do some sort of transformation here it should be a list not a string --  
    -- sql doesn't natively use lists though -- 
    -- have to make the table better don't use lists -- 
    content_id as id_content 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_correlation`
)

SELECT 
    * 
FROM raw_correl;


[0m15:07:37.158434 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:4c515b74-236f-41c2-bb3e-a2ea700f3259&page=queryresults
[0m15:07:37.592686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f2fc6ab-b25c-493a-bf1e-2ce6af81f2ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec4c2d0>]}
[0m15:07:37.593755 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__correl ......... [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m15:07:37.594500 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__correl
[0m15:07:37.595027 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__topic
[0m15:07:37.595696 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__topic ............... [RUN]
[0m15:07:37.596311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__correl, now model.curriculum_rec.stg_kaggle__topic)
[0m15:07:37.596785 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__topic
[0m15:07:37.603214 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__topic"
[0m15:07:37.604435 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__topic
[0m15:07:37.608006 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__topic"
[0m15:07:37.609031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:37.611358 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__topic: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__topic"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__topics.sql
WITH raw_topics AS 
(
SELECT  
    id as id_topic, 
    title as cat_topic_title, 
    description as cat_topic_description, 
    channel as id_topic_description, 
    -- already encoded don't need to use case when -- 
    category as cat_topic_category, 
    level as val_topic_level, 
    parent as id_topic_parent, 
    has_content as ind_topic_has_content
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_topic`
) 

SELECT 
    *
FROM raw_topics;


[0m15:07:38.144886 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:39a42f2c-3193-45df-917c-47d7f5cc3936&page=queryresults
[0m15:07:38.605695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f2fc6ab-b25c-493a-bf1e-2ce6af81f2ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7ff5d0>]}
[0m15:07:38.607483 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__topic .......... [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m15:07:38.609035 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__topic
[0m15:07:38.610471 [debug] [Thread-1 (]: Began running node model.curriculum_rec.topic_hierarchy
[0m15:07:38.611229 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_curriculum_rec.topic_hierarchy ................. [RUN]
[0m15:07:38.611874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__topic, now model.curriculum_rec.topic_hierarchy)
[0m15:07:38.612274 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.topic_hierarchy
[0m15:07:38.618183 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.topic_hierarchy"
[0m15:07:38.619810 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.topic_hierarchy
[0m15:07:38.625020 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.topic_hierarchy"
[0m15:07:38.626510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:38.629124 [debug] [Thread-1 (]: On model.curriculum_rec.topic_hierarchy: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.topic_hierarchy"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`topic_hierarchy`
  OPTIONS()
  as WITH 
generated_hierarchy AS (
    SELECT * FROM 
WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = 't_0868a6d7f4fe'

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
-- SELECT * FROM hierarchy;
SELECT 
    id_topic,
    ARRAY_AGG(
        STRUCT(
            id_topic,
            id_topic_parent,
            val_topic_level,
            cat_topic_title
        )
    ) AS hierarchy_json
FROM hierarchy;

)

SELECT * FROM generated_hierarchy;;


[0m15:07:39.004885 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:5895deb4-8215-4cfc-8d5d-7bd1193371c4&page=queryresults
[0m15:07:39.006586 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword WITH at [9:1]; reason: invalidQuery, location: query, message: Syntax error: Unexpected keyword WITH at [9:1]')
[0m15:07:39.616126 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:fbe8272d-f8c9-4d16-bb8b-62421da5302f&page=queryresults
[0m15:07:39.618469 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:fbe8272d-f8c9-4d16-bb8b-62421da5302f&page=queryresults
[0m15:07:39.632290 [debug] [Thread-1 (]: Database Error in model topic_hierarchy (models/intermediate/education/topic_hierarchy.sql)
  Syntax error: Unexpected keyword WITH at [9:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/topic_hierarchy.sql
[0m15:07:39.633517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f2fc6ab-b25c-493a-bf1e-2ce6af81f2ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed085d0>]}
[0m15:07:39.634607 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model dbt_curriculum_rec.topic_hierarchy ........ [[31mERROR[0m in 1.02s]
[0m15:07:39.635480 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.topic_hierarchy
[0m15:07:39.638704 [debug] [Thread-1 (]: Began running node model.curriculum_rec.content
[0m15:07:39.640011 [info ] [Thread-1 (]: 5 of 5 SKIP relation dbt_curriculum_rec.content ................................ [[33mSKIP[0m]
[0m15:07:39.640853 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.content
[0m15:07:39.643064 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:39.643606 [debug] [MainThread]: Connection 'model.curriculum_rec.topic_hierarchy' was properly closed.
[0m15:07:39.644137 [info ] [MainThread]: 
[0m15:07:39.644866 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 4.78 seconds (4.78s).
[0m15:07:39.646430 [debug] [MainThread]: Command end result
[0m15:07:39.678571 [info ] [MainThread]: 
[0m15:07:39.678917 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:07:39.679109 [info ] [MainThread]: 
[0m15:07:39.679338 [error] [MainThread]:   Database Error in model topic_hierarchy (models/intermediate/education/topic_hierarchy.sql)
  Syntax error: Unexpected keyword WITH at [9:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/topic_hierarchy.sql
[0m15:07:39.679528 [info ] [MainThread]: 
[0m15:07:39.679721 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m15:07:39.681165 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.3952866, "process_user_time": 1.534694, "process_kernel_time": 0.193211, "process_mem_max_rss": "213975040", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:07:39.681487 [debug] [MainThread]: Command `dbt run` failed at 15:07:39.681433 after 5.40 seconds
[0m15:07:39.681717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f8fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb88d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb95990>]}
[0m15:07:39.681923 [debug] [MainThread]: Flushing usage events
[0m15:10:06.109030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109257390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092abe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10666f550>]}


============================== 15:10:06.110702 | 2cc5fdfd-5f16-4f69-affd-0eb571b584cf ==============================
[0m15:10:06.110702 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:10:06.110975 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:10:06.414705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cc5fdfd-5f16-4f69-affd-0eb571b584cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10924bf10>]}
[0m15:10:06.433698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cc5fdfd-5f16-4f69-affd-0eb571b584cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107835510>]}
[0m15:10:06.433933 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:10:06.445961 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:10:06.531211 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:10:06.531553 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://macros/generate_topic_hierarchy.sql
[0m15:10:06.622023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cc5fdfd-5f16-4f69-affd-0eb571b584cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea656d0>]}
[0m15:10:06.661246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cc5fdfd-5f16-4f69-affd-0eb571b584cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed8a1d0>]}
[0m15:10:06.661457 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m15:10:06.661607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cc5fdfd-5f16-4f69-affd-0eb571b584cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b69910>]}
[0m15:10:06.662408 [info ] [MainThread]: 
[0m15:10:06.662636 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:10:06.664196 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m15:10:06.664370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:07.003492 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m15:10:07.004714 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:10:07.353641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cc5fdfd-5f16-4f69-affd-0eb571b584cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edf7690>]}
[0m15:10:07.354895 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:10:07.355339 [info ] [MainThread]: 
[0m15:10:07.360415 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__content
[0m15:10:07.361153 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__content ............. [RUN]
[0m15:10:07.361620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.stg_kaggle__content)
[0m15:10:07.361949 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__content
[0m15:10:07.369261 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__content"
[0m15:10:07.369977 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__content
[0m15:10:07.390163 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__content"
[0m15:10:07.390573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:07.391681 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__content.sql
WITH raw_content AS 
(
SELECT 
    id as id_content, 
    title as cat_content_title, 
    description as cat_content_description, 
    kind as cat_content_kind,
    text as cat_content_text,
    copyright_holder as cat_content_copyright_holder,
    license as id_content_license 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_content`
) 

SELECT 
    * 
FROM raw_content;


[0m15:10:07.996118 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:1abfa3fb-8279-4a7e-a4c0-9c8894073ee3&page=queryresults
[0m15:10:08.452298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cc5fdfd-5f16-4f69-affd-0eb571b584cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef7fcd0>]}
[0m15:10:08.453111 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__content ........ [[32mCREATE VIEW (0 processed)[0m in 1.09s]
[0m15:10:08.454021 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__content
[0m15:10:08.454544 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__correl
[0m15:10:08.455060 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__correl .............. [RUN]
[0m15:10:08.455424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__content, now model.curriculum_rec.stg_kaggle__correl)
[0m15:10:08.455703 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__correl
[0m15:10:08.458406 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__correl"
[0m15:10:08.459136 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__correl
[0m15:10:08.461098 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__correl"
[0m15:10:08.461607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:08.463126 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__correl: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__correl"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__correl.sql
WITH raw_correl AS 
(
    SELECT 
    topic_id as id_topic, 
    -- probably can do some sort of transformation here it should be a list not a string --  
    -- sql doesn't natively use lists though -- 
    -- have to make the table better don't use lists -- 
    content_id as id_content 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_correlation`
)

SELECT 
    * 
FROM raw_correl;


[0m15:10:09.122737 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:b722dbfd-2ded-4410-aefb-a75fd96e726d&page=queryresults
[0m15:10:09.660541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cc5fdfd-5f16-4f69-affd-0eb571b584cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e406dd0>]}
[0m15:10:09.662109 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__correl ......... [[32mCREATE VIEW (0 processed)[0m in 1.20s]
[0m15:10:09.662889 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__correl
[0m15:10:09.663385 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__topic
[0m15:10:09.664058 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__topic ............... [RUN]
[0m15:10:09.664654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__correl, now model.curriculum_rec.stg_kaggle__topic)
[0m15:10:09.665023 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__topic
[0m15:10:09.668393 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__topic"
[0m15:10:09.669141 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__topic
[0m15:10:09.671549 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__topic"
[0m15:10:09.672140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:09.673610 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__topic: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__topic"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__topics.sql
WITH raw_topics AS 
(
SELECT  
    id as id_topic, 
    title as cat_topic_title, 
    description as cat_topic_description, 
    channel as id_topic_description, 
    -- already encoded don't need to use case when -- 
    category as cat_topic_category, 
    level as val_topic_level, 
    parent as id_topic_parent, 
    has_content as ind_topic_has_content
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_topic`
) 

SELECT 
    *
FROM raw_topics;


[0m15:10:10.353032 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:4ed1a632-969e-4604-a818-87834c416743&page=queryresults
[0m15:10:10.649951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cc5fdfd-5f16-4f69-affd-0eb571b584cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edd5f90>]}
[0m15:10:10.651079 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__topic .......... [[32mCREATE VIEW (0 processed)[0m in 0.99s]
[0m15:10:10.651759 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__topic
[0m15:10:10.652814 [debug] [Thread-1 (]: Began running node model.curriculum_rec.topic_hierarchy
[0m15:10:10.653401 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_curriculum_rec.topic_hierarchy ................. [RUN]
[0m15:10:10.653807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__topic, now model.curriculum_rec.topic_hierarchy)
[0m15:10:10.654108 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.topic_hierarchy
[0m15:10:10.659651 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.topic_hierarchy"
[0m15:10:10.660451 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.topic_hierarchy
[0m15:10:10.662637 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.topic_hierarchy"
[0m15:10:10.663172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:10.664579 [debug] [Thread-1 (]: On model.curriculum_rec.topic_hierarchy: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.topic_hierarchy"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`topic_hierarchy`
  OPTIONS()
  as WITH 
generated_hierarchy AS (
    SELECT * FROM 
WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = 't_0868a6d7f4fe'

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
-- SELECT * FROM hierarchy;
SELECT 
    id_topic,
    TO_JSON_STRING(
        STRUCT(
            id_topic,
            id_topic_parent,
            val_topic_level,
            cat_topic_title
        )
    ) AS hierarchy_json
FROM hierarchy;

)

SELECT * FROM generated_hierarchy;;


[0m15:10:11.068539 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:c82e8db4-2ea8-45be-92bc-84e9ebbaf0bf&page=queryresults
[0m15:10:11.070518 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword WITH at [9:1]; reason: invalidQuery, location: query, message: Syntax error: Unexpected keyword WITH at [9:1]')
[0m15:10:11.811427 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:5826d7c1-7ec2-4c42-859d-fe584109b0fb&page=queryresults
[0m15:10:11.812851 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:5826d7c1-7ec2-4c42-859d-fe584109b0fb&page=queryresults
[0m15:10:11.821217 [debug] [Thread-1 (]: Database Error in model topic_hierarchy (models/intermediate/education/topic_hierarchy.sql)
  Syntax error: Unexpected keyword WITH at [9:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/topic_hierarchy.sql
[0m15:10:11.821807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cc5fdfd-5f16-4f69-affd-0eb571b584cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eff3d10>]}
[0m15:10:11.822470 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model dbt_curriculum_rec.topic_hierarchy ........ [[31mERROR[0m in 1.17s]
[0m15:10:11.823002 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.topic_hierarchy
[0m15:10:11.824467 [debug] [Thread-1 (]: Began running node model.curriculum_rec.content
[0m15:10:11.824899 [info ] [Thread-1 (]: 5 of 5 SKIP relation dbt_curriculum_rec.content ................................ [[33mSKIP[0m]
[0m15:10:11.825294 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.content
[0m15:10:11.826303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:10:11.826564 [debug] [MainThread]: Connection 'model.curriculum_rec.topic_hierarchy' was properly closed.
[0m15:10:11.826907 [info ] [MainThread]: 
[0m15:10:11.827193 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.16 seconds (5.16s).
[0m15:10:11.828068 [debug] [MainThread]: Command end result
[0m15:10:11.854289 [info ] [MainThread]: 
[0m15:10:11.854599 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:10:11.854770 [info ] [MainThread]: 
[0m15:10:11.854991 [error] [MainThread]:   Database Error in model topic_hierarchy (models/intermediate/education/topic_hierarchy.sql)
  Syntax error: Unexpected keyword WITH at [9:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/topic_hierarchy.sql
[0m15:10:11.855161 [info ] [MainThread]: 
[0m15:10:11.855333 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m15:10:11.856604 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.771748, "process_user_time": 1.470552, "process_kernel_time": 0.183785, "process_mem_max_rss": "211976192", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:10:11.856910 [debug] [MainThread]: Command `dbt run` failed at 15:10:11.856860 after 5.77 seconds
[0m15:10:11.857110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092b0290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092d9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efa7090>]}
[0m15:10:11.857311 [debug] [MainThread]: Flushing usage events
[0m15:10:37.442070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107557a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075a7e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075d9590>]}


============================== 15:10:37.443885 | 41d0eddd-efc2-4326-8b3b-3c48e7ca8d37 ==============================
[0m15:10:37.443885 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:10:37.444172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'debug': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:10:37.752189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41d0eddd-efc2-4326-8b3b-3c48e7ca8d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075a6ad0>]}
[0m15:10:37.771409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41d0eddd-efc2-4326-8b3b-3c48e7ca8d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104271550>]}
[0m15:10:37.771646 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:10:37.782689 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:10:37.868061 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:10:37.868360 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/intermediate/education/topic_hierarchy.sql
[0m15:10:37.956468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41d0eddd-efc2-4326-8b3b-3c48e7ca8d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd9f7d0>]}
[0m15:10:37.996190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41d0eddd-efc2-4326-8b3b-3c48e7ca8d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec208d0>]}
[0m15:10:37.996403 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m15:10:37.996553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41d0eddd-efc2-4326-8b3b-3c48e7ca8d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec12d90>]}
[0m15:10:37.997367 [info ] [MainThread]: 
[0m15:10:37.997594 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:10:37.999154 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m15:10:37.999329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:38.338917 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m15:10:38.339799 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:10:38.693623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41d0eddd-efc2-4326-8b3b-3c48e7ca8d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e995590>]}
[0m15:10:38.695004 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:10:38.695573 [info ] [MainThread]: 
[0m15:10:38.699707 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__content
[0m15:10:38.700507 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__content ............. [RUN]
[0m15:10:38.701067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.stg_kaggle__content)
[0m15:10:38.701456 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__content
[0m15:10:38.709069 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__content"
[0m15:10:38.709768 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__content
[0m15:10:38.731491 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__content"
[0m15:10:38.731930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:38.733059 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__content.sql
WITH raw_content AS 
(
SELECT 
    id as id_content, 
    title as cat_content_title, 
    description as cat_content_description, 
    kind as cat_content_kind,
    text as cat_content_text,
    copyright_holder as cat_content_copyright_holder,
    license as id_content_license 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_content`
) 

SELECT 
    * 
FROM raw_content;


[0m15:10:39.333597 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:56a8cd42-e2aa-4f30-92af-485dd5ceb8a1&page=queryresults
[0m15:10:39.804041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41d0eddd-efc2-4326-8b3b-3c48e7ca8d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec4d110>]}
[0m15:10:39.804497 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__content ........ [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m15:10:39.804834 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__content
[0m15:10:39.805066 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__correl
[0m15:10:39.805388 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__correl .............. [RUN]
[0m15:10:39.805689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__content, now model.curriculum_rec.stg_kaggle__correl)
[0m15:10:39.805889 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__correl
[0m15:10:39.807620 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__correl"
[0m15:10:39.808062 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__correl
[0m15:10:39.809438 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__correl"
[0m15:10:39.809781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:39.810693 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__correl: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__correl"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__correl.sql
WITH raw_correl AS 
(
    SELECT 
    topic_id as id_topic, 
    -- probably can do some sort of transformation here it should be a list not a string --  
    -- sql doesn't natively use lists though -- 
    -- have to make the table better don't use lists -- 
    content_id as id_content 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_correlation`
)

SELECT 
    * 
FROM raw_correl;


[0m15:10:40.704952 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:ecbb207d-e43c-4926-a630-54c3f09cce9f&page=queryresults
[0m15:10:41.418075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41d0eddd-efc2-4326-8b3b-3c48e7ca8d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddd0d10>]}
[0m15:10:41.419413 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__correl ......... [[32mCREATE VIEW (0 processed)[0m in 1.61s]
[0m15:10:41.420401 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__correl
[0m15:10:41.420978 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__topic
[0m15:10:41.421649 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__topic ............... [RUN]
[0m15:10:41.422167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__correl, now model.curriculum_rec.stg_kaggle__topic)
[0m15:10:41.423066 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__topic
[0m15:10:41.427268 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__topic"
[0m15:10:41.428112 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__topic
[0m15:10:41.430628 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__topic"
[0m15:10:41.431231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:41.432821 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__topic: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__topic"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__topics.sql
WITH raw_topics AS 
(
SELECT  
    id as id_topic, 
    title as cat_topic_title, 
    description as cat_topic_description, 
    channel as id_topic_description, 
    -- already encoded don't need to use case when -- 
    category as cat_topic_category, 
    level as val_topic_level, 
    parent as id_topic_parent, 
    has_content as ind_topic_has_content
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_topic`
) 

SELECT 
    *
FROM raw_topics;


[0m15:10:41.994549 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:75e0af50-3238-4bea-9380-f301d789b9af&page=queryresults
[0m15:10:42.474210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41d0eddd-efc2-4326-8b3b-3c48e7ca8d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec12a90>]}
[0m15:10:42.475428 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__topic .......... [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m15:10:42.476139 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__topic
[0m15:10:42.477579 [debug] [Thread-1 (]: Began running node model.curriculum_rec.topic_hierarchy
[0m15:10:42.478279 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_curriculum_rec.topic_hierarchy ................. [RUN]
[0m15:10:42.478649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__topic, now model.curriculum_rec.topic_hierarchy)
[0m15:10:42.478962 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.topic_hierarchy
[0m15:10:42.481477 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.topic_hierarchy"
[0m15:10:42.482095 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.topic_hierarchy
[0m15:10:42.483807 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.topic_hierarchy"
[0m15:10:42.484174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:42.485180 [debug] [Thread-1 (]: On model.curriculum_rec.topic_hierarchy: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.topic_hierarchy"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`topic_hierarchy`
  OPTIONS()
  as SELECT * FROM 
WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = 't_0868a6d7f4fe'

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
-- SELECT * FROM hierarchy;
SELECT 
    id_topic,
    TO_JSON_STRING(
        STRUCT(
            id_topic,
            id_topic_parent,
            val_topic_level,
            cat_topic_title
        )
    ) AS hierarchy_json
FROM hierarchy;
;


[0m15:10:42.864902 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:1c7cea5f-fe79-43a4-9441-8aae33489a72&page=queryresults
[0m15:10:42.866481 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword WITH at [7:1]; reason: invalidQuery, location: query, message: Syntax error: Unexpected keyword WITH at [7:1]')
[0m15:10:43.535383 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:f6c43b09-9db7-44ec-ad38-ef707a84ae4a&page=queryresults
[0m15:10:43.537483 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:f6c43b09-9db7-44ec-ad38-ef707a84ae4a&page=queryresults
[0m15:10:43.546292 [debug] [Thread-1 (]: Database Error in model topic_hierarchy (models/intermediate/education/topic_hierarchy.sql)
  Syntax error: Unexpected keyword WITH at [7:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/topic_hierarchy.sql
[0m15:10:43.546958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41d0eddd-efc2-4326-8b3b-3c48e7ca8d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edd2050>]}
[0m15:10:43.547633 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model dbt_curriculum_rec.topic_hierarchy ........ [[31mERROR[0m in 1.07s]
[0m15:10:43.548178 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.topic_hierarchy
[0m15:10:43.549564 [debug] [Thread-1 (]: Began running node model.curriculum_rec.content
[0m15:10:43.550050 [info ] [Thread-1 (]: 5 of 5 SKIP relation dbt_curriculum_rec.content ................................ [[33mSKIP[0m]
[0m15:10:43.550434 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.content
[0m15:10:43.551554 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:10:43.551831 [debug] [MainThread]: Connection 'model.curriculum_rec.topic_hierarchy' was properly closed.
[0m15:10:43.552160 [info ] [MainThread]: 
[0m15:10:43.552445 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.55 seconds (5.55s).
[0m15:10:43.553350 [debug] [MainThread]: Command end result
[0m15:10:43.579316 [info ] [MainThread]: 
[0m15:10:43.579595 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:10:43.579763 [info ] [MainThread]: 
[0m15:10:43.579967 [error] [MainThread]:   Database Error in model topic_hierarchy (models/intermediate/education/topic_hierarchy.sql)
  Syntax error: Unexpected keyword WITH at [7:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/topic_hierarchy.sql
[0m15:10:43.580135 [info ] [MainThread]: 
[0m15:10:43.580299 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m15:10:43.581543 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.1644964, "process_user_time": 1.482715, "process_kernel_time": 0.187285, "process_mem_max_rss": "212467712", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:10:43.581843 [debug] [MainThread]: Command `dbt run` failed at 15:10:43.581788 after 6.16 seconds
[0m15:10:43.582061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1015e5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1015e5510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1015e4c50>]}
[0m15:10:43.582318 [debug] [MainThread]: Flushing usage events
[0m15:12:10.825125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e56c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ed8c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ed9250>]}


============================== 15:12:10.827046 | 594bd303-ce7b-4f4b-84e2-76eb71f3be3a ==============================
[0m15:12:10.827046 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:12:10.827329 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select models/staging/kaggle', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:12:11.141274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '594bd303-ce7b-4f4b-84e2-76eb71f3be3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116492090>]}
[0m15:12:11.160458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '594bd303-ce7b-4f4b-84e2-76eb71f3be3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104479190>]}
[0m15:12:11.160690 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:12:11.172915 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:12:11.259031 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:12:11.259345 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/marts/education/content.sql
[0m15:12:11.348465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '594bd303-ce7b-4f4b-84e2-76eb71f3be3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1165d2690>]}
[0m15:12:11.388592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '594bd303-ce7b-4f4b-84e2-76eb71f3be3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1169e3f10>]}
[0m15:12:11.388810 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m15:12:11.388960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '594bd303-ce7b-4f4b-84e2-76eb71f3be3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1164eb350>]}
[0m15:12:11.389771 [info ] [MainThread]: 
[0m15:12:11.389996 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:12:11.391502 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m15:12:11.391692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:11.802154 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m15:12:11.803092 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:12.211788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '594bd303-ce7b-4f4b-84e2-76eb71f3be3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116b51e90>]}
[0m15:12:12.213521 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:12:12.214252 [info ] [MainThread]: 
[0m15:12:12.217844 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__content
[0m15:12:12.219045 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_curriculum_rec.stg_kaggle__content ............. [RUN]
[0m15:12:12.219721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.stg_kaggle__content)
[0m15:12:12.220130 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__content
[0m15:12:12.228146 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__content"
[0m15:12:12.228991 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__content
[0m15:12:12.251612 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__content"
[0m15:12:12.252253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:12.253427 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__content.sql
WITH raw_content AS 
(
SELECT 
    id as id_content, 
    title as cat_content_title, 
    description as cat_content_description, 
    kind as cat_content_kind,
    text as cat_content_text,
    copyright_holder as cat_content_copyright_holder,
    license as id_content_license 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_content`
) 

SELECT 
    * 
FROM raw_content;


[0m15:12:12.926635 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:2e8531b4-0f57-40e0-9469-a028365d4f96&page=queryresults
[0m15:12:13.288380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '594bd303-ce7b-4f4b-84e2-76eb71f3be3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115c69f50>]}
[0m15:12:13.289174 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dbt_curriculum_rec.stg_kaggle__content ........ [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m15:12:13.289657 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__content
[0m15:12:13.289991 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__correl
[0m15:12:13.290442 [info ] [Thread-1 (]: 2 of 3 START sql view model dbt_curriculum_rec.stg_kaggle__correl .............. [RUN]
[0m15:12:13.290825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__content, now model.curriculum_rec.stg_kaggle__correl)
[0m15:12:13.291092 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__correl
[0m15:12:13.293494 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__correl"
[0m15:12:13.294139 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__correl
[0m15:12:13.296019 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__correl"
[0m15:12:13.296488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:13.297711 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__correl: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__correl"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__correl.sql
WITH raw_correl AS 
(
    SELECT 
    topic_id as id_topic, 
    -- probably can do some sort of transformation here it should be a list not a string --  
    -- sql doesn't natively use lists though -- 
    -- have to make the table better don't use lists -- 
    content_id as id_content 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_correlation`
)

SELECT 
    * 
FROM raw_correl;


[0m15:12:13.950535 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:02ec7e3f-4455-45b1-8e53-e61f7e1d3389&page=queryresults
[0m15:12:14.265642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '594bd303-ce7b-4f4b-84e2-76eb71f3be3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116c00a10>]}
[0m15:12:14.267619 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dbt_curriculum_rec.stg_kaggle__correl ......... [[32mCREATE VIEW (0 processed)[0m in 0.97s]
[0m15:12:14.268367 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__correl
[0m15:12:14.269093 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__topic
[0m15:12:14.269869 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_curriculum_rec.stg_kaggle__topic ............... [RUN]
[0m15:12:14.270287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__correl, now model.curriculum_rec.stg_kaggle__topic)
[0m15:12:14.270541 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__topic
[0m15:12:14.273197 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__topic"
[0m15:12:14.273879 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__topic
[0m15:12:14.275752 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__topic"
[0m15:12:14.276192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:14.277395 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__topic: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__topic"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__topics.sql
WITH raw_topics AS 
(
SELECT  
    id as id_topic, 
    title as cat_topic_title, 
    description as cat_topic_description, 
    channel as id_topic_description, 
    -- already encoded don't need to use case when -- 
    category as cat_topic_category, 
    level as val_topic_level, 
    parent as id_topic_parent, 
    has_content as ind_topic_has_content
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_topic`
) 

SELECT 
    *
FROM raw_topics;


[0m15:12:14.872033 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:bce3d0e1-700e-452c-9153-aa76ee0d2eae&page=queryresults
[0m15:12:15.361609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '594bd303-ce7b-4f4b-84e2-76eb71f3be3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1164cedd0>]}
[0m15:12:15.362970 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dbt_curriculum_rec.stg_kaggle__topic .......... [[32mCREATE VIEW (0 processed)[0m in 1.09s]
[0m15:12:15.363935 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__topic
[0m15:12:15.365684 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:12:15.366190 [debug] [MainThread]: Connection 'model.curriculum_rec.stg_kaggle__topic' was properly closed.
[0m15:12:15.366575 [info ] [MainThread]: 
[0m15:12:15.366882 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.98 seconds (3.98s).
[0m15:12:15.367780 [debug] [MainThread]: Command end result
[0m15:12:15.396247 [info ] [MainThread]: 
[0m15:12:15.396512 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:12:15.396680 [info ] [MainThread]: 
[0m15:12:15.396863 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:12:15.398070 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.5984125, "process_user_time": 1.39764, "process_kernel_time": 0.183925, "process_mem_max_rss": "211599360", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:12:15.398488 [debug] [MainThread]: Command `dbt run` succeeded at 15:12:15.398429 after 4.60 seconds
[0m15:12:15.398691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1015ddd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1015395d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101539490>]}
[0m15:12:15.398878 [debug] [MainThread]: Flushing usage events
[0m15:12:33.314898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073682d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107504a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107505050>]}


============================== 15:12:33.316642 | 55496bba-505b-467f-8c5e-5a1d10ed4791 ==============================
[0m15:12:33.316642 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:12:33.316917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select models/intermediate/education/topic_hierarchy.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:12:33.618026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55496bba-505b-467f-8c5e-5a1d10ed4791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc31fd0>]}
[0m15:12:33.637303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55496bba-505b-467f-8c5e-5a1d10ed4791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a613d0>]}
[0m15:12:33.637549 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:12:33.648130 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:12:33.733431 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:12:33.733646 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:12:33.750818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55496bba-505b-467f-8c5e-5a1d10ed4791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c988850>]}
[0m15:12:33.791834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55496bba-505b-467f-8c5e-5a1d10ed4791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8b67d0>]}
[0m15:12:33.792067 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m15:12:33.792219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55496bba-505b-467f-8c5e-5a1d10ed4791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbbc450>]}
[0m15:12:33.792999 [info ] [MainThread]: 
[0m15:12:33.793232 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:12:33.793602 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m15:12:33.793776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:34.119284 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m15:12:34.120449 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:34.467861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55496bba-505b-467f-8c5e-5a1d10ed4791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfa7090>]}
[0m15:12:34.469568 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:12:34.470309 [info ] [MainThread]: 
[0m15:12:34.475326 [debug] [Thread-1 (]: Began running node model.curriculum_rec.topic_hierarchy
[0m15:12:34.476153 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_curriculum_rec.topic_hierarchy ................. [RUN]
[0m15:12:34.476728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.topic_hierarchy)
[0m15:12:34.477081 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.topic_hierarchy
[0m15:12:34.486940 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.topic_hierarchy"
[0m15:12:34.487768 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.topic_hierarchy
[0m15:12:34.507118 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.topic_hierarchy"
[0m15:12:34.507598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:34.508656 [debug] [Thread-1 (]: On model.curriculum_rec.topic_hierarchy: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.topic_hierarchy"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`topic_hierarchy`
  OPTIONS()
  as SELECT * FROM 
WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = 't_0868a6d7f4fe'

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
-- SELECT * FROM hierarchy;
SELECT 
    id_topic,
    TO_JSON_STRING(
        STRUCT(
            id_topic,
            id_topic_parent,
            val_topic_level,
            cat_topic_title
        )
    ) AS hierarchy_json
FROM hierarchy;
;


[0m15:12:34.944816 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:5b81a633-c02d-489a-aff0-179e72418498&page=queryresults
[0m15:12:34.946681 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword WITH at [7:1]; reason: invalidQuery, location: query, message: Syntax error: Unexpected keyword WITH at [7:1]')
[0m15:12:36.175172 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:7a5561c6-0b12-4de8-a8ed-1016b8b893a8&page=queryresults
[0m15:12:36.177189 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:7a5561c6-0b12-4de8-a8ed-1016b8b893a8&page=queryresults
[0m15:12:36.186224 [debug] [Thread-1 (]: Database Error in model topic_hierarchy (models/intermediate/education/topic_hierarchy.sql)
  Syntax error: Unexpected keyword WITH at [7:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/topic_hierarchy.sql
[0m15:12:36.188194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55496bba-505b-467f-8c5e-5a1d10ed4791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc29a90>]}
[0m15:12:36.188884 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_curriculum_rec.topic_hierarchy ........ [[31mERROR[0m in 1.71s]
[0m15:12:36.189438 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.topic_hierarchy
[0m15:12:36.191225 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:12:36.191559 [debug] [MainThread]: Connection 'model.curriculum_rec.topic_hierarchy' was properly closed.
[0m15:12:36.191853 [info ] [MainThread]: 
[0m15:12:36.192133 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.40 seconds (2.40s).
[0m15:12:36.192684 [debug] [MainThread]: Command end result
[0m15:12:36.218890 [info ] [MainThread]: 
[0m15:12:36.219174 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:12:36.219352 [info ] [MainThread]: 
[0m15:12:36.219553 [error] [MainThread]:   Database Error in model topic_hierarchy (models/intermediate/education/topic_hierarchy.sql)
  Syntax error: Unexpected keyword WITH at [7:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/topic_hierarchy.sql
[0m15:12:36.219706 [info ] [MainThread]: 
[0m15:12:36.219871 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:12:36.221057 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.930421, "process_user_time": 1.152717, "process_kernel_time": 0.156017, "process_mem_max_rss": "206209024", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:12:36.221335 [debug] [MainThread]: Command `dbt run` failed at 15:12:36.221289 after 2.93 seconds
[0m15:12:36.221536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074d5d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074dc8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10748c610>]}
[0m15:12:36.221724 [debug] [MainThread]: Flushing usage events
[0m15:12:59.588051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d9c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042a6f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e21310>]}


============================== 15:12:59.589779 | 53719fe6-6517-4d40-956b-bca03b2783e2 ==============================
[0m15:12:59.589779 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:12:59.590057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'version_check': 'True', 'profiles_dir': '/Users/CalvinLii/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select models/intermediate/education/topic_hierarchy.sql', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:12:59.896080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53719fe6-6517-4d40-956b-bca03b2783e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a58ce90>]}
[0m15:12:59.915845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53719fe6-6517-4d40-956b-bca03b2783e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104de2190>]}
[0m15:12:59.916099 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:12:59.927407 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:13:00.020783 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:13:00.021324 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://macros/generate_topic_hierarchy.sql
[0m15:13:00.116021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53719fe6-6517-4d40-956b-bca03b2783e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a942790>]}
[0m15:13:00.156052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53719fe6-6517-4d40-956b-bca03b2783e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a978550>]}
[0m15:13:00.156287 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m15:13:00.156448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53719fe6-6517-4d40-956b-bca03b2783e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a630dd0>]}
[0m15:13:00.157261 [info ] [MainThread]: 
[0m15:13:00.157488 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:13:00.157870 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m15:13:00.158052 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:00.492223 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m15:13:00.493237 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:00.810744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53719fe6-6517-4d40-956b-bca03b2783e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103aba590>]}
[0m15:13:00.811976 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:13:00.812529 [info ] [MainThread]: 
[0m15:13:00.819105 [debug] [Thread-1 (]: Began running node model.curriculum_rec.topic_hierarchy
[0m15:13:00.819964 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_curriculum_rec.topic_hierarchy ................. [RUN]
[0m15:13:00.820567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.topic_hierarchy)
[0m15:13:00.820961 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.topic_hierarchy
[0m15:13:00.828854 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.topic_hierarchy"
[0m15:13:00.829555 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.topic_hierarchy
[0m15:13:00.851229 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.topic_hierarchy"
[0m15:13:00.851748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:00.852819 [debug] [Thread-1 (]: On model.curriculum_rec.topic_hierarchy: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.topic_hierarchy"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`topic_hierarchy`
  OPTIONS()
  as SELECT * FROM WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = 't_0868a6d7f4fe'

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
-- SELECT * FROM hierarchy;
SELECT 
    id_topic,
    TO_JSON_STRING(
        STRUCT(
            id_topic,
            id_topic_parent,
            val_topic_level,
            cat_topic_title
        )
    ) AS hierarchy_json
FROM hierarchy;;


[0m15:13:01.188586 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:df510267-63a8-40bb-8f29-4622c632255d&page=queryresults
[0m15:13:01.189826 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword WITH at [6:20]; reason: invalidQuery, location: query, message: Syntax error: Unexpected keyword WITH at [6:20]')
[0m15:13:01.433806 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:d73d4091-539b-4b6b-a7d0-45e7e61dc19f&page=queryresults
[0m15:13:01.434764 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:d73d4091-539b-4b6b-a7d0-45e7e61dc19f&page=queryresults
[0m15:13:01.440916 [debug] [Thread-1 (]: Database Error in model topic_hierarchy (models/intermediate/education/topic_hierarchy.sql)
  Syntax error: Unexpected keyword WITH at [6:20]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/topic_hierarchy.sql
[0m15:13:01.442616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53719fe6-6517-4d40-956b-bca03b2783e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a626190>]}
[0m15:13:01.443454 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_curriculum_rec.topic_hierarchy ........ [[31mERROR[0m in 0.62s]
[0m15:13:01.444181 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.topic_hierarchy
[0m15:13:01.446451 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:01.446876 [debug] [MainThread]: Connection 'model.curriculum_rec.topic_hierarchy' was properly closed.
[0m15:13:01.447180 [info ] [MainThread]: 
[0m15:13:01.447545 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.29 seconds (1.29s).
[0m15:13:01.448187 [debug] [MainThread]: Command end result
[0m15:13:01.479510 [info ] [MainThread]: 
[0m15:13:01.479741 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:13:01.479876 [info ] [MainThread]: 
[0m15:13:01.480043 [error] [MainThread]:   Database Error in model topic_hierarchy (models/intermediate/education/topic_hierarchy.sql)
  Syntax error: Unexpected keyword WITH at [6:20]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/topic_hierarchy.sql
[0m15:13:01.480172 [info ] [MainThread]: 
[0m15:13:01.480309 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:13:01.481388 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.9178873, "process_user_time": 1.233897, "process_kernel_time": 0.166052, "process_mem_max_rss": "210714624", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:13:01.481636 [debug] [MainThread]: Command `dbt run` failed at 15:13:01.481598 after 1.92 seconds
[0m15:13:01.481805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103de0390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e21550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e21010>]}
[0m15:13:01.482021 [debug] [MainThread]: Flushing usage events
[0m15:14:53.258684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10524f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d0b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d1150>]}


============================== 15:14:53.260919 | 2852c219-9c4d-4e18-8849-1b8892661a2a ==============================
[0m15:14:53.260919 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:14:53.261197 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select models/intermediate/education/topic_hierarchy.sql', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:14:53.689273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2852c219-9c4d-4e18-8849-1b8892661a2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6a4810>]}
[0m15:14:53.708375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2852c219-9c4d-4e18-8849-1b8892661a2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10382d4d0>]}
[0m15:14:53.708612 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:14:53.720534 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:14:53.818409 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:14:53.818796 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://macros/generate_topic_hierarchy.sql
[0m15:14:53.913640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2852c219-9c4d-4e18-8849-1b8892661a2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa5d750>]}
[0m15:14:53.957853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2852c219-9c4d-4e18-8849-1b8892661a2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa419d0>]}
[0m15:14:53.958082 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m15:14:53.958229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2852c219-9c4d-4e18-8849-1b8892661a2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b14f50>]}
[0m15:14:53.959031 [info ] [MainThread]: 
[0m15:14:53.959257 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:14:53.959611 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m15:14:53.959780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:54.406696 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m15:14:54.407345 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:54.825985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2852c219-9c4d-4e18-8849-1b8892661a2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109738350>]}
[0m15:14:54.826964 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:14:54.827426 [info ] [MainThread]: 
[0m15:14:54.832459 [debug] [Thread-1 (]: Began running node model.curriculum_rec.topic_hierarchy
[0m15:14:54.833264 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_curriculum_rec.topic_hierarchy ................. [RUN]
[0m15:14:54.833827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.topic_hierarchy)
[0m15:14:54.834224 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.topic_hierarchy
[0m15:14:54.841403 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.topic_hierarchy"
[0m15:14:54.842084 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.topic_hierarchy
[0m15:14:54.862504 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.topic_hierarchy"
[0m15:14:54.862910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:54.863971 [debug] [Thread-1 (]: On model.curriculum_rec.topic_hierarchy: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.topic_hierarchy"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`topic_hierarchy`
  OPTIONS()
  as SELECT * FROM WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = t_0868a6d7f4fe

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
-- SELECT * FROM hierarchy;
SELECT 
    id_topic,
    TO_JSON_STRING(
        STRUCT(
            id_topic,
            id_topic_parent,
            val_topic_level,
            cat_topic_title
        )
    ) AS hierarchy_json
FROM hierarchy;;


[0m15:14:55.172903 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:87615fce-8073-468d-9f26-f47b9232bdcd&page=queryresults
[0m15:14:55.174634 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword WITH at [6:20]; reason: invalidQuery, location: query, message: Syntax error: Unexpected keyword WITH at [6:20]')
[0m15:14:56.043683 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:b0316165-c746-4be7-8891-b6f45b97254d&page=queryresults
[0m15:14:56.045652 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:b0316165-c746-4be7-8891-b6f45b97254d&page=queryresults
[0m15:14:56.057676 [debug] [Thread-1 (]: Database Error in model topic_hierarchy (models/intermediate/education/topic_hierarchy.sql)
  Syntax error: Unexpected keyword WITH at [6:20]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/topic_hierarchy.sql
[0m15:14:56.059362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2852c219-9c4d-4e18-8849-1b8892661a2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af551d0>]}
[0m15:14:56.059964 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_curriculum_rec.topic_hierarchy ........ [[31mERROR[0m in 1.22s]
[0m15:14:56.060433 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.topic_hierarchy
[0m15:14:56.062035 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:56.062251 [debug] [MainThread]: Connection 'model.curriculum_rec.topic_hierarchy' was properly closed.
[0m15:14:56.062480 [info ] [MainThread]: 
[0m15:14:56.062713 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.10 seconds (2.10s).
[0m15:14:56.063191 [debug] [MainThread]: Command end result
[0m15:14:56.087901 [info ] [MainThread]: 
[0m15:14:56.088156 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:14:56.088322 [info ] [MainThread]: 
[0m15:14:56.088519 [error] [MainThread]:   Database Error in model topic_hierarchy (models/intermediate/education/topic_hierarchy.sql)
  Syntax error: Unexpected keyword WITH at [6:20]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/topic_hierarchy.sql
[0m15:14:56.088675 [info ] [MainThread]: 
[0m15:14:56.088834 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:14:56.090280 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.8572085, "process_user_time": 1.230345, "process_kernel_time": 0.192797, "process_mem_max_rss": "210452480", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:14:56.090564 [debug] [MainThread]: Command `dbt run` failed at 15:14:56.090517 after 2.86 seconds
[0m15:14:56.090765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d0e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052a88d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105258490>]}
[0m15:14:56.090947 [debug] [MainThread]: Flushing usage events
[0m15:15:37.963040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e92a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee5cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f15410>]}


============================== 15:15:37.964723 | ff042357-ef25-41f3-8733-25af06250dba ==============================
[0m15:15:37.964723 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:15:37.964999 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:15:38.270398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff042357-ef25-41f3-8733-25af06250dba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e90050>]}
[0m15:15:38.289495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff042357-ef25-41f3-8733-25af06250dba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105571310>]}
[0m15:15:38.289726 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:15:38.300723 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:15:38.386553 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m15:15:38.386841 [debug] [MainThread]: Partial parsing: added file: curriculum_rec://models/intermediate/education/wip.sql
[0m15:15:38.387000 [debug] [MainThread]: Partial parsing: deleted file: curriculum_rec://models/intermediate/education/topic_hierarchy.sql
[0m15:15:38.451979 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.curriculum_rec.content' (models/marts/education/content.sql) depends on a node named 'topic_hierarchy' which was not found
[0m15:15:38.453090 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5141604, "process_user_time": 0.914555, "process_kernel_time": 0.145602, "process_mem_max_rss": "205291520", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:15:38.453342 [debug] [MainThread]: Command `dbt run` failed at 15:15:38.453305 after 0.51 seconds
[0m15:15:38.453508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed40d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eec8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e91490>]}
[0m15:15:38.453660 [debug] [MainThread]: Flushing usage events
[0m15:16:17.223272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e63310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee4bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee5210>]}


============================== 15:16:17.225050 | b2b25259-895a-4099-93ee-dc33c4774670 ==============================
[0m15:16:17.225050 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:16:17.225324 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:16:17.539123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2b25259-895a-4099-93ee-dc33c4774670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aba1890>]}
[0m15:16:17.558237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2b25259-895a-4099-93ee-dc33c4774670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105441610>]}
[0m15:16:17.558474 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:16:17.569686 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:16:17.654768 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m15:16:17.655047 [debug] [MainThread]: Partial parsing: added file: curriculum_rec://models/intermediate/education/wip.sql
[0m15:16:17.655209 [debug] [MainThread]: Partial parsing: deleted file: curriculum_rec://models/intermediate/education/topic_hierarchy.sql
[0m15:16:17.655356 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/marts/education/content.sql
[0m15:16:17.721032 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.curriculum_rec.content' (models/marts/education/content.sql) depends on a node named 'topic_hierarchy' which was not found
[0m15:16:17.722116 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5243318, "process_user_time": 0.918532, "process_kernel_time": 0.151862, "process_mem_max_rss": "204242944", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:16:17.722343 [debug] [MainThread]: Command `dbt run` failed at 15:16:17.722305 after 0.52 seconds
[0m15:16:17.722511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee7190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca56e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c77a890>]}
[0m15:16:17.722670 [debug] [MainThread]: Flushing usage events
[0m15:17:20.065388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107023890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107075cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070a54d0>]}


============================== 15:17:20.067119 | fa35840a-bf97-4be6-9ad2-122a09dc75c9 ==============================
[0m15:17:20.067119 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:17:20.067408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select macros/generate_topic_hierarchy.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:17:20.380040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa35840a-bf97-4be6-9ad2-122a09dc75c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107838d10>]}
[0m15:17:20.399148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa35840a-bf97-4be6-9ad2-122a09dc75c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105609890>]}
[0m15:17:20.399397 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:17:20.410843 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:17:20.496997 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 2 files changed.
[0m15:17:20.497272 [debug] [MainThread]: Partial parsing: added file: curriculum_rec://models/intermediate/education/wip.sql
[0m15:17:20.497425 [debug] [MainThread]: Partial parsing: deleted file: curriculum_rec://models/intermediate/education/topic_hierarchy.sql
[0m15:17:20.497551 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/marts/education/content.sql
[0m15:17:20.497691 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://macros/generate_topic_hierarchy.sql
[0m15:17:20.563601 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.curriculum_rec.content' (models/marts/education/content.sql) depends on a node named 'topic_hierarchy' which was not found
[0m15:17:20.564644 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.52406716, "process_user_time": 0.919914, "process_kernel_time": 0.146691, "process_mem_max_rss": "203587584", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:17:20.564876 [debug] [MainThread]: Command `dbt run` failed at 15:17:20.564838 after 0.52 seconds
[0m15:17:20.565040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070a4e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10707c8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db00950>]}
[0m15:17:20.565193 [debug] [MainThread]: Flushing usage events
[0m15:17:56.777408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072daa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10732a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10732b810>]}


============================== 15:17:56.779067 | 56871601-6870-4f27-b28b-2a77e4f82027 ==============================
[0m15:17:56.779067 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:17:56.779333 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select macros/generate_topic_hierarchy.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:17:57.082680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56871601-6870-4f27-b28b-2a77e4f82027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10730e850>]}
[0m15:17:57.101869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56871601-6870-4f27-b28b-2a77e4f82027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058b9510>]}
[0m15:17:57.102105 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:17:57.112849 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:17:57.197917 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 2 files changed.
[0m15:17:57.198186 [debug] [MainThread]: Partial parsing: added file: curriculum_rec://models/intermediate/education/wip.sql
[0m15:17:57.198345 [debug] [MainThread]: Partial parsing: deleted file: curriculum_rec://models/intermediate/education/topic_hierarchy.sql
[0m15:17:57.198479 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/marts/education/content.sql
[0m15:17:57.198622 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://macros/generate_topic_hierarchy.sql
[0m15:17:57.288848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56871601-6870-4f27-b28b-2a77e4f82027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb60450>]}
[0m15:17:57.327865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56871601-6870-4f27-b28b-2a77e4f82027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bab510>]}
[0m15:17:57.328082 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m15:17:57.328237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56871601-6870-4f27-b28b-2a77e4f82027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105140150>]}
[0m15:17:57.328642 [warn ] [MainThread]: The selection criterion 'macros/generate_topic_hierarchy.sql' does not match any enabled nodes
[0m15:17:57.329152 [info ] [MainThread]: 
[0m15:17:57.329298 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:17:57.329475 [debug] [MainThread]: Command end result
[0m15:17:57.343126 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5897593, "process_user_time": 0.988129, "process_kernel_time": 0.139806, "process_mem_max_rss": "204357632", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:17:57.343348 [debug] [MainThread]: Command `dbt run` succeeded at 15:17:57.343314 after 0.59 seconds
[0m15:17:57.343503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10735cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073348d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f19c90>]}
[0m15:17:57.343638 [debug] [MainThread]: Flushing usage events
[0m15:18:29.249461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ae5dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aec7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b15810>]}


============================== 15:18:29.251213 | 119e195f-6b2a-4576-910d-fa4d863281c1 ==============================
[0m15:18:29.251213 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:18:29.251505 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'send_anonymous_usage_stats': 'True'}
[0m15:18:29.554216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '119e195f-6b2a-4576-910d-fa4d863281c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d33ef50>]}
[0m15:18:29.573448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '119e195f-6b2a-4576-910d-fa4d863281c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106179110>]}
[0m15:18:29.573693 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:18:29.584524 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:18:29.669383 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:18:29.669594 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:18:29.686587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '119e195f-6b2a-4576-910d-fa4d863281c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108315250>]}
[0m15:18:29.728914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '119e195f-6b2a-4576-910d-fa4d863281c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106008f10>]}
[0m15:18:29.729139 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m15:18:29.729298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '119e195f-6b2a-4576-910d-fa4d863281c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5c0190>]}
[0m15:18:29.730136 [info ] [MainThread]: 
[0m15:18:29.730377 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:18:29.730759 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m15:18:29.730931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:30.078672 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m15:18:30.079409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:30.586891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '119e195f-6b2a-4576-910d-fa4d863281c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff0c4d0>]}
[0m15:18:30.588033 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:18:30.588459 [info ] [MainThread]: 
[0m15:18:30.592916 [debug] [Thread-1 (]: Began running node model.curriculum_rec.wip
[0m15:18:30.593620 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_curriculum_rec.wip ............................. [RUN]
[0m15:18:30.594129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.wip)
[0m15:18:30.594487 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.wip
[0m15:18:30.604004 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.wip"
[0m15:18:30.604759 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.wip
[0m15:18:30.624237 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.wip"
[0m15:18:30.624650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:30.625685 [debug] [Thread-1 (]: On model.curriculum_rec.wip: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.wip"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`wip`
  OPTIONS()
  as SELECT * FROM WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = t_0868a6d7f4fe

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
-- SELECT * FROM hierarchy;
SELECT 
    id_topic,
    TO_JSON_STRING(
        STRUCT(
            id_topic,
            id_topic_parent,
            val_topic_level,
            cat_topic_title
        )
    ) AS hierarchy_json
FROM hierarchy;;


[0m15:18:31.096709 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:e3b09609-fcc0-44fe-a952-cd89130c8422&page=queryresults
[0m15:18:31.098198 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword WITH at [6:20]; reason: invalidQuery, location: query, message: Syntax error: Unexpected keyword WITH at [6:20]')
[0m15:18:31.722172 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:e51c6d54-a2f4-4fa1-bb72-88943a2bd57d&page=queryresults
[0m15:18:31.724050 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:e51c6d54-a2f4-4fa1-bb72-88943a2bd57d&page=queryresults
[0m15:18:31.731893 [debug] [Thread-1 (]: Database Error in model wip (models/intermediate/education/wip.sql)
  Syntax error: Unexpected keyword WITH at [6:20]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m15:18:31.733614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '119e195f-6b2a-4576-910d-fa4d863281c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff6d610>]}
[0m15:18:31.734237 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_curriculum_rec.wip .................... [[31mERROR[0m in 1.14s]
[0m15:18:31.734708 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.wip
[0m15:18:31.736349 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:31.736642 [debug] [MainThread]: Connection 'model.curriculum_rec.wip' was properly closed.
[0m15:18:31.736897 [info ] [MainThread]: 
[0m15:18:31.737142 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.01 seconds (2.01s).
[0m15:18:31.737620 [debug] [MainThread]: Command end result
[0m15:18:31.762120 [info ] [MainThread]: 
[0m15:18:31.762404 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:18:31.762559 [info ] [MainThread]: 
[0m15:18:31.762747 [error] [MainThread]:   Database Error in model wip (models/intermediate/education/wip.sql)
  Syntax error: Unexpected keyword WITH at [6:20]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m15:18:31.762891 [info ] [MainThread]: 
[0m15:18:31.763045 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:18:31.764155 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.5389805, "process_user_time": 1.142183, "process_kernel_time": 0.156173, "process_mem_max_rss": "206356480", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:18:31.764461 [debug] [MainThread]: Command `dbt run` failed at 15:18:31.764410 after 2.54 seconds
[0m15:18:31.764660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad4290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034a56d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034a5490>]}
[0m15:18:31.764861 [debug] [MainThread]: Flushing usage events
[0m15:18:44.469789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105352a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053d4990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053d4fd0>]}


============================== 15:18:44.471435 | 256bbaf5-0e4f-4385-8291-6a7e51bdb5dd ==============================
[0m15:18:44.471435 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:18:44.471695 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:18:44.786674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '256bbaf5-0e4f-4385-8291-6a7e51bdb5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10484b190>]}
[0m15:18:44.805978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '256bbaf5-0e4f-4385-8291-6a7e51bdb5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103931310>]}
[0m15:18:44.806221 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:18:44.818158 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:18:44.908315 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:18:44.908687 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://macros/generate_topic_hierarchy.sql
[0m15:18:44.999368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '256bbaf5-0e4f-4385-8291-6a7e51bdb5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4c5750>]}
[0m15:18:45.039562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '256bbaf5-0e4f-4385-8291-6a7e51bdb5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea59a50>]}
[0m15:18:45.039785 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m15:18:45.039937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '256bbaf5-0e4f-4385-8291-6a7e51bdb5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bf3650>]}
[0m15:18:45.040748 [info ] [MainThread]: 
[0m15:18:45.040966 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:18:45.041327 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m15:18:45.041514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:45.439870 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m15:18:45.440869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:45.805642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '256bbaf5-0e4f-4385-8291-6a7e51bdb5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea0ce50>]}
[0m15:18:45.806694 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:18:45.807173 [info ] [MainThread]: 
[0m15:18:45.812440 [debug] [Thread-1 (]: Began running node model.curriculum_rec.wip
[0m15:18:45.813258 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_curriculum_rec.wip ............................. [RUN]
[0m15:18:45.813748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.wip)
[0m15:18:45.814079 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.wip
[0m15:18:45.821449 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.wip"
[0m15:18:45.822158 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.wip
[0m15:18:45.842559 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.wip"
[0m15:18:45.843058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:45.844185 [debug] [Thread-1 (]: On model.curriculum_rec.wip: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.wip"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`wip`
  OPTIONS()
  as SELECT * FROM WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = t_0868a6d7f4fe

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
-- SELECT * FROM hierarchy;
SELECT 
    id_topic,
    TO_JSON_STRING(
        STRUCT(
            id_topic,
            id_topic_parent,
            val_topic_level,
            cat_topic_title
        )
    ) AS hierarchy_json
FROM hierarchy;;


[0m15:18:46.251505 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:99ffe2a7-ea93-43f9-bb37-344f7a242752&page=queryresults
[0m15:18:46.253164 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword WITH at [6:20]; reason: invalidQuery, location: query, message: Syntax error: Unexpected keyword WITH at [6:20]')
[0m15:18:47.073121 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:9f242a76-b95b-4e83-9a03-b34b2aa8784b&page=queryresults
[0m15:18:47.074633 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:9f242a76-b95b-4e83-9a03-b34b2aa8784b&page=queryresults
[0m15:18:47.083380 [debug] [Thread-1 (]: Database Error in model wip (models/intermediate/education/wip.sql)
  Syntax error: Unexpected keyword WITH at [6:20]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m15:18:47.085334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '256bbaf5-0e4f-4385-8291-6a7e51bdb5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4a0490>]}
[0m15:18:47.086036 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_curriculum_rec.wip .................... [[31mERROR[0m in 1.27s]
[0m15:18:47.086566 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.wip
[0m15:18:47.088350 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:47.088614 [debug] [MainThread]: Connection 'model.curriculum_rec.wip' was properly closed.
[0m15:18:47.088875 [info ] [MainThread]: 
[0m15:18:47.089142 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.05 seconds (2.05s).
[0m15:18:47.089684 [debug] [MainThread]: Command end result
[0m15:18:47.116828 [info ] [MainThread]: 
[0m15:18:47.117111 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:18:47.117280 [info ] [MainThread]: 
[0m15:18:47.117472 [error] [MainThread]:   Database Error in model wip (models/intermediate/education/wip.sql)
  Syntax error: Unexpected keyword WITH at [6:20]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m15:18:47.117626 [info ] [MainThread]: 
[0m15:18:47.117785 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:18:47.118959 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.672982, "process_user_time": 1.225423, "process_kernel_time": 0.16971, "process_mem_max_rss": "214581248", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:18:47.119236 [debug] [MainThread]: Command `dbt run` failed at 15:18:47.119189 after 2.67 seconds
[0m15:18:47.119431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053d4690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053ac8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100eeccd0>]}
[0m15:18:47.119613 [debug] [MainThread]: Flushing usage events
[0m15:19:21.165720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10998b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10998bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a0d950>]}


============================== 15:19:21.167641 | 92ba2b26-91a1-467a-8007-7de7baddb04f ==============================
[0m15:19:21.167641 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:19:21.167917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'version_check': 'True', 'profiles_dir': '/Users/CalvinLii/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:19:21.476132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92ba2b26-91a1-467a-8007-7de7baddb04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11325e2d0>]}
[0m15:19:21.495290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92ba2b26-91a1-467a-8007-7de7baddb04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133b8d10>]}
[0m15:19:21.495533 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:19:21.506219 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:19:21.591168 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:19:21.591512 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://macros/generate_topic_hierarchy.sql
[0m15:19:21.682298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92ba2b26-91a1-467a-8007-7de7baddb04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133d0350>]}
[0m15:19:21.722026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92ba2b26-91a1-467a-8007-7de7baddb04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113637990>]}
[0m15:19:21.722242 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m15:19:21.722394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92ba2b26-91a1-467a-8007-7de7baddb04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135faa10>]}
[0m15:19:21.723177 [info ] [MainThread]: 
[0m15:19:21.723403 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:19:21.723764 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m15:19:21.723936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:22.050907 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m15:19:22.051576 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:19:22.400978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92ba2b26-91a1-467a-8007-7de7baddb04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136cb5d0>]}
[0m15:19:22.402439 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:19:22.402893 [info ] [MainThread]: 
[0m15:19:22.408682 [debug] [Thread-1 (]: Began running node model.curriculum_rec.wip
[0m15:19:22.409397 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_curriculum_rec.wip ............................. [RUN]
[0m15:19:22.409865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.wip)
[0m15:19:22.410175 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.wip
[0m15:19:22.417604 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.wip"
[0m15:19:22.418347 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.wip
[0m15:19:22.438262 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.wip"
[0m15:19:22.438683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:22.439881 [debug] [Thread-1 (]: On model.curriculum_rec.wip: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.wip"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`wip`
  OPTIONS()
  as SELECT * FROM WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = t_0868a6d7f4fe

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
-- SELECT * FROM hierarchy;
SELECT 
    id_topic,
    TO_JSON_STRING(
        STRUCT(
            id_topic,
            id_topic_parent,
            val_topic_level,
            cat_topic_title
        )
    ) AS hierarchy_json
FROM hierarchy;;


[0m15:19:22.784357 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:058b45db-78b1-46e5-b1d8-cd25b81007b9&page=queryresults
[0m15:19:22.786072 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword WITH at [6:20]; reason: invalidQuery, location: query, message: Syntax error: Unexpected keyword WITH at [6:20]')
[0m15:19:23.003475 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:f03de641-5eec-4b5c-9e1b-579761a3b5e1&page=queryresults
[0m15:19:23.005173 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:f03de641-5eec-4b5c-9e1b-579761a3b5e1&page=queryresults
[0m15:19:23.014361 [debug] [Thread-1 (]: Database Error in model wip (models/intermediate/education/wip.sql)
  Syntax error: Unexpected keyword WITH at [6:20]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m15:19:23.016071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92ba2b26-91a1-467a-8007-7de7baddb04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113358f10>]}
[0m15:19:23.016739 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_curriculum_rec.wip .................... [[31mERROR[0m in 0.61s]
[0m15:19:23.017277 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.wip
[0m15:19:23.019505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:19:23.019991 [debug] [MainThread]: Connection 'model.curriculum_rec.wip' was properly closed.
[0m15:19:23.020261 [info ] [MainThread]: 
[0m15:19:23.020535 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.30 seconds (1.30s).
[0m15:19:23.021054 [debug] [MainThread]: Command end result
[0m15:19:23.047006 [info ] [MainThread]: 
[0m15:19:23.047278 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:19:23.047450 [info ] [MainThread]: 
[0m15:19:23.047651 [error] [MainThread]:   Database Error in model wip (models/intermediate/education/wip.sql)
  Syntax error: Unexpected keyword WITH at [6:20]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m15:19:23.047804 [info ] [MainThread]: 
[0m15:19:23.047964 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:19:23.049223 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.9085721, "process_user_time": 1.21729, "process_kernel_time": 0.16165, "process_mem_max_rss": "210649088", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:19:23.049522 [debug] [MainThread]: Command `dbt run` failed at 15:19:23.049472 after 1.91 seconds
[0m15:19:23.049735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099e47d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a19690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f31dd0>]}
[0m15:19:23.049931 [debug] [MainThread]: Flushing usage events
[0m15:20:05.973476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cd7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d58a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d59090>]}


============================== 15:20:05.975471 | 3cc701ef-d055-43be-b11c-7d4be84bb826 ==============================
[0m15:20:05.975471 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:20:05.975758 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:20:06.280361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3cc701ef-d055-43be-b11c-7d4be84bb826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0b2350>]}
[0m15:20:06.299458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3cc701ef-d055-43be-b11c-7d4be84bb826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072bcf50>]}
[0m15:20:06.299710 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:20:06.310812 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:20:06.396249 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:20:06.396584 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://macros/generate_topic_hierarchy.sql
[0m15:20:06.486641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3cc701ef-d055-43be-b11c-7d4be84bb826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8a7650>]}
[0m15:20:06.526044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3cc701ef-d055-43be-b11c-7d4be84bb826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7c2d90>]}
[0m15:20:06.526255 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m15:20:06.526403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cc701ef-d055-43be-b11c-7d4be84bb826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e67a2d0>]}
[0m15:20:06.527175 [info ] [MainThread]: 
[0m15:20:06.527402 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:20:06.527763 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m15:20:06.527932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:06.937730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m15:20:06.938755 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:20:07.283432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cc701ef-d055-43be-b11c-7d4be84bb826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8145d0>]}
[0m15:20:07.284635 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:20:07.285716 [info ] [MainThread]: 
[0m15:20:07.290095 [debug] [Thread-1 (]: Began running node model.curriculum_rec.wip
[0m15:20:07.290618 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_curriculum_rec.wip ............................. [RUN]
[0m15:20:07.291073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.wip)
[0m15:20:07.291404 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.wip
[0m15:20:07.298613 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.wip"
[0m15:20:07.299307 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.wip
[0m15:20:07.319528 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.wip"
[0m15:20:07.319939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:07.320939 [debug] [Thread-1 (]: On model.curriculum_rec.wip: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.wip"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`wip`
  OPTIONS()
  as SELECT * FROM WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = t_0868a6d7f4fe

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
SELECT 
    id_topic,
    TO_JSON_STRING(
        STRUCT(
            id_topic,
            id_topic_parent,
            val_topic_level,
            cat_topic_title
        )
    ) AS hierarchy_json
FROM hierarchy;;


[0m15:20:07.665241 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:b919cf64-49a3-40a3-b4d5-48ec4ca7b040&page=queryresults
[0m15:20:07.666651 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword WITH at [6:20]; reason: invalidQuery, location: query, message: Syntax error: Unexpected keyword WITH at [6:20]')
[0m15:20:07.862876 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:55403811-9ce7-4068-be45-f4d28fe58356&page=queryresults
[0m15:20:07.864175 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:55403811-9ce7-4068-be45-f4d28fe58356&page=queryresults
[0m15:20:07.872684 [debug] [Thread-1 (]: Database Error in model wip (models/intermediate/education/wip.sql)
  Syntax error: Unexpected keyword WITH at [6:20]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m15:20:07.874323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cc701ef-d055-43be-b11c-7d4be84bb826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7e4f10>]}
[0m15:20:07.875027 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_curriculum_rec.wip .................... [[31mERROR[0m in 0.58s]
[0m15:20:07.875579 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.wip
[0m15:20:07.877294 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:07.877554 [debug] [MainThread]: Connection 'model.curriculum_rec.wip' was properly closed.
[0m15:20:07.877816 [info ] [MainThread]: 
[0m15:20:07.878085 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.35 seconds (1.35s).
[0m15:20:07.878597 [debug] [MainThread]: Command end result
[0m15:20:07.904444 [info ] [MainThread]: 
[0m15:20:07.904706 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:20:07.904876 [info ] [MainThread]: 
[0m15:20:07.905069 [error] [MainThread]:   Database Error in model wip (models/intermediate/education/wip.sql)
  Syntax error: Unexpected keyword WITH at [6:20]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m15:20:07.905222 [info ] [MainThread]: 
[0m15:20:07.905380 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:20:07.906567 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.9574615, "process_user_time": 1.214072, "process_kernel_time": 0.160316, "process_mem_max_rss": "212647936", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:20:07.906845 [debug] [MainThread]: Command `dbt run` failed at 15:20:07.906799 after 1.96 seconds
[0m15:20:07.907043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d2ac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d5b290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d351490>]}
[0m15:20:07.907241 [debug] [MainThread]: Flushing usage events
[0m15:21:29.845823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f3dd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc0c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc1290>]}


============================== 15:21:29.847576 | a9379a96-bebf-417c-810f-0a290741aad9 ==============================
[0m15:21:29.847576 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:21:29.847864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:21:30.152585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9379a96-bebf-417c-810f-0a290741aad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fd68d0>]}
[0m15:21:30.171685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9379a96-bebf-417c-810f-0a290741aad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7de9d0>]}
[0m15:21:30.171924 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:21:30.185096 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:21:30.272522 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:21:30.272838 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/intermediate/education/wip.sql
[0m15:21:30.360226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9379a96-bebf-417c-810f-0a290741aad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aac65d0>]}
[0m15:21:30.399682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9379a96-bebf-417c-810f-0a290741aad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aae5cd0>]}
[0m15:21:30.399897 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m15:21:30.400044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9379a96-bebf-417c-810f-0a290741aad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab1ed10>]}
[0m15:21:30.400822 [info ] [MainThread]: 
[0m15:21:30.401041 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:21:30.401411 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m15:21:30.401610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:30.772355 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m15:21:30.773164 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:31.223090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9379a96-bebf-417c-810f-0a290741aad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab2b450>]}
[0m15:21:31.224554 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:21:31.225321 [info ] [MainThread]: 
[0m15:21:31.228160 [debug] [Thread-1 (]: Began running node model.curriculum_rec.wip
[0m15:21:31.228829 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_curriculum_rec.wip ............................. [RUN]
[0m15:21:31.229385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.wip)
[0m15:21:31.229759 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.wip
[0m15:21:31.237259 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.wip"
[0m15:21:31.237911 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.wip
[0m15:21:31.259403 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.wip"
[0m15:21:31.259815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:31.260793 [debug] [Thread-1 (]: On model.curriculum_rec.wip: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.wip"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`wip`
  OPTIONS()
  as -- Assuming you have a table or a CTE named `topics` with an `id_topic` column
WITH topics AS (
    SELECT 't_0868a6d7f4fe' AS id_topic
    -- This could also be a more complex query that generates a list of topic IDs
)

SELECT
    topics.id_topic,
    WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = topics.id_topic

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
SELECT 
    id_topic,
    TO_JSON_STRING(
        STRUCT(
            id_topic,
            id_topic_parent,
            val_topic_level,
            cat_topic_title
        )
    ) AS hierarchy_json
FROM hierarchy; AS hierarchy_json
FROM topics;


[0m15:21:31.623870 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:48a47df0-b783-4e71-aaa5-9049639daa8e&page=queryresults
[0m15:21:31.625259 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got keyword WITH at [14:5]; reason: invalidQuery, location: query, message: Syntax error: Expected end of input but got keyword WITH at [14:5]')
[0m15:21:31.997301 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:4dac872a-3e26-41b6-8912-c487631ffc2b&page=queryresults
[0m15:21:31.998875 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:4dac872a-3e26-41b6-8912-c487631ffc2b&page=queryresults
[0m15:21:32.007685 [debug] [Thread-1 (]: Database Error in model wip (models/intermediate/education/wip.sql)
  Syntax error: Expected end of input but got keyword WITH at [14:5]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m15:21:32.009360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9379a96-bebf-417c-810f-0a290741aad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab28c10>]}
[0m15:21:32.010035 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_curriculum_rec.wip .................... [[31mERROR[0m in 0.78s]
[0m15:21:32.010579 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.wip
[0m15:21:32.012415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:21:32.012751 [debug] [MainThread]: Connection 'model.curriculum_rec.wip' was properly closed.
[0m15:21:32.013034 [info ] [MainThread]: 
[0m15:21:32.013312 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.61 seconds (1.61s).
[0m15:21:32.013809 [debug] [MainThread]: Command end result
[0m15:21:32.039514 [info ] [MainThread]: 
[0m15:21:32.039754 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:21:32.039911 [info ] [MainThread]: 
[0m15:21:32.040101 [error] [MainThread]:   Database Error in model wip (models/intermediate/education/wip.sql)
  Syntax error: Expected end of input but got keyword WITH at [14:5]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m15:21:32.040252 [info ] [MainThread]: 
[0m15:21:32.040406 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:21:32.041596 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.2203925, "process_user_time": 1.21643, "process_kernel_time": 0.166564, "process_mem_max_rss": "210173952", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:21:32.041876 [debug] [MainThread]: Command `dbt run` failed at 15:21:32.041830 after 2.22 seconds
[0m15:21:32.042079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f91650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f933d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad86110>]}
[0m15:21:32.042257 [debug] [MainThread]: Flushing usage events
[0m15:22:25.227314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107296a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107318dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107319410>]}


============================== 15:22:25.228989 | 937f0bde-188c-4832-9902-00fd666e5c67 ==============================
[0m15:22:25.228989 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:22:25.229254 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:22:25.534184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '937f0bde-188c-4832-9902-00fd666e5c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e6b810>]}
[0m15:22:25.554321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '937f0bde-188c-4832-9902-00fd666e5c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb369d0>]}
[0m15:22:25.554577 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:22:25.566246 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:22:25.655192 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:22:25.655563 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://macros/generate_topic_hierarchy.sql
[0m15:22:25.746053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '937f0bde-188c-4832-9902-00fd666e5c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb0eb50>]}
[0m15:22:25.786005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '937f0bde-188c-4832-9902-00fd666e5c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d14c4d0>]}
[0m15:22:25.786222 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m15:22:25.786371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '937f0bde-188c-4832-9902-00fd666e5c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10caf4fd0>]}
[0m15:22:25.787157 [info ] [MainThread]: 
[0m15:22:25.787375 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:22:25.787740 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m15:22:25.787939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:26.138832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m15:22:26.139534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:26.478809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '937f0bde-188c-4832-9902-00fd666e5c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d175dd0>]}
[0m15:22:26.479797 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:22:26.480261 [info ] [MainThread]: 
[0m15:22:26.485626 [debug] [Thread-1 (]: Began running node model.curriculum_rec.wip
[0m15:22:26.486504 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_curriculum_rec.wip ............................. [RUN]
[0m15:22:26.487066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.wip)
[0m15:22:26.487455 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.wip
[0m15:22:26.495066 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.wip"
[0m15:22:26.495970 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.wip
[0m15:22:26.516369 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.wip"
[0m15:22:26.516874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:26.517970 [debug] [Thread-1 (]: On model.curriculum_rec.wip: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.wip"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`wip`
  OPTIONS()
  as -- Assuming you have a table or a CTE named `topics` with an `id_topic` column
WITH topics AS (
    SELECT 't_0868a6d7f4fe' AS id_topic
    -- This could also be a more complex query that generates a list of topic IDs
)

SELECT
    topics.id_topic,
    WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = 'topics.id_topic'

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
SELECT 
    id_topic,
    TO_JSON_STRING(
        STRUCT(
            id_topic,
            id_topic_parent,
            val_topic_level,
            cat_topic_title
        )
    ) AS hierarchy_json
FROM hierarchy; AS hierarchy_json
FROM topics;


[0m15:22:26.867681 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:77244566-f534-4bc8-9690-a0228569c641&page=queryresults
[0m15:22:26.869446 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got keyword WITH at [14:5]; reason: invalidQuery, location: query, message: Syntax error: Expected end of input but got keyword WITH at [14:5]')
[0m15:22:27.542339 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:e1b686ef-1052-4e46-b7bf-41b514395928&page=queryresults
[0m15:22:27.544202 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:e1b686ef-1052-4e46-b7bf-41b514395928&page=queryresults
[0m15:22:27.552153 [debug] [Thread-1 (]: Database Error in model wip (models/intermediate/education/wip.sql)
  Syntax error: Expected end of input but got keyword WITH at [14:5]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m15:22:27.553861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '937f0bde-188c-4832-9902-00fd666e5c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfae450>]}
[0m15:22:27.554529 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_curriculum_rec.wip .................... [[31mERROR[0m in 1.07s]
[0m15:22:27.555074 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.wip
[0m15:22:27.556896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:27.557185 [debug] [MainThread]: Connection 'model.curriculum_rec.wip' was properly closed.
[0m15:22:27.557446 [info ] [MainThread]: 
[0m15:22:27.557694 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.77 seconds (1.77s).
[0m15:22:27.558187 [debug] [MainThread]: Command end result
[0m15:22:27.583638 [info ] [MainThread]: 
[0m15:22:27.583892 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:22:27.584048 [info ] [MainThread]: 
[0m15:22:27.584244 [error] [MainThread]:   Database Error in model wip (models/intermediate/education/wip.sql)
  Syntax error: Expected end of input but got keyword WITH at [14:5]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m15:22:27.584394 [info ] [MainThread]: 
[0m15:22:27.584554 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:22:27.585697 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.381933, "process_user_time": 1.220663, "process_kernel_time": 0.165966, "process_mem_max_rss": "212500480", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:27.585976 [debug] [MainThread]: Command `dbt run` failed at 15:22:27.585931 after 2.38 seconds
[0m15:22:27.586176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10732a890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107329a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e31590>]}
[0m15:22:27.586357 [debug] [MainThread]: Flushing usage events
[0m16:25:28.421740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d56510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dd89d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dd9010>]}


============================== 16:25:28.424264 | 17603dd7-5a1d-47ec-9069-26b9a2a2fc83 ==============================
[0m16:25:28.424264 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:25:28.424546 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:25:28.959972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17603dd7-5a1d-47ec-9069-26b9a2a2fc83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d86b90>]}
[0m16:25:28.979104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17603dd7-5a1d-47ec-9069-26b9a2a2fc83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f51310>]}
[0m16:25:28.979335 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m16:25:28.991274 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:25:29.094365 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:25:29.094727 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://macros/generate_topic_hierarchy.sql
[0m16:25:29.094879 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/intermediate/education/wip.sql
[0m16:25:29.189373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17603dd7-5a1d-47ec-9069-26b9a2a2fc83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081297d0>]}
[0m16:25:29.234367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17603dd7-5a1d-47ec-9069-26b9a2a2fc83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105df390>]}
[0m16:25:29.234590 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m16:25:29.234740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17603dd7-5a1d-47ec-9069-26b9a2a2fc83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11056de10>]}
[0m16:25:29.235531 [info ] [MainThread]: 
[0m16:25:29.235752 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:25:29.237383 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m16:25:29.237549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:29.643767 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m16:25:29.644611 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:25:29.988297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17603dd7-5a1d-47ec-9069-26b9a2a2fc83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111b2990>]}
[0m16:25:29.989509 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:25:29.990005 [info ] [MainThread]: 
[0m16:25:29.995825 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__content
[0m16:25:29.996552 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__content ............. [RUN]
[0m16:25:29.997017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.stg_kaggle__content)
[0m16:25:29.997349 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__content
[0m16:25:30.004509 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__content"
[0m16:25:30.005425 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__content
[0m16:25:30.025599 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__content"
[0m16:25:30.026082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:25:30.027186 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__content.sql
WITH raw_content AS 
(
SELECT 
    id as id_content, 
    title as cat_content_title, 
    description as cat_content_description, 
    kind as cat_content_kind,
    text as cat_content_text,
    copyright_holder as cat_content_copyright_holder,
    license as id_content_license 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_content`
) 

SELECT 
    * 
FROM raw_content;


[0m16:25:30.665518 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:1c5cbee6-4401-4a74-90a2-06f0d0f81672&page=queryresults
[0m16:25:31.151722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17603dd7-5a1d-47ec-9069-26b9a2a2fc83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11131f210>]}
[0m16:25:31.152523 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__content ........ [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m16:25:31.153060 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__content
[0m16:25:31.153433 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__correl
[0m16:25:31.153926 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__correl .............. [RUN]
[0m16:25:31.154371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__content, now model.curriculum_rec.stg_kaggle__correl)
[0m16:25:31.154667 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__correl
[0m16:25:31.157153 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__correl"
[0m16:25:31.158840 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__correl
[0m16:25:31.160740 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__correl"
[0m16:25:31.161213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:25:31.162505 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__correl: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__correl"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__correl.sql
WITH raw_correl AS 
(
    SELECT 
    topic_id as id_topic, 
    -- probably can do some sort of transformation here it should be a list not a string --  
    -- sql doesn't natively use lists though -- 
    -- have to make the table better don't use lists -- 
    content_id as id_content 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_correlation`
)

SELECT 
    * 
FROM raw_correl;


[0m16:25:31.791755 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:68a20cc2-c4a8-4594-9e54-47f570280592&page=queryresults
[0m16:25:32.206989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17603dd7-5a1d-47ec-9069-26b9a2a2fc83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111258510>]}
[0m16:25:32.208324 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__correl ......... [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m16:25:32.209125 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__correl
[0m16:25:32.209626 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__topic
[0m16:25:32.210430 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__topic ............... [RUN]
[0m16:25:32.211354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__correl, now model.curriculum_rec.stg_kaggle__topic)
[0m16:25:32.211824 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__topic
[0m16:25:32.215632 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__topic"
[0m16:25:32.216423 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__topic
[0m16:25:32.218870 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__topic"
[0m16:25:32.219444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:25:32.221048 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__topic: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__topic"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__topics.sql
WITH raw_topics AS 
(
SELECT  
    id as id_topic, 
    title as cat_topic_title, 
    description as cat_topic_description, 
    channel as id_topic_description, 
    -- already encoded don't need to use case when -- 
    category as cat_topic_category, 
    level as val_topic_level, 
    parent as id_topic_parent, 
    has_content as ind_topic_has_content
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_topic`
) 

SELECT 
    *
FROM raw_topics;


[0m16:25:33.123660 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:9223bd15-7eae-4a2a-9539-d52ab34ebe1f&page=queryresults
[0m16:25:33.620397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17603dd7-5a1d-47ec-9069-26b9a2a2fc83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11132d490>]}
[0m16:25:33.621678 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__topic .......... [[32mCREATE VIEW (0 processed)[0m in 1.41s]
[0m16:25:33.622359 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__topic
[0m16:25:33.623436 [debug] [Thread-1 (]: Began running node model.curriculum_rec.content
[0m16:25:33.624067 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_curriculum_rec.content ......................... [RUN]
[0m16:25:33.624467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__topic, now model.curriculum_rec.content)
[0m16:25:33.624751 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.content
[0m16:25:33.630532 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.content"
[0m16:25:33.631191 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.content
[0m16:25:33.633028 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.content"
[0m16:25:33.633496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:25:33.634847 [debug] [Thread-1 (]: On model.curriculum_rec.content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`content`
  OPTIONS()
  as -- WITH 
-- content AS (
--     SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
-- ),

-- correlation AS (
--     SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
-- ),

-- combined_content AS ( 
--     SELECT content.*, correlation.id_topic 
--     FROM content 
--     LEFT OUTER JOIN correlation ON content.id_content = correlation.id_content
-- ),
-- -- Generate hierarchical JSON data for each topic using the macro
-- hierarchy_data AS (
--     SELECT 
--         id_topic,
--         (SELECT ARRAY_AGG(STRUCT(
--             id_topic,
--             id_topic_parent,
--             val_topic_level,
--             cat_topic_title
--         )) 
--          FROM WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = 'combined_content.id_topic'

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)

SELECT 
    id_topic,
    TO_JSON_STRING(
        STRUCT(
            id_topic,
            id_topic_parent,
            val_topic_level,
            cat_topic_title
        )
    ) AS hierarchy_json
FROM hierarchy; 
--         ) AS hierarchy_data
--     FROM combined_content
--     GROUP BY id_topic
-- ),

-- -- Aggregate hierarchical data into JSON format
-- json_hierarchy AS (
--     SELECT 
--         id_topic,
--         JSON_AGG(
--             STRUCT(
--                 id_topic,
--                 hierarchy_data
--             )
--         ) AS topic_hierarchy
--     FROM hierarchy_data
--     GROUP BY id_topic
-- )

-- -- Select final output
-- SELECT * FROM json_hierarchy;;


[0m16:25:33.975765 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:739c9ca1-008a-4639-ac54-20a7321d05ec&page=queryresults
[0m16:25:33.977289 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got ")" at [40:1]; reason: invalidQuery, location: query, message: Syntax error: Expected end of input but got ")" at [40:1]')
[0m16:25:35.277047 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:325a3f93-2027-4ca6-8332-93b6d8870908&page=queryresults
[0m16:25:35.278927 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:325a3f93-2027-4ca6-8332-93b6d8870908&page=queryresults
[0m16:25:35.291125 [debug] [Thread-1 (]: Database Error in model content (models/marts/education/content.sql)
  Syntax error: Expected end of input but got ")" at [40:1]
  compiled Code at target/run/curriculum_rec/models/marts/education/content.sql
[0m16:25:35.291754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17603dd7-5a1d-47ec-9069-26b9a2a2fc83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11136f450>]}
[0m16:25:35.292457 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model dbt_curriculum_rec.content ................ [[31mERROR[0m in 1.67s]
[0m16:25:35.293011 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.content
[0m16:25:35.293394 [debug] [Thread-1 (]: Began running node model.curriculum_rec.wip
[0m16:25:35.294478 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt_curriculum_rec.wip ............................. [RUN]
[0m16:25:35.294908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.content, now model.curriculum_rec.wip)
[0m16:25:35.295187 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.wip
[0m16:25:35.301147 [debug] [Thread-1 (]: Compilation Error in model wip (models/intermediate/education/wip.sql)
  't' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:25:35.301428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17603dd7-5a1d-47ec-9069-26b9a2a2fc83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11131ccd0>]}
[0m16:25:35.301782 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model dbt_curriculum_rec.wip .................... [[31mERROR[0m in 0.01s]
[0m16:25:35.302147 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.wip
[0m16:25:35.302991 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:25:35.303182 [debug] [MainThread]: Connection 'model.curriculum_rec.wip' was properly closed.
[0m16:25:35.303426 [info ] [MainThread]: 
[0m16:25:35.303639 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 6.07 seconds (6.07s).
[0m16:25:35.304322 [debug] [MainThread]: Command end result
[0m16:25:35.327513 [info ] [MainThread]: 
[0m16:25:35.327754 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:25:35.327904 [info ] [MainThread]: 
[0m16:25:35.328089 [error] [MainThread]:   Database Error in model content (models/marts/education/content.sql)
  Syntax error: Expected end of input but got ")" at [40:1]
  compiled Code at target/run/curriculum_rec/models/marts/education/content.sql
[0m16:25:35.328229 [info ] [MainThread]: 
[0m16:25:35.328395 [error] [MainThread]:   Compilation Error in model wip (models/intermediate/education/wip.sql)
  't' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:25:35.328535 [info ] [MainThread]: 
[0m16:25:35.328683 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m16:25:35.330120 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.936839, "process_user_time": 1.4887, "process_kernel_time": 0.245611, "process_mem_max_rss": "214401024", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:25:35.330420 [debug] [MainThread]: Command `dbt run` failed at 16:25:35.330371 after 6.94 seconds
[0m16:25:35.330613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109da7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097ac8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105505410>]}
[0m16:25:35.330794 [debug] [MainThread]: Flushing usage events
[0m16:25:47.573639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e92a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f14ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f15110>]}


============================== 16:25:47.575328 | 5615b520-45f5-4a6c-b767-479be036d34b ==============================
[0m16:25:47.575328 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:25:47.575600 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'version_check': 'True', 'profiles_dir': '/Users/CalvinLii/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'send_anonymous_usage_stats': 'True'}
[0m16:25:47.875603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5615b520-45f5-4a6c-b767-479be036d34b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1ef550>]}
[0m16:25:47.894770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5615b520-45f5-4a6c-b767-479be036d34b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ed5f10>]}
[0m16:25:47.895023 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m16:25:47.905510 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:25:47.989451 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:25:47.989663 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:25:48.006645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5615b520-45f5-4a6c-b767-479be036d34b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c82350>]}
[0m16:25:48.047625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5615b520-45f5-4a6c-b767-479be036d34b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c861890>]}
[0m16:25:48.047841 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m16:25:48.047991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5615b520-45f5-4a6c-b767-479be036d34b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c77d810>]}
[0m16:25:48.048760 [info ] [MainThread]: 
[0m16:25:48.049005 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:25:48.049381 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m16:25:48.049564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:48.860133 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m16:25:48.860941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:25:49.185767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5615b520-45f5-4a6c-b767-479be036d34b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8ded90>]}
[0m16:25:49.186972 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:25:49.187459 [info ] [MainThread]: 
[0m16:25:49.192824 [debug] [Thread-1 (]: Began running node model.curriculum_rec.wip
[0m16:25:49.193717 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_curriculum_rec.wip ............................. [RUN]
[0m16:25:49.194260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.wip)
[0m16:25:49.194631 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.wip
[0m16:25:49.207959 [debug] [Thread-1 (]: Compilation Error in model wip (models/intermediate/education/wip.sql)
  't' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:25:49.208921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5615b520-45f5-4a6c-b767-479be036d34b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c924790>]}
[0m16:25:49.209366 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_curriculum_rec.wip .................... [[31mERROR[0m in 0.01s]
[0m16:25:49.209749 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.wip
[0m16:25:49.211183 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:25:49.211389 [debug] [MainThread]: Connection 'model.curriculum_rec.wip' was properly closed.
[0m16:25:49.211612 [info ] [MainThread]: 
[0m16:25:49.211833 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.16 seconds (1.16s).
[0m16:25:49.212205 [debug] [MainThread]: Command end result
[0m16:25:49.234602 [info ] [MainThread]: 
[0m16:25:49.234833 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:25:49.234983 [info ] [MainThread]: 
[0m16:25:49.235164 [error] [MainThread]:   Compilation Error in model wip (models/intermediate/education/wip.sql)
  't' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:25:49.235314 [info ] [MainThread]: 
[0m16:25:49.235458 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:25:49.236619 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.6871486, "process_user_time": 1.069564, "process_kernel_time": 0.147184, "process_mem_max_rss": "204324864", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:25:49.236884 [debug] [MainThread]: Command `dbt run` failed at 16:25:49.236840 after 1.69 seconds
[0m16:25:49.237066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ed4390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eec0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eec8d0>]}
[0m16:25:49.237237 [debug] [MainThread]: Flushing usage events
[0m09:33:26.466211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10784e890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a8990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078d16d0>]}


============================== 09:33:26.468666 | 700ecd85-e451-497a-8b7f-c814b0dd9f49 ==============================
[0m09:33:26.468666 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:33:26.468957 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/CalvinLii/.dbt', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:33:27.001412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '700ecd85-e451-497a-8b7f-c814b0dd9f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10becd7d0>]}
[0m09:33:27.021088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '700ecd85-e451-497a-8b7f-c814b0dd9f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0f8b90>]}
[0m09:33:27.021334 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m09:33:27.033606 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:33:27.136055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m09:33:27.136361 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/intermediate/education/wip.sql
[0m09:33:27.136546 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://macros/generate_topic_hierarchy.sql
[0m09:33:27.231226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '700ecd85-e451-497a-8b7f-c814b0dd9f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d102a90>]}
[0m09:33:27.275574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '700ecd85-e451-497a-8b7f-c814b0dd9f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3cc9d0>]}
[0m09:33:27.275788 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m09:33:27.275933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '700ecd85-e451-497a-8b7f-c814b0dd9f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d262850>]}
[0m09:33:27.276748 [info ] [MainThread]: 
[0m09:33:27.276975 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:33:27.278558 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m09:33:27.278728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:33:27.794420 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m09:33:27.795296 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:33:28.305137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '700ecd85-e451-497a-8b7f-c814b0dd9f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4c8d90>]}
[0m09:33:28.306199 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:33:28.306619 [info ] [MainThread]: 
[0m09:33:28.313176 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__content
[0m09:33:28.314029 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__content ............. [RUN]
[0m09:33:28.314635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.stg_kaggle__content)
[0m09:33:28.315031 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__content
[0m09:33:28.323026 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__content"
[0m09:33:28.324158 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__content
[0m09:33:28.345812 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__content"
[0m09:33:28.346382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:33:28.347459 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__content.sql
WITH raw_content AS 
(
SELECT 
    id as id_content, 
    title as cat_content_title, 
    description as cat_content_description, 
    kind as cat_content_kind,
    text as cat_content_text,
    copyright_holder as cat_content_copyright_holder,
    license as id_content_license 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_content`
) 

SELECT 
    * 
FROM raw_content;


[0m09:33:28.917946 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:8e271966-9f4b-454f-9c3f-750f989ff249&page=queryresults
[0m09:33:29.405465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '700ecd85-e451-497a-8b7f-c814b0dd9f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d48b5d0>]}
[0m09:33:29.406149 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__content ........ [[32mCREATE VIEW (0 processed)[0m in 1.09s]
[0m09:33:29.406614 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__content
[0m09:33:29.406917 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__correl
[0m09:33:29.407332 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__correl .............. [RUN]
[0m09:33:29.407705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__content, now model.curriculum_rec.stg_kaggle__correl)
[0m09:33:29.407960 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__correl
[0m09:33:29.410340 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__correl"
[0m09:33:29.410889 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__correl
[0m09:33:29.412478 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__correl"
[0m09:33:29.412886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:33:29.413978 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__correl: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__correl"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__correl.sql
WITH raw_correl AS 
(
    SELECT 
    topic_id as id_topic, 
    -- probably can do some sort of transformation here it should be a list not a string --  
    -- sql doesn't natively use lists though -- 
    -- have to make the table better don't use lists -- 
    content_id as id_content 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_correlation`
)

SELECT 
    * 
FROM raw_correl;


[0m09:33:30.149219 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:32388d01-9fca-48f4-a9cb-85d2b6d76f0e&page=queryresults
[0m09:33:30.473512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '700ecd85-e451-497a-8b7f-c814b0dd9f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d583f50>]}
[0m09:33:30.474697 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__correl ......... [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m09:33:30.475216 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__correl
[0m09:33:30.475589 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__topic
[0m09:33:30.476085 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__topic ............... [RUN]
[0m09:33:30.476538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__correl, now model.curriculum_rec.stg_kaggle__topic)
[0m09:33:30.476835 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__topic
[0m09:33:30.479592 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__topic"
[0m09:33:30.480223 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__topic
[0m09:33:30.482048 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__topic"
[0m09:33:30.482486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:33:30.483707 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__topic: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__topic"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__topics.sql
WITH raw_topics AS 
(
SELECT  
    id as id_topic, 
    title as cat_topic_title, 
    description as cat_topic_description, 
    channel as id_topic_description, 
    -- already encoded don't need to use case when -- 
    category as cat_topic_category, 
    level as val_topic_level, 
    parent as id_topic_parent, 
    has_content as ind_topic_has_content
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_topic`
) 

SELECT 
    *
FROM raw_topics;


[0m09:33:31.068115 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:617e2d75-a167-464b-8770-40dd08cc207f&page=queryresults
[0m09:33:31.547725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '700ecd85-e451-497a-8b7f-c814b0dd9f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d573110>]}
[0m09:33:31.548726 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__topic .......... [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m09:33:31.549366 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__topic
[0m09:33:31.550363 [debug] [Thread-1 (]: Began running node model.curriculum_rec.content
[0m09:33:31.550881 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_curriculum_rec.content ......................... [RUN]
[0m09:33:31.551281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__topic, now model.curriculum_rec.content)
[0m09:33:31.551582 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.content
[0m09:33:31.557875 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.content"
[0m09:33:31.558657 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.content
[0m09:33:31.560731 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.content"
[0m09:33:31.561279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:33:31.562737 [debug] [Thread-1 (]: On model.curriculum_rec.content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`content`
  OPTIONS()
  as -- WITH 
-- content AS (
--     SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
-- ),

-- correlation AS (
--     SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
-- ),

-- combined_content AS ( 
--     SELECT content.*, correlation.id_topic 
--     FROM content 
--     LEFT OUTER JOIN correlation ON content.id_content = correlation.id_content
-- ),
-- -- Generate hierarchical JSON data for each topic using the macro
-- hierarchy_data AS (
--     SELECT 
--         id_topic,
--         (SELECT ARRAY_AGG(STRUCT(
--             id_topic,
--             id_topic_parent,
--             val_topic_level,
--             cat_topic_title
--         )) 
--          FROM WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = 'combined_content.id_topic'

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)

-- SELECT 
--     id_topic,
--     TO_JSON_STRING(
--         STRUCT(
--             id_topic,
--             id_topic_parent,
--             val_topic_level,
--             cat_topic_title
--         )
--     ) AS hierarchy_json
-- FROM hierarchy; 
--         ) AS hierarchy_data
--     FROM combined_content
--     GROUP BY id_topic
-- ),

-- -- Aggregate hierarchical data into JSON format
-- json_hierarchy AS (
--     SELECT 
--         id_topic,
--         JSON_AGG(
--             STRUCT(
--                 id_topic,
--                 hierarchy_data
--             )
--         ) AS topic_hierarchy
--     FROM hierarchy_data
--     GROUP BY id_topic
-- )

-- -- Select final output
-- SELECT * FROM json_hierarchy;;


[0m09:33:31.990358 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:9a5bdcdf-9412-44c9-b935-e6d64922acb2&page=queryresults
[0m09:33:31.992293 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got ")" at [40:1]; reason: invalidQuery, location: query, message: Syntax error: Expected end of input but got ")" at [40:1]')
[0m09:33:32.424014 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:3a632e68-4244-4a9f-af02-6cbca87d94b8&page=queryresults
[0m09:33:32.425448 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:3a632e68-4244-4a9f-af02-6cbca87d94b8&page=queryresults
[0m09:33:32.438798 [debug] [Thread-1 (]: Database Error in model content (models/marts/education/content.sql)
  Syntax error: Expected end of input but got ")" at [40:1]
  compiled Code at target/run/curriculum_rec/models/marts/education/content.sql
[0m09:33:32.439445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '700ecd85-e451-497a-8b7f-c814b0dd9f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5e87d0>]}
[0m09:33:32.440122 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model dbt_curriculum_rec.content ................ [[31mERROR[0m in 0.89s]
[0m09:33:32.440647 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.content
[0m09:33:32.441025 [debug] [Thread-1 (]: Began running node model.curriculum_rec.wip
[0m09:33:32.442195 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt_curriculum_rec.wip ............................. [RUN]
[0m09:33:32.442623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.content, now model.curriculum_rec.wip)
[0m09:33:32.442912 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.wip
[0m09:33:32.448830 [debug] [Thread-1 (]: Compilation Error in model wip (models/intermediate/education/wip.sql)
  't' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:33:32.449098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '700ecd85-e451-497a-8b7f-c814b0dd9f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d580c50>]}
[0m09:33:32.449445 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model dbt_curriculum_rec.wip .................... [[31mERROR[0m in 0.01s]
[0m09:33:32.449750 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.wip
[0m09:33:32.450592 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:33:32.450771 [debug] [MainThread]: Connection 'model.curriculum_rec.wip' was properly closed.
[0m09:33:32.451014 [info ] [MainThread]: 
[0m09:33:32.451216 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.17 seconds (5.17s).
[0m09:33:32.451889 [debug] [MainThread]: Command end result
[0m09:33:32.475033 [info ] [MainThread]: 
[0m09:33:32.475271 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m09:33:32.475422 [info ] [MainThread]: 
[0m09:33:32.475602 [error] [MainThread]:   Database Error in model content (models/marts/education/content.sql)
  Syntax error: Expected end of input but got ")" at [40:1]
  compiled Code at target/run/curriculum_rec/models/marts/education/content.sql
[0m09:33:32.475748 [info ] [MainThread]: 
[0m09:33:32.475911 [error] [MainThread]:   Compilation Error in model wip (models/intermediate/education/wip.sql)
  't' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:33:32.476053 [info ] [MainThread]: 
[0m09:33:32.476202 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m09:33:32.477555 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.039862, "process_user_time": 1.465244, "process_kernel_time": 0.239865, "process_mem_max_rss": "211058688", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:33:32.477817 [debug] [MainThread]: Command `dbt run` failed at 09:33:32.477774 after 6.04 seconds
[0m09:33:32.478002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a88d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033e9650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033e9510>]}
[0m09:33:32.478170 [debug] [MainThread]: Flushing usage events
[0m09:35:13.867620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f036d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f5c990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f85510>]}


============================== 09:35:13.869271 | 64ce96cf-b272-45f2-b45a-43af402669d7 ==============================
[0m09:35:13.869271 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:35:13.869550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'send_anonymous_usage_stats': 'True'}
[0m09:35:14.172895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64ce96cf-b272-45f2-b45a-43af402669d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e703450>]}
[0m09:35:14.191927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64ce96cf-b272-45f2-b45a-43af402669d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e14d0>]}
[0m09:35:14.192160 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m09:35:14.202805 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:35:14.287990 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m09:35:14.288287 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/intermediate/education/wip.sql
[0m09:35:14.288479 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://macros/generate_topic_hierarchy.sql
[0m09:35:14.289593 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two macros named "generate_topic_hierarchy" in the project
  "curriculum_rec".
   To fix this error, rename or remove one of the following macros:
      - macros/generate_topic_hierarchy.sql
      - macros/generate_topic_hierarchy.sql
[0m09:35:14.290565 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.4471211, "process_user_time": 0.851133, "process_kernel_time": 0.138629, "process_mem_max_rss": "201785344", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:35:14.290800 [debug] [MainThread]: Command `dbt run` failed at 09:35:14.290763 after 0.45 seconds
[0m09:35:14.290962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f5c8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cce3c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a9d590>]}
[0m09:35:14.291109 [debug] [MainThread]: Flushing usage events
[0m09:37:13.194599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105057790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050a9590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050d90d0>]}


============================== 09:37:13.196319 | a3252f72-dd5c-492b-b89e-41163bcdf611 ==============================
[0m09:37:13.196319 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:37:13.196601 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:37:13.503295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3252f72-dd5c-492b-b89e-41163bcdf611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c1fed0>]}
[0m09:37:13.522272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3252f72-dd5c-492b-b89e-41163bcdf611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10363d190>]}
[0m09:37:13.522511 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m09:37:13.533348 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:37:13.618415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m09:37:13.618755 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://macros/generate_topic_hierarchy.sql
[0m09:37:13.618903 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/intermediate/education/wip.sql
[0m09:37:13.709683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3252f72-dd5c-492b-b89e-41163bcdf611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037dc290>]}
[0m09:37:13.749230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3252f72-dd5c-492b-b89e-41163bcdf611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9fae90>]}
[0m09:37:13.749440 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m09:37:13.749583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3252f72-dd5c-492b-b89e-41163bcdf611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa69610>]}
[0m09:37:13.750339 [info ] [MainThread]: 
[0m09:37:13.750566 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:37:13.750947 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m09:37:13.751122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:37:14.208342 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m09:37:14.209233 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:37:14.545291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3252f72-dd5c-492b-b89e-41163bcdf611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac27710>]}
[0m09:37:14.546410 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:37:14.546850 [info ] [MainThread]: 
[0m09:37:14.552465 [debug] [Thread-1 (]: Began running node model.curriculum_rec.wip
[0m09:37:14.553305 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_curriculum_rec.wip ............................. [RUN]
[0m09:37:14.553821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.wip)
[0m09:37:14.554147 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.wip
[0m09:37:14.564582 [debug] [Thread-1 (]: Compilation Error in model wip (models/intermediate/education/wip.sql)
  't' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:37:14.565726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3252f72-dd5c-492b-b89e-41163bcdf611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac4c8d0>]}
[0m09:37:14.566216 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_curriculum_rec.wip .................... [[31mERROR[0m in 0.01s]
[0m09:37:14.566645 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.wip
[0m09:37:14.568176 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:37:14.568426 [debug] [MainThread]: Connection 'model.curriculum_rec.wip' was properly closed.
[0m09:37:14.568643 [info ] [MainThread]: 
[0m09:37:14.568858 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m09:37:14.569230 [debug] [MainThread]: Command end result
[0m09:37:14.592049 [info ] [MainThread]: 
[0m09:37:14.592288 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:37:14.592440 [info ] [MainThread]: 
[0m09:37:14.592618 [error] [MainThread]:   Compilation Error in model wip (models/intermediate/education/wip.sql)
  't' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:37:14.592762 [info ] [MainThread]: 
[0m09:37:14.592907 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:37:14.594036 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4238284, "process_user_time": 1.132613, "process_kernel_time": 0.159356, "process_mem_max_rss": "209354752", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:37:14.594306 [debug] [MainThread]: Command `dbt run` failed at 09:37:14.594262 after 1.42 seconds
[0m09:37:14.594486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050ea050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050d8990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8ccd90>]}
[0m09:37:14.594660 [debug] [MainThread]: Flushing usage events
[0m09:38:50.401064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c5ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cdcc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cdd2d0>]}


============================== 09:38:50.402748 | 5eb52dd8-a9af-4a86-9ca8-624a31b24032 ==============================
[0m09:38:50.402748 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:38:50.403025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:38:50.708624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5eb52dd8-a9af-4a86-9ca8-624a31b24032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cdd5d0>]}
[0m09:38:50.728628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5eb52dd8-a9af-4a86-9ca8-624a31b24032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107244b90>]}
[0m09:38:50.728881 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m09:38:50.740524 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:38:50.827398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:38:50.827706 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/intermediate/education/wip.sql
[0m09:38:50.915612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5eb52dd8-a9af-4a86-9ca8-624a31b24032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074193d0>]}
[0m09:38:50.955266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5eb52dd8-a9af-4a86-9ca8-624a31b24032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e868810>]}
[0m09:38:50.955484 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m09:38:50.955635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5eb52dd8-a9af-4a86-9ca8-624a31b24032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e66d950>]}
[0m09:38:50.956420 [info ] [MainThread]: 
[0m09:38:50.956645 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:38:50.957006 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m09:38:50.957185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:38:51.387316 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m09:38:51.388468 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:38:51.741189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5eb52dd8-a9af-4a86-9ca8-624a31b24032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e838390>]}
[0m09:38:51.742398 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:38:51.742996 [info ] [MainThread]: 
[0m09:38:51.746549 [debug] [Thread-1 (]: Began running node model.curriculum_rec.wip
[0m09:38:51.747424 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_curriculum_rec.wip ............................. [RUN]
[0m09:38:51.747997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.wip)
[0m09:38:51.748371 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.wip
[0m09:38:51.756137 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.wip"
[0m09:38:51.756940 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.wip
[0m09:38:51.778479 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.wip"
[0m09:38:51.778927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:38:51.780098 [debug] [Thread-1 (]: On model.curriculum_rec.wip: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.wip"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`wip`
  OPTIONS()
  as SELECT
    id_topic,
    
WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = 'id_topic'

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
 AS hierarchy_json
FROM stg_kaggle__correl;


[0m09:38:52.203283 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:ae5d57d2-1398-45f8-bdf4-fdf855591ff4&page=queryresults
[0m09:38:52.205216 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got keyword WITH at [9:1]; reason: invalidQuery, location: query, message: Syntax error: Expected end of input but got keyword WITH at [9:1]')
[0m09:38:52.650342 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:725040e5-9ffd-4f9b-bfd6-f8775911a407&page=queryresults
[0m09:38:52.652214 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:725040e5-9ffd-4f9b-bfd6-f8775911a407&page=queryresults
[0m09:38:52.660150 [debug] [Thread-1 (]: Database Error in model wip (models/intermediate/education/wip.sql)
  Syntax error: Expected end of input but got keyword WITH at [9:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m09:38:52.661873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5eb52dd8-a9af-4a86-9ca8-624a31b24032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e838bd0>]}
[0m09:38:52.662559 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_curriculum_rec.wip .................... [[31mERROR[0m in 0.91s]
[0m09:38:52.663048 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.wip
[0m09:38:52.664692 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:38:52.664985 [debug] [MainThread]: Connection 'model.curriculum_rec.wip' was properly closed.
[0m09:38:52.665243 [info ] [MainThread]: 
[0m09:38:52.665491 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.71 seconds (1.71s).
[0m09:38:52.665962 [debug] [MainThread]: Command end result
[0m09:38:52.692188 [info ] [MainThread]: 
[0m09:38:52.692495 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:38:52.692655 [info ] [MainThread]: 
[0m09:38:52.692857 [error] [MainThread]:   Database Error in model wip (models/intermediate/education/wip.sql)
  Syntax error: Expected end of input but got keyword WITH at [9:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m09:38:52.693027 [info ] [MainThread]: 
[0m09:38:52.693206 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:38:52.694542 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.3176854, "process_user_time": 1.211684, "process_kernel_time": 0.162191, "process_mem_max_rss": "210796544", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:38:52.694829 [debug] [MainThread]: Command `dbt run` failed at 09:38:52.694774 after 2.32 seconds
[0m09:38:52.695030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c9c390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088748d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047f56d0>]}
[0m09:38:52.695220 [debug] [MainThread]: Flushing usage events
[0m09:40:27.775934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078570d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078d8a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078d90d0>]}


============================== 09:40:27.777675 | 018e067a-e24d-43f4-af55-7918ea882fd9 ==============================
[0m09:40:27.777675 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:40:27.777957 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:40:28.100476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '018e067a-e24d-43f4-af55-7918ea882fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127793d0>]}
[0m09:40:28.120923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '018e067a-e24d-43f4-af55-7918ea882fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11676e150>]}
[0m09:40:28.121319 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m09:40:28.133886 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:40:28.223309 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:40:28.223696 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://macros/generate_topic_hierarchy.sql
[0m09:40:28.314477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '018e067a-e24d-43f4-af55-7918ea882fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1168cd290>]}
[0m09:40:28.354448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '018e067a-e24d-43f4-af55-7918ea882fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116a00850>]}
[0m09:40:28.354656 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m09:40:28.354807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '018e067a-e24d-43f4-af55-7918ea882fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116a1f850>]}
[0m09:40:28.355546 [info ] [MainThread]: 
[0m09:40:28.355768 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:40:28.356112 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m09:40:28.356293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:40:28.721843 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m09:40:28.722820 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:40:29.101490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '018e067a-e24d-43f4-af55-7918ea882fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1168bbed0>]}
[0m09:40:29.102465 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:40:29.102998 [info ] [MainThread]: 
[0m09:40:29.107806 [debug] [Thread-1 (]: Began running node model.curriculum_rec.wip
[0m09:40:29.108318 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_curriculum_rec.wip ............................. [RUN]
[0m09:40:29.108715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.wip)
[0m09:40:29.108977 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.wip
[0m09:40:29.115044 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.wip"
[0m09:40:29.115752 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.wip
[0m09:40:29.138388 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.wip"
[0m09:40:29.138996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:40:29.140511 [debug] [Thread-1 (]: On model.curriculum_rec.wip: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.wip"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`wip`
  OPTIONS()
  as SELECT
    id_topic,
    
WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = 'id_topic'

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
SELECT 
    TO_JSON_STRING(
        ARRAY_AGG(
            STRUCT(
                id_topic,
                id_topic_parent,
                val_topic_level,
                cat_topic_title
            )
        )
    ) AS hierarchy_json
FROM hierarchy
 AS hierarchy_json
FROM stg_kaggle__correl;


[0m09:40:29.463121 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:8e4053d1-40ad-434e-8a8c-bde9c53cc8f1&page=queryresults
[0m09:40:29.464506 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got keyword WITH at [9:1]; reason: invalidQuery, location: query, message: Syntax error: Expected end of input but got keyword WITH at [9:1]')
[0m09:40:30.094781 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:9170d33f-89ca-4671-87a2-1495c7ee178f&page=queryresults
[0m09:40:30.096325 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:9170d33f-89ca-4671-87a2-1495c7ee178f&page=queryresults
[0m09:40:30.104223 [debug] [Thread-1 (]: Database Error in model wip (models/intermediate/education/wip.sql)
  Syntax error: Expected end of input but got keyword WITH at [9:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m09:40:30.105197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '018e067a-e24d-43f4-af55-7918ea882fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116beac50>]}
[0m09:40:30.105621 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_curriculum_rec.wip .................... [[31mERROR[0m in 1.00s]
[0m09:40:30.105912 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.wip
[0m09:40:30.106894 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:40:30.107035 [debug] [MainThread]: Connection 'model.curriculum_rec.wip' was properly closed.
[0m09:40:30.107174 [info ] [MainThread]: 
[0m09:40:30.107372 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.75 seconds (1.75s).
[0m09:40:30.107931 [debug] [MainThread]: Command end result
[0m09:40:30.135246 [info ] [MainThread]: 
[0m09:40:30.135505 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:40:30.135688 [info ] [MainThread]: 
[0m09:40:30.135917 [error] [MainThread]:   Database Error in model wip (models/intermediate/education/wip.sql)
  Syntax error: Expected end of input but got keyword WITH at [9:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m09:40:30.136081 [info ] [MainThread]: 
[0m09:40:30.136260 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:40:30.137506 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.3859794, "process_user_time": 1.249508, "process_kernel_time": 0.173491, "process_mem_max_rss": "213762048", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:40:30.137782 [debug] [MainThread]: Command `dbt run` failed at 09:40:30.137737 after 2.39 seconds
[0m09:40:30.137974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e716d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e71490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e715d0>]}
[0m09:40:30.138156 [debug] [MainThread]: Flushing usage events
[0m09:44:40.159732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091562d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091d8790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091d8dd0>]}


============================== 09:44:40.161432 | dc7b417e-56c7-40ee-b7b3-9b25209ed2ca ==============================
[0m09:44:40.161432 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:44:40.161722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'send_anonymous_usage_stats': 'True'}
[0m09:44:40.467853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc7b417e-56c7-40ee-b7b3-9b25209ed2ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aefdbd0>]}
[0m09:44:40.487034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc7b417e-56c7-40ee-b7b3-9b25209ed2ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107639150>]}
[0m09:44:40.487269 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m09:44:40.498497 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:44:40.583991 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:44:40.584300 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/intermediate/education/wip.sql
[0m09:44:40.672190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc7b417e-56c7-40ee-b7b3-9b25209ed2ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbc2350>]}
[0m09:44:40.714825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc7b417e-56c7-40ee-b7b3-9b25209ed2ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbe17d0>]}
[0m09:44:40.715057 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m09:44:40.715210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc7b417e-56c7-40ee-b7b3-9b25209ed2ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe46410>]}
[0m09:44:40.716010 [info ] [MainThread]: 
[0m09:44:40.716240 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:44:40.716615 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m09:44:40.716798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:44:41.066245 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m09:44:41.066900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:41.393795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc7b417e-56c7-40ee-b7b3-9b25209ed2ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb91210>]}
[0m09:44:41.394701 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:44:41.395541 [info ] [MainThread]: 
[0m09:44:41.398689 [debug] [Thread-1 (]: Began running node model.curriculum_rec.wip
[0m09:44:41.399436 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_curriculum_rec.wip ............................. [RUN]
[0m09:44:41.399905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.wip)
[0m09:44:41.400225 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.wip
[0m09:44:41.407718 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.wip"
[0m09:44:41.408527 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.wip
[0m09:44:41.429740 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.wip"
[0m09:44:41.430153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:41.431274 [debug] [Thread-1 (]: On model.curriculum_rec.wip: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.wip"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`wip`
  OPTIONS()
  as SELECT
    id_topic,
    
WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = ''

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
SELECT 
    TO_JSON_STRING(
        ARRAY_AGG(
            STRUCT(
                id_topic,
                id_topic_parent,
                val_topic_level,
                cat_topic_title
            )
        )
    ) AS hierarchy_json
FROM hierarchy
 AS hierarchy_json
FROM stg_kaggle__correl;


[0m09:44:41.901346 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:280b7a6a-f465-4975-9d6c-87356d236e57&page=queryresults
[0m09:44:41.902692 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got keyword WITH at [9:1]; reason: invalidQuery, location: query, message: Syntax error: Expected end of input but got keyword WITH at [9:1]')
[0m09:44:42.625221 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:6887b347-a99e-4a5f-8c21-acc7b74b60d3&page=queryresults
[0m09:44:42.626424 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:6887b347-a99e-4a5f-8c21-acc7b74b60d3&page=queryresults
[0m09:44:42.635095 [debug] [Thread-1 (]: Database Error in model wip (models/intermediate/education/wip.sql)
  Syntax error: Expected end of input but got keyword WITH at [9:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m09:44:42.637079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc7b417e-56c7-40ee-b7b3-9b25209ed2ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe79f50>]}
[0m09:44:42.637766 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_curriculum_rec.wip .................... [[31mERROR[0m in 1.24s]
[0m09:44:42.638385 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.wip
[0m09:44:42.640316 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:44:42.640658 [debug] [MainThread]: Connection 'model.curriculum_rec.wip' was properly closed.
[0m09:44:42.640954 [info ] [MainThread]: 
[0m09:44:42.641240 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.92 seconds (1.92s).
[0m09:44:42.641825 [debug] [MainThread]: Command end result
[0m09:44:42.669325 [info ] [MainThread]: 
[0m09:44:42.669639 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:44:42.669817 [info ] [MainThread]: 
[0m09:44:42.670020 [error] [MainThread]:   Database Error in model wip (models/intermediate/education/wip.sql)
  Syntax error: Expected end of input but got keyword WITH at [9:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m09:44:42.670184 [info ] [MainThread]: 
[0m09:44:42.670350 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:44:42.671667 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.5368838, "process_user_time": 1.208134, "process_kernel_time": 0.164693, "process_mem_max_rss": "210255872", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:44:42.672064 [debug] [MainThread]: Command `dbt run` failed at 09:44:42.671996 after 2.54 seconds
[0m09:44:42.672291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c6c8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091d8b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bed6d0>]}
[0m09:44:42.672501 [debug] [MainThread]: Flushing usage events
[0m09:45:57.930068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ff150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107880dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107851b50>]}


============================== 09:45:57.931760 | 30d143a6-de64-46c7-877e-042ff8f9b1a6 ==============================
[0m09:45:57.931760 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:45:57.932025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'debug': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:45:58.237586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30d143a6-de64-46c7-877e-042ff8f9b1a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfd9450>]}
[0m09:45:58.256665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30d143a6-de64-46c7-877e-042ff8f9b1a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de5810>]}
[0m09:45:58.256922 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m09:45:58.267762 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:45:58.352982 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:45:58.353276 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/intermediate/education/wip.sql
[0m09:45:58.440832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30d143a6-de64-46c7-877e-042ff8f9b1a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0bc390>]}
[0m09:45:58.480738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30d143a6-de64-46c7-877e-042ff8f9b1a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3a4090>]}
[0m09:45:58.480954 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m09:45:58.481101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30d143a6-de64-46c7-877e-042ff8f9b1a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3f1c90>]}
[0m09:45:58.481884 [info ] [MainThread]: 
[0m09:45:58.482100 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:45:58.482494 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m09:45:58.482687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:45:58.842409 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m09:45:58.843489 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:45:59.190393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30d143a6-de64-46c7-877e-042ff8f9b1a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3e74d0>]}
[0m09:45:59.191510 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:45:59.191978 [info ] [MainThread]: 
[0m09:45:59.195557 [debug] [Thread-1 (]: Began running node model.curriculum_rec.wip
[0m09:45:59.196399 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_curriculum_rec.wip ............................. [RUN]
[0m09:45:59.196961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.wip)
[0m09:45:59.197345 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.wip
[0m09:45:59.204888 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.wip"
[0m09:45:59.205614 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.wip
[0m09:45:59.227101 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.wip"
[0m09:45:59.227535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:45:59.228608 [debug] [Thread-1 (]: On model.curriculum_rec.wip: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.wip"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`wip`
  OPTIONS()
  as SELECT
    id_topic,
    
WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = ''

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
SELECT 
    TO_JSON_STRING(
        ARRAY_AGG(
            STRUCT(
                id_topic,
                id_topic_parent,
                val_topic_level,
                cat_topic_title
            )
        )
    ) AS hierarchy_json
FROM hierarchy
 
FROM stg_kaggle__correl;


[0m09:45:59.727310 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:c7eb2021-6e50-466f-96e7-4d308df24b4e&page=queryresults
[0m09:45:59.728999 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got keyword WITH at [9:1]; reason: invalidQuery, location: query, message: Syntax error: Expected end of input but got keyword WITH at [9:1]')
[0m09:46:00.437782 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:895621b8-1917-417f-9189-db17f95d7a25&page=queryresults
[0m09:46:00.439478 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:895621b8-1917-417f-9189-db17f95d7a25&page=queryresults
[0m09:46:00.447506 [debug] [Thread-1 (]: Database Error in model wip (models/intermediate/education/wip.sql)
  Syntax error: Expected end of input but got keyword WITH at [9:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m09:46:00.449335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30d143a6-de64-46c7-877e-042ff8f9b1a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d48d290>]}
[0m09:46:00.450006 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_curriculum_rec.wip .................... [[31mERROR[0m in 1.25s]
[0m09:46:00.450561 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.wip
[0m09:46:00.452322 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:46:00.452577 [debug] [MainThread]: Connection 'model.curriculum_rec.wip' was properly closed.
[0m09:46:00.452832 [info ] [MainThread]: 
[0m09:46:00.453097 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.97 seconds (1.97s).
[0m09:46:00.453618 [debug] [MainThread]: Command end result
[0m09:46:00.479660 [info ] [MainThread]: 
[0m09:46:00.479940 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:46:00.480123 [info ] [MainThread]: 
[0m09:46:00.480352 [error] [MainThread]:   Database Error in model wip (models/intermediate/education/wip.sql)
  Syntax error: Expected end of input but got keyword WITH at [9:1]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m09:46:00.480509 [info ] [MainThread]: 
[0m09:46:00.480667 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:46:00.481843 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.5755541, "process_user_time": 1.215952, "process_kernel_time": 0.157866, "process_mem_max_rss": "209698816", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:46:00.482127 [debug] [MainThread]: Command `dbt run` failed at 09:46:00.482079 after 2.58 seconds
[0m09:46:00.482326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107881210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078588d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103399490>]}
[0m09:46:00.482510 [debug] [MainThread]: Flushing usage events
[0m09:47:36.315889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e92a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f14b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f15190>]}


============================== 09:47:36.317719 | 66368fe8-d620-4fef-8d28-b6abb67ee55c ==============================
[0m09:47:36.317719 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:47:36.318015 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'profiles_dir': '/Users/CalvinLii/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:47:36.626582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66368fe8-d620-4fef-8d28-b6abb67ee55c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ec2f90>]}
[0m09:47:36.645802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66368fe8-d620-4fef-8d28-b6abb67ee55c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037c9550>]}
[0m09:47:36.646040 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m09:47:36.656959 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:47:36.747909 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m09:47:36.748244 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/intermediate/education/wip.sql
[0m09:47:36.748438 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://macros/generate_topic_hierarchy.sql
[0m09:47:36.843031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66368fe8-d620-4fef-8d28-b6abb67ee55c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb75790>]}
[0m09:47:36.883743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66368fe8-d620-4fef-8d28-b6abb67ee55c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cffac90>]}
[0m09:47:36.883967 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m09:47:36.884117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66368fe8-d620-4fef-8d28-b6abb67ee55c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ab1050>]}
[0m09:47:36.884882 [info ] [MainThread]: 
[0m09:47:36.885138 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:47:36.885529 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m09:47:36.885715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:47:37.308849 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m09:47:37.309893 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:47:37.641337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66368fe8-d620-4fef-8d28-b6abb67ee55c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d90d590>]}
[0m09:47:37.642407 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:47:37.642879 [info ] [MainThread]: 
[0m09:47:37.648139 [debug] [Thread-1 (]: Began running node model.curriculum_rec.wip
[0m09:47:37.648989 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_curriculum_rec.wip ............................. [RUN]
[0m09:47:37.649514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.wip)
[0m09:47:37.649826 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.wip
[0m09:47:37.657743 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.wip"
[0m09:47:37.658729 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.wip
[0m09:47:37.680003 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.wip"
[0m09:47:37.680486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:47:37.681557 [debug] [Thread-1 (]: On model.curriculum_rec.wip: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.wip"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`wip`
  OPTIONS()
  as SELECT
    id_topic,
    (
      
WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = stg_kaggle__correl.id_topic

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
SELECT 
    TO_JSON_STRING(
        ARRAY_AGG(
            STRUCT(
                id_topic,
                id_topic_parent,
                val_topic_level,
                cat_topic_title
            )
        )
    ) AS hierarchy_json
FROM hierarchy

    ) AS hierarchy_json
FROM stg_kaggle__correl;


[0m09:47:38.134064 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:373978b9-c69e-4f87-904d-2ef75f4b9231&page=queryresults
[0m09:47:38.135596 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "stg_kaggle__correl" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: stg_kaggle__correl, message: Table "stg_kaggle__correl" must be qualified with a dataset (e.g. dataset.table).')
[0m09:47:39.248928 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:e119cd21-2b8e-475a-b2f1-71f888eb35b1&page=queryresults
[0m09:47:39.251054 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:e119cd21-2b8e-475a-b2f1-71f888eb35b1&page=queryresults
[0m09:47:39.258452 [debug] [Thread-1 (]: Database Error in model wip (models/intermediate/education/wip.sql)
  Table "stg_kaggle__correl" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m09:47:39.260105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66368fe8-d620-4fef-8d28-b6abb67ee55c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db15550>]}
[0m09:47:39.260821 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_curriculum_rec.wip .................... [[31mERROR[0m in 1.61s]
[0m09:47:39.261304 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.wip
[0m09:47:39.262937 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:47:39.263167 [debug] [MainThread]: Connection 'model.curriculum_rec.wip' was properly closed.
[0m09:47:39.263408 [info ] [MainThread]: 
[0m09:47:39.263646 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.38 seconds (2.38s).
[0m09:47:39.264132 [debug] [MainThread]: Command end result
[0m09:47:39.289815 [info ] [MainThread]: 
[0m09:47:39.290095 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:47:39.290265 [info ] [MainThread]: 
[0m09:47:39.290463 [error] [MainThread]:   Database Error in model wip (models/intermediate/education/wip.sql)
  Table "stg_kaggle__correl" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m09:47:39.290618 [info ] [MainThread]: 
[0m09:47:39.290780 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:47:39.291998 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.0014079, "process_user_time": 1.236755, "process_kernel_time": 0.165261, "process_mem_max_rss": "211959808", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:47:39.292289 [debug] [MainThread]: Command `dbt run` failed at 09:47:39.292240 after 3.00 seconds
[0m09:47:39.292508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee1dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eec8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d85490>]}
[0m09:47:39.292698 [debug] [MainThread]: Flushing usage events
[0m09:48:51.511766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107756a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d8d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d93d0>]}


============================== 09:48:51.513490 | fce00dc4-4e94-4b4a-bc57-deaa2a64c14e ==============================
[0m09:48:51.513490 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:48:51.513765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'send_anonymous_usage_stats': 'True'}
[0m09:48:51.817609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fce00dc4-4e94-4b4a-bc57-deaa2a64c14e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107762ad0>]}
[0m09:48:51.836613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fce00dc4-4e94-4b4a-bc57-deaa2a64c14e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b6d4d0>]}
[0m09:48:51.836851 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m09:48:51.847431 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:48:51.932726 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:48:51.933031 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/intermediate/education/wip.sql
[0m09:48:52.021017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fce00dc4-4e94-4b4a-bc57-deaa2a64c14e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1177d2050>]}
[0m09:48:52.060700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fce00dc4-4e94-4b4a-bc57-deaa2a64c14e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117a3e950>]}
[0m09:48:52.060907 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m09:48:52.061053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fce00dc4-4e94-4b4a-bc57-deaa2a64c14e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e5d0d0>]}
[0m09:48:52.061809 [info ] [MainThread]: 
[0m09:48:52.062025 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:48:52.062413 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m09:48:52.062594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:48:52.396692 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m09:48:52.397411 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:48:52.757221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fce00dc4-4e94-4b4a-bc57-deaa2a64c14e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e5d0d0>]}
[0m09:48:52.758436 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:48:52.758875 [info ] [MainThread]: 
[0m09:48:52.761546 [debug] [Thread-1 (]: Began running node model.curriculum_rec.wip
[0m09:48:52.762114 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_curriculum_rec.wip ............................. [RUN]
[0m09:48:52.762569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.wip)
[0m09:48:52.762885 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.wip
[0m09:48:52.769917 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.wip"
[0m09:48:52.770673 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.wip
[0m09:48:52.791799 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.wip"
[0m09:48:52.792210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:48:52.793209 [debug] [Thread-1 (]: On model.curriculum_rec.wip: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.wip"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`wip`
  OPTIONS()
  as SELECT
    id_topic,
    (
      
WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = dbt_curriculum_rec.stg_kaggle__correl.id_topic

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
SELECT 
    TO_JSON_STRING(
        ARRAY_AGG(
            STRUCT(
                id_topic,
                id_topic_parent,
                val_topic_level,
                cat_topic_title
            )
        )
    ) AS hierarchy_json
FROM hierarchy

    ) AS hierarchy_json
FROM stg_kaggle__correl;


[0m09:48:53.197353 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:577ea115-0687-4866-829a-0c293d5971fb&page=queryresults
[0m09:48:53.198844 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "stg_kaggle__correl" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: stg_kaggle__correl, message: Table "stg_kaggle__correl" must be qualified with a dataset (e.g. dataset.table).')
[0m09:48:53.602488 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:dc4c8046-d65e-4fd6-b772-cca05cd94282&page=queryresults
[0m09:48:53.604373 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:dc4c8046-d65e-4fd6-b772-cca05cd94282&page=queryresults
[0m09:48:53.612484 [debug] [Thread-1 (]: Database Error in model wip (models/intermediate/education/wip.sql)
  Table "stg_kaggle__correl" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m09:48:53.614587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fce00dc4-4e94-4b4a-bc57-deaa2a64c14e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117e18c10>]}
[0m09:48:53.615326 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_curriculum_rec.wip .................... [[31mERROR[0m in 0.85s]
[0m09:48:53.615900 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.wip
[0m09:48:53.617845 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:48:53.618120 [debug] [MainThread]: Connection 'model.curriculum_rec.wip' was properly closed.
[0m09:48:53.618393 [info ] [MainThread]: 
[0m09:48:53.618672 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.56 seconds (1.56s).
[0m09:48:53.619229 [debug] [MainThread]: Command end result
[0m09:48:53.646393 [info ] [MainThread]: 
[0m09:48:53.646672 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:48:53.646839 [info ] [MainThread]: 
[0m09:48:53.647038 [error] [MainThread]:   Database Error in model wip (models/intermediate/education/wip.sql)
  Table "stg_kaggle__correl" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m09:48:53.647192 [info ] [MainThread]: 
[0m09:48:53.647353 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:48:53.648529 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.1608264, "process_user_time": 1.20753, "process_kernel_time": 0.158323, "process_mem_max_rss": "210878464", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:48:53.648815 [debug] [MainThread]: Command `dbt run` failed at 09:48:53.648769 after 2.16 seconds
[0m09:48:53.649018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d90d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d9050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103129490>]}
[0m09:48:53.649210 [debug] [MainThread]: Flushing usage events
[0m09:50:06.476405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d730d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dc7350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108df5810>]}


============================== 09:50:06.478054 | 7b221f5c-fb0e-45a5-a81d-d82c1ee54e0a ==============================
[0m09:50:06.478054 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:50:06.478362 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:50:06.782935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b221f5c-fb0e-45a5-a81d-d82c1ee54e0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a93bd50>]}
[0m09:50:06.801987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b221f5c-fb0e-45a5-a81d-d82c1ee54e0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107359810>]}
[0m09:50:06.802218 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m09:50:06.813363 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:50:06.899437 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:50:06.899749 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/intermediate/education/wip.sql
[0m09:50:06.955797 [error] [MainThread]: Encountered an error:
Compilation Error in model wip (models/intermediate/education/wip.sql)
  unexpected char '`' at 61
    line 4
      {{ generate_topic_hierarchy(`dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topicid_topic`) }}
[0m09:50:06.956823 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.50468415, "process_user_time": 0.906898, "process_kernel_time": 0.141606, "process_mem_max_rss": "202670080", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:50:06.957044 [debug] [MainThread]: Command `dbt run` failed at 09:50:06.957005 after 0.50 seconds
[0m09:50:06.957197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108df74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108df5750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10490ccd0>]}
[0m09:50:06.957349 [debug] [MainThread]: Flushing usage events
[0m09:50:24.914979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe2a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105064d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105065390>]}


============================== 09:50:24.916652 | ae854a12-ac5a-450e-b09c-2994e4303e01 ==============================
[0m09:50:24.916652 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:50:24.916949 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:50:25.221639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae854a12-ac5a-450e-b09c-2994e4303e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a730d90>]}
[0m09:50:25.240804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae854a12-ac5a-450e-b09c-2994e4303e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035c8f90>]}
[0m09:50:25.241047 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m09:50:25.251899 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:50:25.337160 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:50:25.337480 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/intermediate/education/wip.sql
[0m09:50:25.393561 [error] [MainThread]: Encountered an error:
Compilation Error in model wip (models/intermediate/education/wip.sql)
  unexpected char '`' at 61
    line 4
      {{ generate_topic_hierarchy(`dbt-tutorial-428919.dbt_curriculum_rec.stg_kaggle__topicid_topic`) }}
[0m09:50:25.394557 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.50361574, "process_user_time": 0.90573, "process_kernel_time": 0.139138, "process_mem_max_rss": "202850304", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:50:25.394779 [debug] [MainThread]: Command `dbt run` failed at 09:50:25.394740 after 0.50 seconds
[0m09:50:25.394946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105079490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10503c8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100b7d910>]}
[0m09:50:25.395100 [debug] [MainThread]: Flushing usage events
[0m09:50:34.386351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10523aa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052bce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052bd490>]}


============================== 09:50:34.388061 | 92bd0b21-28bf-4182-b4be-db0e34018eb7 ==============================
[0m09:50:34.388061 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:50:34.388335 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'debug': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:50:34.689082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92bd0b21-28bf-4182-b4be-db0e34018eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa145d0>]}
[0m09:50:34.708181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92bd0b21-28bf-4182-b4be-db0e34018eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103819350>]}
[0m09:50:34.708445 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m09:50:34.719148 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:50:34.804287 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:50:34.804588 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/intermediate/education/wip.sql
[0m09:50:34.892182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92bd0b21-28bf-4182-b4be-db0e34018eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105256810>]}
[0m09:50:34.931921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92bd0b21-28bf-4182-b4be-db0e34018eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10add55d0>]}
[0m09:50:34.932134 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m09:50:34.932282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92bd0b21-28bf-4182-b4be-db0e34018eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae2dc90>]}
[0m09:50:34.933049 [info ] [MainThread]: 
[0m09:50:34.933270 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:50:34.933652 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m09:50:34.933837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:50:35.398228 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m09:50:35.398982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:50:35.903008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92bd0b21-28bf-4182-b4be-db0e34018eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abdf8d0>]}
[0m09:50:35.904038 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:50:35.904810 [info ] [MainThread]: 
[0m09:50:35.907808 [debug] [Thread-1 (]: Began running node model.curriculum_rec.wip
[0m09:50:35.908386 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_curriculum_rec.wip ............................. [RUN]
[0m09:50:35.908816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.wip)
[0m09:50:35.909135 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.wip
[0m09:50:35.916618 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.wip"
[0m09:50:35.917318 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.wip
[0m09:50:35.938876 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.wip"
[0m09:50:35.939302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:50:35.940301 [debug] [Thread-1 (]: On model.curriculum_rec.wip: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.wip"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`wip`
  OPTIONS()
  as SELECT
    id_topic,
    (
      
WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = dbt-tutorial-428919.dbt_curriculum_rec.stg_kaggle__topicid_topic

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
SELECT 
    TO_JSON_STRING(
        ARRAY_AGG(
            STRUCT(
                id_topic,
                id_topic_parent,
                val_topic_level,
                cat_topic_title
            )
        )
    ) AS hierarchy_json
FROM hierarchy

    ) AS hierarchy_json
FROM stg_kaggle__correl;


[0m09:50:36.313909 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:51913c2e-5c40-43a0-9a55-f5b33ab90b7c&page=queryresults
[0m09:50:36.315576 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "dbt_curriculum_rec" at [13:45]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got identifier "dbt_curriculum_rec" at [13:45]')
[0m09:50:37.271174 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:ab9d7806-eace-4017-ae5a-8b4aecff1162&page=queryresults
[0m09:50:37.272487 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:ab9d7806-eace-4017-ae5a-8b4aecff1162&page=queryresults
[0m09:50:37.280219 [debug] [Thread-1 (]: Database Error in model wip (models/intermediate/education/wip.sql)
  Syntax error: Expected ")" but got identifier "dbt_curriculum_rec" at [13:45]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m09:50:37.282240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92bd0b21-28bf-4182-b4be-db0e34018eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae71450>]}
[0m09:50:37.282944 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_curriculum_rec.wip .................... [[31mERROR[0m in 1.37s]
[0m09:50:37.283499 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.wip
[0m09:50:37.285266 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:50:37.285544 [debug] [MainThread]: Connection 'model.curriculum_rec.wip' was properly closed.
[0m09:50:37.285836 [info ] [MainThread]: 
[0m09:50:37.286122 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.35 seconds (2.35s).
[0m09:50:37.286666 [debug] [MainThread]: Command end result
[0m09:50:37.313745 [info ] [MainThread]: 
[0m09:50:37.314016 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:50:37.314181 [info ] [MainThread]: 
[0m09:50:37.314374 [error] [MainThread]:   Database Error in model wip (models/intermediate/education/wip.sql)
  Syntax error: Expected ")" but got identifier "dbt_curriculum_rec" at [13:45]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m09:50:37.314527 [info ] [MainThread]: 
[0m09:50:37.314685 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:50:37.315881 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.9535725, "process_user_time": 1.207444, "process_kernel_time": 0.154417, "process_mem_max_rss": "209682432", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:50:37.316175 [debug] [MainThread]: Command `dbt run` failed at 09:50:37.316125 after 2.95 seconds
[0m09:50:37.316381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ce550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052bd350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b31b990>]}
[0m09:50:37.316565 [debug] [MainThread]: Flushing usage events
[0m09:50:59.819388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111557ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115d8950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115d8f90>]}


============================== 09:50:59.821165 | 1c1edc7e-2556-4462-b862-5843ffb9a134 ==============================
[0m09:50:59.821165 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:50:59.821446 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:51:00.134879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c1edc7e-2556-4462-b862-5843ffb9a134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11158af90>]}
[0m09:51:00.153974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c1edc7e-2556-4462-b862-5843ffb9a134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111599610>]}
[0m09:51:00.154211 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m09:51:00.165626 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:51:00.251990 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:51:00.252295 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/intermediate/education/wip.sql
[0m09:51:00.340203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c1edc7e-2556-4462-b862-5843ffb9a134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1225de810>]}
[0m09:51:00.379892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c1edc7e-2556-4462-b862-5843ffb9a134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1231b4310>]}
[0m09:51:00.380107 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m09:51:00.380260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c1edc7e-2556-4462-b862-5843ffb9a134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123185d50>]}
[0m09:51:00.381005 [info ] [MainThread]: 
[0m09:51:00.381236 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:51:00.381590 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m09:51:00.381773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:51:00.734677 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m09:51:00.735421 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:51:01.060208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c1edc7e-2556-4462-b862-5843ffb9a134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123146810>]}
[0m09:51:01.061287 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:51:01.061714 [info ] [MainThread]: 
[0m09:51:01.064390 [debug] [Thread-1 (]: Began running node model.curriculum_rec.wip
[0m09:51:01.064900 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_curriculum_rec.wip ............................. [RUN]
[0m09:51:01.065295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.wip)
[0m09:51:01.065605 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.wip
[0m09:51:01.072968 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.wip"
[0m09:51:01.073659 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.wip
[0m09:51:01.095005 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.wip"
[0m09:51:01.095403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:01.096371 [debug] [Thread-1 (]: On model.curriculum_rec.wip: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.wip"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`wip`
  OPTIONS()
  as SELECT
    id_topic,
    (
      
WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = dbt-tutorial-428919.dbt_curriculum_rec.stg_kaggle__topic.id_topic

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
SELECT 
    TO_JSON_STRING(
        ARRAY_AGG(
            STRUCT(
                id_topic,
                id_topic_parent,
                val_topic_level,
                cat_topic_title
            )
        )
    ) AS hierarchy_json
FROM hierarchy

    ) AS hierarchy_json
FROM stg_kaggle__correl;


[0m09:51:01.502024 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:fb212101-88f2-4aac-9206-f0da5de1a4e7&page=queryresults
[0m09:51:01.503624 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "dbt_curriculum_rec" at [13:45]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got identifier "dbt_curriculum_rec" at [13:45]')
[0m09:51:02.127968 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:f9c9d2b0-617d-4168-9223-94c99b0f37dc&page=queryresults
[0m09:51:02.129342 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:f9c9d2b0-617d-4168-9223-94c99b0f37dc&page=queryresults
[0m09:51:02.137713 [debug] [Thread-1 (]: Database Error in model wip (models/intermediate/education/wip.sql)
  Syntax error: Expected ")" but got identifier "dbt_curriculum_rec" at [13:45]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m09:51:02.139517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c1edc7e-2556-4462-b862-5843ffb9a134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1232a1850>]}
[0m09:51:02.140187 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_curriculum_rec.wip .................... [[31mERROR[0m in 1.07s]
[0m09:51:02.140755 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.wip
[0m09:51:02.142601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:51:02.142943 [debug] [MainThread]: Connection 'model.curriculum_rec.wip' was properly closed.
[0m09:51:02.143253 [info ] [MainThread]: 
[0m09:51:02.143540 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.76 seconds (1.76s).
[0m09:51:02.144062 [debug] [MainThread]: Command end result
[0m09:51:02.170439 [info ] [MainThread]: 
[0m09:51:02.170693 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:51:02.170867 [info ] [MainThread]: 
[0m09:51:02.171059 [error] [MainThread]:   Database Error in model wip (models/intermediate/education/wip.sql)
  Syntax error: Expected ")" but got identifier "dbt_curriculum_rec" at [13:45]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m09:51:02.171220 [info ] [MainThread]: 
[0m09:51:02.171382 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:51:02.172631 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.3778074, "process_user_time": 1.211039, "process_kernel_time": 0.170123, "process_mem_max_rss": "214581248", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:51:02.172916 [debug] [MainThread]: Command `dbt run` failed at 09:51:02.172869 after 2.38 seconds
[0m09:51:02.173113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115d8b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fac8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1232203d0>]}
[0m09:51:02.173296 [debug] [MainThread]: Flushing usage events
[0m09:51:53.707486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ed7250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f589d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f59010>]}


============================== 09:51:53.709317 | 6cf89e81-c7c7-493a-8572-0e89a5e0ce32 ==============================
[0m09:51:53.709317 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:51:53.709614 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'send_anonymous_usage_stats': 'True'}
[0m09:51:54.015291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6cf89e81-c7c7-493a-8572-0e89a5e0ce32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10accc1d0>]}
[0m09:51:54.034390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6cf89e81-c7c7-493a-8572-0e89a5e0ce32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054bd550>]}
[0m09:51:54.034633 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m09:51:54.045780 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:51:54.130251 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:51:54.130551 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/intermediate/education/wip.sql
[0m09:51:54.218199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6cf89e81-c7c7-493a-8572-0e89a5e0ce32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056956d0>]}
[0m09:51:54.258028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cf89e81-c7c7-493a-8572-0e89a5e0ce32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca06650>]}
[0m09:51:54.258237 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m09:51:54.258384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cf89e81-c7c7-493a-8572-0e89a5e0ce32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10caca190>]}
[0m09:51:54.259166 [info ] [MainThread]: 
[0m09:51:54.259387 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:51:54.259777 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m09:51:54.259968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:51:54.592023 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m09:51:54.592664 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:51:54.925498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cf89e81-c7c7-493a-8572-0e89a5e0ce32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca43590>]}
[0m09:51:54.926950 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:51:54.927434 [info ] [MainThread]: 
[0m09:51:54.931339 [debug] [Thread-1 (]: Began running node model.curriculum_rec.wip
[0m09:51:54.932199 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_curriculum_rec.wip ............................. [RUN]
[0m09:51:54.932784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.wip)
[0m09:51:54.933162 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.wip
[0m09:51:54.941023 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.wip"
[0m09:51:54.941835 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.wip
[0m09:51:54.964281 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.wip"
[0m09:51:54.964819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:54.965941 [debug] [Thread-1 (]: On model.curriculum_rec.wip: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.wip"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`wip`
  OPTIONS()
  as SELECT
    id_topic,
    (
      
WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = 

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
SELECT 
    TO_JSON_STRING(
        ARRAY_AGG(
            STRUCT(
                id_topic,
                id_topic_parent,
                val_topic_level,
                cat_topic_title
            )
        )
    ) AS hierarchy_json
FROM hierarchy

    ) AS hierarchy_json
FROM stg_kaggle__correl;


[0m09:51:55.469491 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:3dc820aa-4876-4e10-aefe-ec59c98421c5&page=queryresults
[0m09:51:55.470901 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword UNION at [15:5]; reason: invalidQuery, location: query, message: Syntax error: Unexpected keyword UNION at [15:5]')
[0m09:51:56.562780 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:716e126c-a4d4-42f7-997c-018957f5a796&page=queryresults
[0m09:51:56.564699 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:716e126c-a4d4-42f7-997c-018957f5a796&page=queryresults
[0m09:51:56.572573 [debug] [Thread-1 (]: Database Error in model wip (models/intermediate/education/wip.sql)
  Syntax error: Unexpected keyword UNION at [15:5]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m09:51:56.574302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf89e81-c7c7-493a-8572-0e89a5e0ce32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbf27d0>]}
[0m09:51:56.574929 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_curriculum_rec.wip .................... [[31mERROR[0m in 1.64s]
[0m09:51:56.575388 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.wip
[0m09:51:56.577033 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:51:56.577285 [debug] [MainThread]: Connection 'model.curriculum_rec.wip' was properly closed.
[0m09:51:56.577514 [info ] [MainThread]: 
[0m09:51:56.577725 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.32 seconds (2.32s).
[0m09:51:56.578155 [debug] [MainThread]: Command end result
[0m09:51:56.601759 [info ] [MainThread]: 
[0m09:51:56.602014 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:51:56.602314 [info ] [MainThread]: 
[0m09:51:56.602586 [error] [MainThread]:   Database Error in model wip (models/intermediate/education/wip.sql)
  Syntax error: Unexpected keyword UNION at [15:5]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m09:51:56.602739 [info ] [MainThread]: 
[0m09:51:56.602900 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:51:56.604195 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.9218583, "process_user_time": 1.201705, "process_kernel_time": 0.165724, "process_mem_max_rss": "209879040", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:51:56.604490 [debug] [MainThread]: Command `dbt run` failed at 09:51:56.604446 after 2.92 seconds
[0m09:51:56.604683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f2a8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a6b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f5acd0>]}
[0m09:51:56.604862 [debug] [MainThread]: Flushing usage events
[0m09:52:22.148828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a6b390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110aecc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110aed250>]}


============================== 09:52:22.150957 | 6821838d-4a19-4287-95ef-087259f94886 ==============================
[0m09:52:22.150957 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:52:22.151245 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:52:22.455988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6821838d-4a19-4287-95ef-087259f94886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115cc9c50>]}
[0m09:52:22.475076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6821838d-4a19-4287-95ef-087259f94886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106179190>]}
[0m09:52:22.475321 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m09:52:22.486535 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:52:22.571457 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:52:22.571774 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/intermediate/education/wip.sql
[0m09:52:22.659239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6821838d-4a19-4287-95ef-087259f94886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117979cd0>]}
[0m09:52:22.699096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6821838d-4a19-4287-95ef-087259f94886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117370090>]}
[0m09:52:22.699315 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m09:52:22.699464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6821838d-4a19-4287-95ef-087259f94886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11791ad10>]}
[0m09:52:22.700226 [info ] [MainThread]: 
[0m09:52:22.700442 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:52:22.700813 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m09:52:22.700999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:23.007510 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m09:52:23.008553 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:23.358367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6821838d-4a19-4287-95ef-087259f94886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117ca6d10>]}
[0m09:52:23.360578 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:52:23.361311 [info ] [MainThread]: 
[0m09:52:23.365460 [debug] [Thread-1 (]: Began running node model.curriculum_rec.wip
[0m09:52:23.366559 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_curriculum_rec.wip ............................. [RUN]
[0m09:52:23.367494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.wip)
[0m09:52:23.367994 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.wip
[0m09:52:23.378977 [debug] [Thread-1 (]: Compilation Error in model wip (models/intermediate/education/wip.sql)
  'stg_kaggle__correl' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:52:23.380213 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6821838d-4a19-4287-95ef-087259f94886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117c2d010>]}
[0m09:52:23.380773 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_curriculum_rec.wip .................... [[31mERROR[0m in 0.01s]
[0m09:52:23.381272 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.wip
[0m09:52:23.384615 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:52:23.384884 [debug] [MainThread]: Connection 'model.curriculum_rec.wip' was properly closed.
[0m09:52:23.385100 [info ] [MainThread]: 
[0m09:52:23.385320 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m09:52:23.385699 [debug] [MainThread]: Command end result
[0m09:52:23.408476 [info ] [MainThread]: 
[0m09:52:23.408731 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:52:23.408896 [info ] [MainThread]: 
[0m09:52:23.409093 [error] [MainThread]:   Compilation Error in model wip (models/intermediate/education/wip.sql)
  'stg_kaggle__correl' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:52:23.409249 [info ] [MainThread]: 
[0m09:52:23.409402 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:52:23.410516 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2862884, "process_user_time": 1.130212, "process_kernel_time": 0.157828, "process_mem_max_rss": "208781312", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:52:23.410779 [debug] [MainThread]: Command `dbt run` failed at 09:52:23.410734 after 1.29 seconds
[0m09:52:23.410963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110abfdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110abfd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10372d590>]}
[0m09:52:23.411137 [debug] [MainThread]: Flushing usage events
[0m09:52:50.390505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105068b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105069190>]}


============================== 09:52:50.392187 | 56af9532-b09c-4ef1-84e7-50f49d7c0dc2 ==============================
[0m09:52:50.392187 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:52:50.392458 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:52:50.698316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56af9532-b09c-4ef1-84e7-50f49d7c0dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105747310>]}
[0m09:52:50.718148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56af9532-b09c-4ef1-84e7-50f49d7c0dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a895010>]}
[0m09:52:50.718423 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m09:52:50.730045 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:52:50.817867 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:52:50.818174 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/intermediate/education/wip.sql
[0m09:52:50.906410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56af9532-b09c-4ef1-84e7-50f49d7c0dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037c9050>]}
[0m09:52:50.945972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56af9532-b09c-4ef1-84e7-50f49d7c0dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a89ce10>]}
[0m09:52:50.946181 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m09:52:50.946335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56af9532-b09c-4ef1-84e7-50f49d7c0dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9f0fd0>]}
[0m09:52:50.947111 [info ] [MainThread]: 
[0m09:52:50.947335 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:52:50.947696 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m09:52:50.947868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:51.285774 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m09:52:51.286419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:51.636577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56af9532-b09c-4ef1-84e7-50f49d7c0dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abb2c90>]}
[0m09:52:51.637849 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:52:51.638470 [info ] [MainThread]: 
[0m09:52:51.641393 [debug] [Thread-1 (]: Began running node model.curriculum_rec.wip
[0m09:52:51.641998 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_curriculum_rec.wip ............................. [RUN]
[0m09:52:51.642481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.wip)
[0m09:52:51.642858 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.wip
[0m09:52:51.650158 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.wip"
[0m09:52:51.650875 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.wip
[0m09:52:51.669850 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.wip"
[0m09:52:51.670328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:51.671404 [debug] [Thread-1 (]: On model.curriculum_rec.wip: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.wip"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`wip`
  OPTIONS()
  as SELECT
    id_topic,
    (
      
WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = stg_kaggle__correl.id_topic

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
SELECT 
    TO_JSON_STRING(
        ARRAY_AGG(
            STRUCT(
                id_topic,
                id_topic_parent,
                val_topic_level,
                cat_topic_title
            )
        )
    ) AS hierarchy_json
FROM hierarchy

    ) AS hierarchy_json
FROM stg_kaggle__correl;


[0m09:52:52.096041 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:0b5b03cc-e109-4a94-ac82-8543007f6a0f&page=queryresults
[0m09:52:52.097878 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "stg_kaggle__correl" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: stg_kaggle__correl, message: Table "stg_kaggle__correl" must be qualified with a dataset (e.g. dataset.table).')
[0m09:52:53.187237 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:7af0ac84-73f1-48b6-95d2-0acc5e548a05&page=queryresults
[0m09:52:53.188809 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:7af0ac84-73f1-48b6-95d2-0acc5e548a05&page=queryresults
[0m09:52:53.195958 [debug] [Thread-1 (]: Database Error in model wip (models/intermediate/education/wip.sql)
  Table "stg_kaggle__correl" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m09:52:53.198085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56af9532-b09c-4ef1-84e7-50f49d7c0dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac782d0>]}
[0m09:52:53.199032 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_curriculum_rec.wip .................... [[31mERROR[0m in 1.55s]
[0m09:52:53.199625 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.wip
[0m09:52:53.201783 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:52:53.202206 [debug] [MainThread]: Connection 'model.curriculum_rec.wip' was properly closed.
[0m09:52:53.202553 [info ] [MainThread]: 
[0m09:52:53.202884 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.26 seconds (2.26s).
[0m09:52:53.203520 [debug] [MainThread]: Command end result
[0m09:52:53.232291 [info ] [MainThread]: 
[0m09:52:53.232596 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:52:53.232813 [info ] [MainThread]: 
[0m09:52:53.233072 [error] [MainThread]:   Database Error in model wip (models/intermediate/education/wip.sql)
  Table "stg_kaggle__correl" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m09:52:53.233240 [info ] [MainThread]: 
[0m09:52:53.233418 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:52:53.234697 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.8677557, "process_user_time": 1.211894, "process_kernel_time": 0.163452, "process_mem_max_rss": "211894272", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:52:53.235009 [debug] [MainThread]: Command `dbt run` failed at 09:52:53.234960 after 2.87 seconds
[0m09:52:53.235245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10503b210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104028390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105068ed0>]}
[0m09:52:53.235456 [debug] [MainThread]: Flushing usage events
[0m09:53:07.059288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d56f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dd8910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dd8f50>]}


============================== 09:53:07.061180 | 7892dc4e-0658-44b9-997a-42ecc5c00468 ==============================
[0m09:53:07.061180 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:53:07.061468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:53:07.368103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7892dc4e-0658-44b9-997a-42ecc5c00468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11645de50>]}
[0m09:53:07.387380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7892dc4e-0658-44b9-997a-42ecc5c00468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f1310>]}
[0m09:53:07.387625 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m09:53:07.399870 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:53:07.485657 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:53:07.485957 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/intermediate/education/wip.sql
[0m09:53:07.574947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7892dc4e-0658-44b9-997a-42ecc5c00468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d71850>]}
[0m09:53:07.614896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7892dc4e-0658-44b9-997a-42ecc5c00468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116b4ebd0>]}
[0m09:53:07.615113 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m09:53:07.615265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7892dc4e-0658-44b9-997a-42ecc5c00468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116adaf10>]}
[0m09:53:07.616062 [info ] [MainThread]: 
[0m09:53:07.616296 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:53:07.616671 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m09:53:07.616855 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:53:07.966468 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m09:53:07.967070 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:53:08.403003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7892dc4e-0658-44b9-997a-42ecc5c00468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116b20950>]}
[0m09:53:08.403591 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:53:08.403753 [info ] [MainThread]: 
[0m09:53:08.405542 [debug] [Thread-1 (]: Began running node model.curriculum_rec.wip
[0m09:53:08.406118 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_curriculum_rec.wip ............................. [RUN]
[0m09:53:08.406598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.wip)
[0m09:53:08.406905 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.wip
[0m09:53:08.414286 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.wip"
[0m09:53:08.415023 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.wip
[0m09:53:08.437322 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.wip"
[0m09:53:08.437771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:08.438800 [debug] [Thread-1 (]: On model.curriculum_rec.wip: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.wip"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`wip`
  OPTIONS()
  as SELECT
    id_topic,
    (
      
WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = dbt_curriculum_rec.stg_kaggle__correl.id_topic

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
SELECT 
    TO_JSON_STRING(
        ARRAY_AGG(
            STRUCT(
                id_topic,
                id_topic_parent,
                val_topic_level,
                cat_topic_title
            )
        )
    ) AS hierarchy_json
FROM hierarchy

    ) AS hierarchy_json
FROM stg_kaggle__correl;


[0m09:53:08.777115 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:c2a859f7-e524-4e14-b426-fe672ef7b0ad&page=queryresults
[0m09:53:08.778453 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "stg_kaggle__correl" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: stg_kaggle__correl, message: Table "stg_kaggle__correl" must be qualified with a dataset (e.g. dataset.table).')
[0m09:53:10.118637 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:b1c812b6-b48a-47e5-b62a-ad0f80e0bf64&page=queryresults
[0m09:53:10.120408 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:b1c812b6-b48a-47e5-b62a-ad0f80e0bf64&page=queryresults
[0m09:53:10.128445 [debug] [Thread-1 (]: Database Error in model wip (models/intermediate/education/wip.sql)
  Table "stg_kaggle__correl" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m09:53:10.130242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7892dc4e-0658-44b9-997a-42ecc5c00468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116a458d0>]}
[0m09:53:10.130902 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_curriculum_rec.wip .................... [[31mERROR[0m in 1.72s]
[0m09:53:10.131445 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.wip
[0m09:53:10.133280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:53:10.133546 [debug] [MainThread]: Connection 'model.curriculum_rec.wip' was properly closed.
[0m09:53:10.133826 [info ] [MainThread]: 
[0m09:53:10.134093 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.52 seconds (2.52s).
[0m09:53:10.134633 [debug] [MainThread]: Command end result
[0m09:53:10.161552 [info ] [MainThread]: 
[0m09:53:10.161810 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:53:10.161974 [info ] [MainThread]: 
[0m09:53:10.162171 [error] [MainThread]:   Database Error in model wip (models/intermediate/education/wip.sql)
  Table "stg_kaggle__correl" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m09:53:10.162323 [info ] [MainThread]: 
[0m09:53:10.162479 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:53:10.163638 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.130118, "process_user_time": 1.221208, "process_kernel_time": 0.163171, "process_mem_max_rss": "210518016", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:53:10.163915 [debug] [MainThread]: Command `dbt run` failed at 09:53:10.163868 after 3.13 seconds
[0m09:53:10.164109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ddae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dd8e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037a4cd0>]}
[0m09:53:10.164287 [debug] [MainThread]: Flushing usage events
[0m09:56:48.557284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109752a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097d4bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097d5210>]}


============================== 09:56:48.558973 | 9bd30185-6531-4cd7-a359-05e3f38a3c55 ==============================
[0m09:56:48.558973 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:56:48.559249 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/CalvinLii/.dbt', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:56:48.868131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bd30185-6531-4cd7-a359-05e3f38a3c55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef15450>]}
[0m09:56:48.887414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bd30185-6531-4cd7-a359-05e3f38a3c55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d31510>]}
[0m09:56:48.887661 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m09:56:48.898855 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:56:48.988205 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m09:56:48.988565 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://macros/generate_topic_hierarchy.sql
[0m09:56:48.988714 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/intermediate/education/wip.sql
[0m09:56:48.990076 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two macros named "generate_topic_hierarchy" in the project
  "curriculum_rec".
   To fix this error, rename or remove one of the following macros:
      - macros/generate_topic_hierarchy.sql
      - macros/generate_topic_hierarchy.sql
[0m09:56:48.991061 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.4579658, "process_user_time": 0.855655, "process_kernel_time": 0.132402, "process_mem_max_rss": "200540160", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:56:48.991284 [debug] [MainThread]: Command `dbt run` failed at 09:56:48.991248 after 0.46 seconds
[0m09:56:48.991457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ed6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ed490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10976fd90>]}
[0m09:56:48.991620 [debug] [MainThread]: Flushing usage events
[0m09:57:00.892372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127925d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112814b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128151d0>]}


============================== 09:57:00.894102 | bc5636f8-238c-4d2e-ad11-c8a6b9592807 ==============================
[0m09:57:00.894102 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:57:00.894377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:57:01.196907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc5636f8-238c-4d2e-ad11-c8a6b9592807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121b1ead0>]}
[0m09:57:01.215913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc5636f8-238c-4d2e-ad11-c8a6b9592807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127d69d0>]}
[0m09:57:01.216140 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m09:57:01.227080 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m09:57:01.311700 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m09:57:01.312004 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/intermediate/education/wip.sql
[0m09:57:01.312193 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://macros/generate_topic_hierarchy.sql
[0m09:57:01.405364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc5636f8-238c-4d2e-ad11-c8a6b9592807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121d61c50>]}
[0m09:57:01.445682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc5636f8-238c-4d2e-ad11-c8a6b9592807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122216f10>]}
[0m09:57:01.445908 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m09:57:01.446066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc5636f8-238c-4d2e-ad11-c8a6b9592807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c650d0>]}
[0m09:57:01.446858 [info ] [MainThread]: 
[0m09:57:01.447091 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:57:01.447466 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m09:57:01.447652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:01.961234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m09:57:01.962359 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:57:02.469028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc5636f8-238c-4d2e-ad11-c8a6b9592807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122217b90>]}
[0m09:57:02.470180 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:57:02.470715 [info ] [MainThread]: 
[0m09:57:02.476616 [debug] [Thread-1 (]: Began running node model.curriculum_rec.wip
[0m09:57:02.477421 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_curriculum_rec.wip ............................. [RUN]
[0m09:57:02.477975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.wip)
[0m09:57:02.478357 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.wip
[0m09:57:02.485888 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.wip"
[0m09:57:02.486653 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.wip
[0m09:57:02.506953 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.wip"
[0m09:57:02.507496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:02.508637 [debug] [Thread-1 (]: On model.curriculum_rec.wip: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.wip"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`wip`
  OPTIONS()
  as SELECT
    id_topic,
    (
      
WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = dbt_curriculum_rec.stg_kaggle__correl.id_topic

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
SELECT 
    TO_JSON_STRING(
        ARRAY_AGG(
            STRUCT(
                id_topic,
                id_topic_parent,
                val_topic_level,
                cat_topic_title
            )
        )
    ) AS hierarchy_json
FROM hierarchy

    ) AS hierarchy_json
FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`;


[0m09:57:03.286242 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:e228f744-1823-4a16-b9ef-614c5f70650e&page=queryresults
[0m09:57:03.448358 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('WITH RECURSIVE is only allowed at the top level of the SELECT, CREATE TABLE AS SELECT, CREATE VIEW, INSERT, EXPORT DATA statements.; reason: invalidQuery, location: query, message: WITH RECURSIVE is only allowed at the top level of the SELECT, CREATE TABLE AS SELECT, CREATE VIEW, INSERT, EXPORT DATA statements.')
[0m09:57:05.027336 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:e8585754-5a4d-4f0b-a2b9-05f7143f308d&page=queryresults
[0m09:57:05.186032 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:e8585754-5a4d-4f0b-a2b9-05f7143f308d&page=queryresults
[0m09:57:05.194821 [debug] [Thread-1 (]: Database Error in model wip (models/intermediate/education/wip.sql)
  WITH RECURSIVE is only allowed at the top level of the SELECT, CREATE TABLE AS SELECT, CREATE VIEW, INSERT, EXPORT DATA statements.
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m09:57:05.196786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc5636f8-238c-4d2e-ad11-c8a6b9592807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ebcf90>]}
[0m09:57:05.197450 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_curriculum_rec.wip .................... [[31mERROR[0m in 2.72s]
[0m09:57:05.197980 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.wip
[0m09:57:05.199779 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:57:05.200114 [debug] [MainThread]: Connection 'model.curriculum_rec.wip' was properly closed.
[0m09:57:05.200405 [info ] [MainThread]: 
[0m09:57:05.200687 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.75 seconds (3.75s).
[0m09:57:05.201244 [debug] [MainThread]: Command end result
[0m09:57:05.228174 [info ] [MainThread]: 
[0m09:57:05.228436 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:57:05.228598 [info ] [MainThread]: 
[0m09:57:05.228788 [error] [MainThread]:   Database Error in model wip (models/intermediate/education/wip.sql)
  WITH RECURSIVE is only allowed at the top level of the SELECT, CREATE TABLE AS SELECT, CREATE VIEW, INSERT, EXPORT DATA statements.
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m09:57:05.228944 [info ] [MainThread]: 
[0m09:57:05.229099 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:57:05.230270 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.362157, "process_user_time": 1.232839, "process_kernel_time": 0.158306, "process_mem_max_rss": "210714624", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:57:05.230545 [debug] [MainThread]: Command `dbt run` failed at 09:57:05.230499 after 4.36 seconds
[0m09:57:05.230736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127e28d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127e2650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051c16d0>]}
[0m09:57:05.230914 [debug] [MainThread]: Flushing usage events
[0m10:01:24.460098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109617790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109670fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096707d0>]}


============================== 10:01:24.461901 | d091c58c-7039-46f1-b024-d2910bca7ba7 ==============================
[0m10:01:24.461901 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:01:24.462186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:01:24.770831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd091c58c-7039-46f1-b024-d2910bca7ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109699550>]}
[0m10:01:24.789972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd091c58c-7039-46f1-b024-d2910bca7ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bfd090>]}
[0m10:01:24.790215 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m10:01:24.801970 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m10:01:24.888764 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:01:24.889076 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/intermediate/education/wip.sql
[0m10:01:24.977266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd091c58c-7039-46f1-b024-d2910bca7ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f139490>]}
[0m10:01:25.017253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd091c58c-7039-46f1-b024-d2910bca7ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1ba3d0>]}
[0m10:01:25.017469 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m10:01:25.017625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd091c58c-7039-46f1-b024-d2910bca7ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f147dd0>]}
[0m10:01:25.018415 [info ] [MainThread]: 
[0m10:01:25.018632 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:01:25.018994 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m10:01:25.019177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:01:25.445463 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m10:01:25.446199 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:01:25.813219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd091c58c-7039-46f1-b024-d2910bca7ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eefa650>]}
[0m10:01:25.814412 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:01:25.814873 [info ] [MainThread]: 
[0m10:01:25.818291 [debug] [Thread-1 (]: Began running node model.curriculum_rec.wip
[0m10:01:25.819055 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_curriculum_rec.wip ............................. [RUN]
[0m10:01:25.819623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.wip)
[0m10:01:25.820044 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.wip
[0m10:01:25.828273 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.wip"
[0m10:01:25.829068 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.wip
[0m10:01:25.850774 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.wip"
[0m10:01:25.851247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:01:25.852340 [debug] [Thread-1 (]: On model.curriculum_rec.wip: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.wip"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`wip`
  OPTIONS()
  as WITH temp_hierarchy AS (
    SELECT
        id_topic,
        id_topic_parent,
        val_topic_level,
        cat_topic_title
    FROM (
        
WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = dbt_curriculum_rec.stg_kaggle__correl.id_topic

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
SELECT 
    TO_JSON_STRING(
        ARRAY_AGG(
            STRUCT(
                id_topic,
                id_topic_parent,
                val_topic_level,
                cat_topic_title
            )
        )
    ) AS hierarchy_json
FROM hierarchy

    )
)

SELECT
    c.id_topic,
    (
        SELECT TO_JSON_STRING(
            ARRAY_AGG(
                STRUCT(
                    h.id_topic,
                    h.id_topic_parent,
                    h.val_topic_level,
                    h.cat_topic_title
                )
            )
        ) AS hierarchy_json
        FROM temp_hierarchy h
        WHERE h.id_topic = c.id_topic
    ) AS hierarchy_json
FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl` c


-- SELECT
--     id_topic,
--     (
--       
WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = dbt_curriculum_rec.stg_kaggle__correl.id_topic

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
SELECT 
    TO_JSON_STRING(
        ARRAY_AGG(
            STRUCT(
                id_topic,
                id_topic_parent,
                val_topic_level,
                cat_topic_title
            )
        )
    ) AS hierarchy_json
FROM hierarchy

--     ) AS hierarchy_json
-- FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`;


[0m10:01:26.331900 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:bd998a47-af9b-4b10-b354-e846de3a3562&page=queryresults
[0m10:01:26.333445 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword OFFSET but got keyword RECURSIVE at [64:6]; reason: invalidQuery, location: query, message: Syntax error: Expected keyword OFFSET but got keyword RECURSIVE at [64:6]')
[0m10:01:27.518929 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:052135a7-9239-491b-ae8c-48cdf51bfc21&page=queryresults
[0m10:01:27.520783 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:052135a7-9239-491b-ae8c-48cdf51bfc21&page=queryresults
[0m10:01:27.528289 [debug] [Thread-1 (]: Database Error in model wip (models/intermediate/education/wip.sql)
  Syntax error: Expected keyword OFFSET but got keyword RECURSIVE at [64:6]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m10:01:27.530025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd091c58c-7039-46f1-b024-d2910bca7ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eefb650>]}
[0m10:01:27.530721 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_curriculum_rec.wip .................... [[31mERROR[0m in 1.71s]
[0m10:01:27.531273 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.wip
[0m10:01:27.533074 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:01:27.533314 [debug] [MainThread]: Connection 'model.curriculum_rec.wip' was properly closed.
[0m10:01:27.533544 [info ] [MainThread]: 
[0m10:01:27.533778 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.51 seconds (2.51s).
[0m10:01:27.534237 [debug] [MainThread]: Command end result
[0m10:01:27.559885 [info ] [MainThread]: 
[0m10:01:27.560151 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:01:27.560319 [info ] [MainThread]: 
[0m10:01:27.560514 [error] [MainThread]:   Database Error in model wip (models/intermediate/education/wip.sql)
  Syntax error: Expected keyword OFFSET but got keyword RECURSIVE at [64:6]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m10:01:27.560670 [info ] [MainThread]: 
[0m10:01:27.560833 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:01:27.562011 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.126355, "process_user_time": 1.222907, "process_kernel_time": 0.166177, "process_mem_max_rss": "211484672", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:01:27.562287 [debug] [MainThread]: Command `dbt run` failed at 10:01:27.562239 after 3.13 seconds
[0m10:01:27.562485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109669a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108658390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092308d0>]}
[0m10:01:27.562668 [debug] [MainThread]: Flushing usage events
[0m10:07:01.628965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120578d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120d8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120d9190>]}


============================== 10:07:01.631726 | 596bf507-9557-45eb-bc65-8351596f05dd ==============================
[0m10:07:01.631726 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:07:01.632068 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'send_anonymous_usage_stats': 'True'}
[0m10:07:02.216770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '596bf507-9557-45eb-bc65-8351596f05dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111270050>]}
[0m10:07:02.237966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '596bf507-9557-45eb-bc65-8351596f05dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107579690>]}
[0m10:07:02.238321 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m10:07:02.252181 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m10:07:02.368026 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m10:07:02.368400 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/intermediate/education/wip.sql
[0m10:07:02.368609 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://macros/generate_topic_hierarchy.sql
[0m10:07:02.434858 [error] [MainThread]: Encountered an error:
Compilation Error in model wip (models/intermediate/education/wip.sql)
  macro 'dbt_macro__generate_topic_hierarchy' takes not more than 1 argument(s)
[0m10:07:02.436696 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.84108794, "process_user_time": 1.04871, "process_kernel_time": 0.225615, "process_mem_max_rss": "206848000", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:07:02.436954 [debug] [MainThread]: Command `dbt run` failed at 10:07:02.436914 after 0.84 seconds
[0m10:07:02.437133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120ea450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120d8e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120cdf490>]}
[0m10:07:02.437295 [debug] [MainThread]: Flushing usage events
[0m10:07:42.143223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106692bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106714e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067154d0>]}


============================== 10:07:42.145321 | 74c31d94-7d77-4646-9454-5b8d37371527 ==============================
[0m10:07:42.145321 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:07:42.145740 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:07:42.493654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74c31d94-7d77-4646-9454-5b8d37371527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11585e1d0>]}
[0m10:07:42.513964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74c31d94-7d77-4646-9454-5b8d37371527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045713d0>]}
[0m10:07:42.514294 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m10:07:42.526655 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m10:07:42.625090 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m10:07:42.625449 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://macros/generate_topic_hierarchy.sql
[0m10:07:42.625597 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/intermediate/education/wip.sql
[0m10:07:42.726738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74c31d94-7d77-4646-9454-5b8d37371527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065b3650>]}
[0m10:07:42.777138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74c31d94-7d77-4646-9454-5b8d37371527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11596a810>]}
[0m10:07:42.777500 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m10:07:42.777678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74c31d94-7d77-4646-9454-5b8d37371527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ac750>]}
[0m10:07:42.778519 [info ] [MainThread]: 
[0m10:07:42.778757 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:07:42.779130 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m10:07:42.779321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:07:43.158302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m10:07:43.158693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:07:43.978443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74c31d94-7d77-4646-9454-5b8d37371527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e14310>]}
[0m10:07:43.980907 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:07:43.981470 [info ] [MainThread]: 
[0m10:07:43.985658 [debug] [Thread-1 (]: Began running node model.curriculum_rec.wip
[0m10:07:43.986152 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_curriculum_rec.wip ............................. [RUN]
[0m10:07:43.986483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.wip)
[0m10:07:43.986683 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.wip
[0m10:07:43.991313 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.wip"
[0m10:07:43.991884 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.wip
[0m10:07:44.007894 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.wip"
[0m10:07:44.008595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:07:44.009791 [debug] [Thread-1 (]: On model.curriculum_rec.wip: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.wip"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`wip`
  OPTIONS()
  as SELECT
    id_topic,
    (
      
WITH RECURSIVE hierarchy AS (
    SELECT t1.id_topic, t1.id_topic_parent, t1.val_topic_level, t1.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1
    WHERE t1.id_topic = dbt_curriculum_rec.stg_kaggle__correl.id_topic

    UNION ALL

    SELECT t2.id_topic, t2.id_topic_parent, t2.val_topic_level, t2.cat_topic_title
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
SELECT 
    TO_JSON_STRING(
        ARRAY_AGG(
            STRUCT(
                id_topic,
                id_topic_parent,
                val_topic_level,
                cat_topic_title
            )
        )
    ) AS hierarchy_json
FROM hierarchy

    ) AS hierarchy_json
FROM stg_kaggle__correl;


[0m10:07:44.454296 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:e7be1401-5831-4497-a4a3-fd8e78ab5a7a&page=queryresults
[0m10:07:44.455635 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "stg_kaggle__correl" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: stg_kaggle__correl, message: Table "stg_kaggle__correl" must be qualified with a dataset (e.g. dataset.table).')
[0m10:07:45.467040 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:4cf5930b-8ae4-4271-8027-71b6bedf8fa4&page=queryresults
[0m10:07:45.468374 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:4cf5930b-8ae4-4271-8027-71b6bedf8fa4&page=queryresults
[0m10:07:45.479130 [debug] [Thread-1 (]: Database Error in model wip (models/intermediate/education/wip.sql)
  Table "stg_kaggle__correl" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m10:07:45.480364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74c31d94-7d77-4646-9454-5b8d37371527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115dbe190>]}
[0m10:07:45.480837 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_curriculum_rec.wip .................... [[31mERROR[0m in 1.49s]
[0m10:07:45.481181 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.wip
[0m10:07:45.482564 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:07:45.482904 [debug] [MainThread]: Connection 'model.curriculum_rec.wip' was properly closed.
[0m10:07:45.483196 [info ] [MainThread]: 
[0m10:07:45.483432 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.70 seconds (2.70s).
[0m10:07:45.483796 [debug] [MainThread]: Command end result
[0m10:07:45.507041 [info ] [MainThread]: 
[0m10:07:45.507370 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:07:45.507533 [info ] [MainThread]: 
[0m10:07:45.507731 [error] [MainThread]:   Database Error in model wip (models/intermediate/education/wip.sql)
  Table "stg_kaggle__correl" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m10:07:45.507882 [info ] [MainThread]: 
[0m10:07:45.508048 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:07:45.510457 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.3962402, "process_user_time": 1.310565, "process_kernel_time": 0.189451, "process_mem_max_rss": "213549056", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:07:45.511136 [debug] [MainThread]: Command `dbt run` failed at 10:07:45.511035 after 3.40 seconds
[0m10:07:45.511405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e7d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053d4390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ec8d0>]}
[0m10:07:45.511609 [debug] [MainThread]: Flushing usage events
[0m11:01:19.651171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10749f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107520c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107521210>]}


============================== 11:01:19.653584 | 25c64c38-4e95-4152-a5ec-022dd625829c ==============================
[0m11:01:19.653584 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:01:19.653885 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:01:20.186141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25c64c38-4e95-4152-a5ec-022dd625829c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074cafd0>]}
[0m11:01:20.205306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25c64c38-4e95-4152-a5ec-022dd625829c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a85250>]}
[0m11:01:20.205543 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:01:20.218129 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:01:20.320764 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:01:20.321116 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://macros/generate_topic_hierarchy.sql
[0m11:01:20.321261 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/intermediate/education/wip.sql
[0m11:01:20.412162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25c64c38-4e95-4152-a5ec-022dd625829c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc4c490>]}
[0m11:01:20.456282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25c64c38-4e95-4152-a5ec-022dd625829c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd53190>]}
[0m11:01:20.456494 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 588 macros
[0m11:01:20.456646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25c64c38-4e95-4152-a5ec-022dd625829c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd222d0>]}
[0m11:01:20.457045 [warn ] [MainThread]: The selection criterion 'models/intermediate/education/wip.sql' does not match any enabled nodes
[0m11:01:20.457537 [info ] [MainThread]: 
[0m11:01:20.457669 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:01:20.457847 [debug] [MainThread]: Command end result
[0m11:01:20.472066 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.84752786, "process_user_time": 0.99566, "process_kernel_time": 0.19625, "process_mem_max_rss": "206143488", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:01:20.472292 [debug] [MainThread]: Command `dbt run` succeeded at 11:01:20.472257 after 0.85 seconds
[0m11:01:20.472441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107536390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030ddc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103038c90>]}
[0m11:01:20.472568 [debug] [MainThread]: Flushing usage events
[0m11:01:41.872828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058fea10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105980d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105981390>]}


============================== 11:01:41.874557 | c7410f1e-a6a2-4112-87c1-ba72329746b3 ==============================
[0m11:01:41.874557 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:01:41.874832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'profiles_dir': '/Users/CalvinLii/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:01:42.179686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7410f1e-a6a2-4112-87c1-ba72329746b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c19b50>]}
[0m11:01:42.198799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7410f1e-a6a2-4112-87c1-ba72329746b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103edda50>]}
[0m11:01:42.199053 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:01:42.210076 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:01:42.296495 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:01:42.296804 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/intermediate/education/wip.sql
[0m11:01:42.296973 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://macros/generate_topic_hierarchy.sql
[0m11:01:42.382862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7410f1e-a6a2-4112-87c1-ba72329746b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1c21d0>]}
[0m11:01:42.422336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7410f1e-a6a2-4112-87c1-ba72329746b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5181d0>]}
[0m11:01:42.422546 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 588 macros
[0m11:01:42.422691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7410f1e-a6a2-4112-87c1-ba72329746b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2f7e50>]}
[0m11:01:42.423450 [info ] [MainThread]: 
[0m11:01:42.423672 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:01:42.424049 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m11:01:42.424240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:01:42.976225 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m11:01:42.976922 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:01:43.452847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7410f1e-a6a2-4112-87c1-ba72329746b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b518210>]}
[0m11:01:43.454130 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:01:43.454576 [info ] [MainThread]: 
[0m11:01:43.458386 [debug] [Thread-1 (]: Began running node model.curriculum_rec.wip
[0m11:01:43.459138 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_curriculum_rec.wip ............................. [RUN]
[0m11:01:43.459702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.wip)
[0m11:01:43.460054 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.wip
[0m11:01:43.466558 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.wip"
[0m11:01:43.467288 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.wip
[0m11:01:43.489737 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.wip"
[0m11:01:43.490307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:01:43.491445 [debug] [Thread-1 (]: On model.curriculum_rec.wip: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.wip"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`wip`
  OPTIONS()
  as WITH RECURSIVE hierarchy AS (
    SELECT 
        t1.id_topic, 
        t1.id_topic_parent, 
        t1.val_topic_level, 
        t1.cat_topic_title,
        t1.id_topic AS root_id_topic
    FROM dbt_curriculum_rec.stg_kaggle__topic t1

    UNION ALL

    SELECT 
        t2.id_topic, 
        t2.id_topic_parent, 
        t2.val_topic_level, 
        t2.cat_topic_title,
        h.root_id_topic
    FROM dbt_curriculum_rec.stg_kaggle__topic t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)

SELECT 
    root_id_topic,
    TO_JSON_STRING(
        ARRAY_AGG(
            STRUCT(
                id_topic,
                id_topic_parent,
                val_topic_level,
                cat_topic_title
            )
        )
    ) AS row_json
FROM hierarchy
GROUP BY root_id_topic;;


[0m11:01:43.889662 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:1f6d5353-5301-431d-a5c1-ee02e104ea89&page=queryresults
[0m11:01:43.891132 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ";" at [40:24]; reason: invalidQuery, location: query, message: Syntax error: Unexpected ";" at [40:24]')
[0m11:01:44.330639 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:dd7a47e3-8798-4e01-9886-9cd4e04ac302&page=queryresults
[0m11:01:44.332135 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:dd7a47e3-8798-4e01-9886-9cd4e04ac302&page=queryresults
[0m11:01:44.345326 [debug] [Thread-1 (]: Database Error in model wip (models/intermediate/education/wip.sql)
  Syntax error: Unexpected ";" at [40:24]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m11:01:44.346868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7410f1e-a6a2-4112-87c1-ba72329746b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b52ea10>]}
[0m11:01:44.347446 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_curriculum_rec.wip .................... [[31mERROR[0m in 0.89s]
[0m11:01:44.347915 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.wip
[0m11:01:44.349425 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:01:44.349649 [debug] [MainThread]: Connection 'model.curriculum_rec.wip' was properly closed.
[0m11:01:44.349867 [info ] [MainThread]: 
[0m11:01:44.350091 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.93 seconds (1.93s).
[0m11:01:44.350537 [debug] [MainThread]: Command end result
[0m11:01:44.375055 [info ] [MainThread]: 
[0m11:01:44.375317 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:01:44.375492 [info ] [MainThread]: 
[0m11:01:44.375696 [error] [MainThread]:   Database Error in model wip (models/intermediate/education/wip.sql)
  Syntax error: Unexpected ";" at [40:24]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m11:01:44.375858 [info ] [MainThread]: 
[0m11:01:44.376020 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:01:44.377207 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.528587, "process_user_time": 1.210629, "process_kernel_time": 0.162167, "process_mem_max_rss": "210550784", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:01:44.377492 [debug] [MainThread]: Command `dbt run` failed at 11:01:44.377440 after 2.53 seconds
[0m11:01:44.377690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10594d7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10594ddd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b745dd0>]}
[0m11:01:44.377882 [debug] [MainThread]: Flushing usage events
[0m11:01:49.433269 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m11:02:24.146677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105962c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059e4fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059e5590>]}


============================== 11:02:24.148379 | 8fd16848-1f9f-4b03-9a27-d64b93880a08 ==============================
[0m11:02:24.148379 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:02:24.148651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'send_anonymous_usage_stats': 'True'}
[0m11:02:24.451929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fd16848-1f9f-4b03-9a27-d64b93880a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a987a10>]}
[0m11:02:24.471177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fd16848-1f9f-4b03-9a27-d64b93880a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f48f50>]}
[0m11:02:24.471410 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:02:24.483227 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:02:24.570090 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:02:24.570399 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/intermediate/education/wip.sql
[0m11:02:24.659215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fd16848-1f9f-4b03-9a27-d64b93880a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b48be10>]}
[0m11:02:24.699394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fd16848-1f9f-4b03-9a27-d64b93880a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b561410>]}
[0m11:02:24.699630 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 588 macros
[0m11:02:24.699782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fd16848-1f9f-4b03-9a27-d64b93880a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b372290>]}
[0m11:02:24.700600 [info ] [MainThread]: 
[0m11:02:24.700839 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:02:24.701234 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m11:02:24.701418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:25.040402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m11:02:25.041164 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:02:25.511141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fd16848-1f9f-4b03-9a27-d64b93880a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b305cd0>]}
[0m11:02:25.512300 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:02:25.512755 [info ] [MainThread]: 
[0m11:02:25.516523 [debug] [Thread-1 (]: Began running node model.curriculum_rec.wip
[0m11:02:25.517301 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_curriculum_rec.wip ............................. [RUN]
[0m11:02:25.517863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.wip)
[0m11:02:25.518238 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.wip
[0m11:02:25.526157 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.wip"
[0m11:02:25.526910 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.wip
[0m11:02:25.548352 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.wip"
[0m11:02:25.548831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:25.550021 [debug] [Thread-1 (]: On model.curriculum_rec.wip: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.wip"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`wip`
  OPTIONS()
  as WITH RECURSIVE hierarchy AS (
    SELECT 
        t1.id_topic, 
        t1.id_topic_parent, 
        t1.val_topic_level, 
        t1.cat_topic_title,
        t1.id_topic AS root_id_topic
    FROM  `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t1

    UNION ALL

    SELECT 
        t2.id_topic, 
        t2.id_topic_parent, 
        t2.val_topic_level, 
        t2.cat_topic_title,
        h.root_id_topic
    FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic` t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)

SELECT 
    root_id_topic,
    TO_JSON_STRING(
        ARRAY_AGG(
            STRUCT(
                id_topic,
                id_topic_parent,
                val_topic_level,
                cat_topic_title
            )
        )
    ) AS row_json
FROM hierarchy
GROUP BY root_id_topic;;


[0m11:02:25.893164 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:0f9255df-8848-4b06-aa5e-f51f6c0854be&page=queryresults
[0m11:02:25.895191 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ";" at [40:24]; reason: invalidQuery, location: query, message: Syntax error: Unexpected ";" at [40:24]')
[0m11:02:26.768256 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:3379e90b-802f-45eb-85f5-2bdb175bcc89&page=queryresults
[0m11:02:26.770452 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:3379e90b-802f-45eb-85f5-2bdb175bcc89&page=queryresults
[0m11:02:26.779058 [debug] [Thread-1 (]: Database Error in model wip (models/intermediate/education/wip.sql)
  Syntax error: Unexpected ";" at [40:24]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m11:02:26.780752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fd16848-1f9f-4b03-9a27-d64b93880a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075528d0>]}
[0m11:02:26.781415 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_curriculum_rec.wip .................... [[31mERROR[0m in 1.26s]
[0m11:02:26.781951 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.wip
[0m11:02:26.783759 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:02:26.784089 [debug] [MainThread]: Connection 'model.curriculum_rec.wip' was properly closed.
[0m11:02:26.784390 [info ] [MainThread]: 
[0m11:02:26.784680 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.08 seconds (2.08s).
[0m11:02:26.785208 [debug] [MainThread]: Command end result
[0m11:02:26.811234 [info ] [MainThread]: 
[0m11:02:26.811493 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:02:26.811658 [info ] [MainThread]: 
[0m11:02:26.811848 [error] [MainThread]:   Database Error in model wip (models/intermediate/education/wip.sql)
  Syntax error: Unexpected ";" at [40:24]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/wip.sql
[0m11:02:26.812006 [info ] [MainThread]: 
[0m11:02:26.812163 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:02:26.813366 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.6910255, "process_user_time": 1.220123, "process_kernel_time": 0.163359, "process_mem_max_rss": "210960384", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:02:26.813650 [debug] [MainThread]: Command `dbt run` failed at 11:02:26.813602 after 2.69 seconds
[0m11:02:26.813852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059e5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049a4390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10557c8d0>]}
[0m11:02:26.814036 [debug] [MainThread]: Flushing usage events
[0m11:03:20.024388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f8b090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10700cc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10700d290>]}


============================== 11:03:20.026163 | 7db642d8-cb01-40e3-9f52-2643763405cb ==============================
[0m11:03:20.026163 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:03:20.026435 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select models/intermediate/education/wip.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:03:20.332332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7db642d8-cb01-40e3-9f52-2643763405cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fb70d0>]}
[0m11:03:20.351479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7db642d8-cb01-40e3-9f52-2643763405cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105569550>]}
[0m11:03:20.351714 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:03:20.362328 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:03:20.447624 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:03:20.447934 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/intermediate/education/wip.sql
[0m11:03:20.536407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7db642d8-cb01-40e3-9f52-2643763405cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c748610>]}
[0m11:03:20.576679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7db642d8-cb01-40e3-9f52-2643763405cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc18250>]}
[0m11:03:20.576894 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 588 macros
[0m11:03:20.577045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7db642d8-cb01-40e3-9f52-2643763405cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7ea750>]}
[0m11:03:20.577857 [info ] [MainThread]: 
[0m11:03:20.578085 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:03:20.578465 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m11:03:20.578650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:03:20.915710 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m11:03:20.916575 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:03:21.285755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7db642d8-cb01-40e3-9f52-2643763405cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb94690>]}
[0m11:03:21.287008 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:03:21.287533 [info ] [MainThread]: 
[0m11:03:21.291064 [debug] [Thread-1 (]: Began running node model.curriculum_rec.wip
[0m11:03:21.292021 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_curriculum_rec.wip ............................. [RUN]
[0m11:03:21.292910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.wip)
[0m11:03:21.293337 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.wip
[0m11:03:21.300581 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.wip"
[0m11:03:21.301396 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.wip
[0m11:03:21.323688 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.wip"
[0m11:03:21.324249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:03:21.325380 [debug] [Thread-1 (]: On model.curriculum_rec.wip: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.wip"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`wip`
  OPTIONS()
  as WITH RECURSIVE hierarchy AS (
    SELECT 
        t1.id_topic, 
        t1.id_topic_parent, 
        t1.val_topic_level, 
        t1.cat_topic_title,
        t1.id_topic AS root_id_topic
    FROM dbt_curriculum_rec.stg_kaggle__topic t1

    UNION ALL

    SELECT 
        t2.id_topic, 
        t2.id_topic_parent, 
        t2.val_topic_level, 
        t2.cat_topic_title,
        h.root_id_topic
    FROM dbt_curriculum_rec.stg_kaggle__topic t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
SELECT 
    root_id_topic,
    TO_JSON_STRING(
        ARRAY_AGG(
            STRUCT(
                id_topic,
                id_topic_parent,
                val_topic_level,
                cat_topic_title
            )
        )
    ) AS row_json
FROM hierarchy
GROUP BY root_id_topic;


[0m11:03:22.150287 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:18864b7b-3ed6-49fd-bfcf-24d7804bc584&page=queryresults
[0m11:03:22.562648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7db642d8-cb01-40e3-9f52-2643763405cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc06750>]}
[0m11:03:22.563425 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_curriculum_rec.wip ........................ [[32mCREATE VIEW (0 processed)[0m in 1.27s]
[0m11:03:22.563919 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.wip
[0m11:03:22.565049 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:03:22.565345 [debug] [MainThread]: Connection 'model.curriculum_rec.wip' was properly closed.
[0m11:03:22.565594 [info ] [MainThread]: 
[0m11:03:22.565838 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.99 seconds (1.99s).
[0m11:03:22.566315 [debug] [MainThread]: Command end result
[0m11:03:22.589914 [info ] [MainThread]: 
[0m11:03:22.590173 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:03:22.590339 [info ] [MainThread]: 
[0m11:03:22.590503 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:03:22.591754 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5919044, "process_user_time": 1.221132, "process_kernel_time": 0.161178, "process_mem_max_rss": "209059840", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:03:22.592042 [debug] [MainThread]: Command `dbt run` succeeded at 11:03:22.591993 after 2.59 seconds
[0m11:03:22.592236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fe48d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cce2c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bc9c90>]}
[0m11:03:22.592423 [debug] [MainThread]: Flushing usage events
[0m11:23:07.212320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111057b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110d8950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110d8f90>]}


============================== 11:23:07.214673 | 5253fd7b-9ec0-4c9e-8367-8e09259295f8 ==============================
[0m11:23:07.214673 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:23:07.214950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select models/intermediate/education/int_topic_generate_hierarchy.sql', 'send_anonymous_usage_stats': 'True'}
[0m11:23:07.725786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5253fd7b-9ec0-4c9e-8367-8e09259295f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12042ebd0>]}
[0m11:23:07.744862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5253fd7b-9ec0-4c9e-8367-8e09259295f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120416150>]}
[0m11:23:07.745098 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:23:07.757642 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:23:07.860572 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 2 files changed.
[0m11:23:07.860858 [debug] [MainThread]: Partial parsing: added file: curriculum_rec://models/intermediate/education/int_topic_generate_hierarchy.sql
[0m11:23:07.860985 [debug] [MainThread]: Partial parsing: deleted file: curriculum_rec://models/intermediate/education/wip.sql
[0m11:23:07.861135 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://macros/generate_topic_hierarchy.sql
[0m11:23:07.861283 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/marts/education/content.sql
[0m11:23:07.949454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5253fd7b-9ec0-4c9e-8367-8e09259295f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121041390>]}
[0m11:23:07.992552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5253fd7b-9ec0-4c9e-8367-8e09259295f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121129f50>]}
[0m11:23:07.992767 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m11:23:07.992914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5253fd7b-9ec0-4c9e-8367-8e09259295f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120717510>]}
[0m11:23:07.993708 [info ] [MainThread]: 
[0m11:23:07.993927 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:23:07.994285 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m11:23:07.994461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:23:08.414175 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m11:23:08.414876 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:08.788366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5253fd7b-9ec0-4c9e-8367-8e09259295f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12049d3d0>]}
[0m11:23:08.789624 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:23:08.790151 [info ] [MainThread]: 
[0m11:23:08.794412 [debug] [Thread-1 (]: Began running node model.curriculum_rec.int_topic_generate_hierarchy
[0m11:23:08.795154 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_curriculum_rec.int_topic_generate_hierarchy .... [RUN]
[0m11:23:08.795771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.int_topic_generate_hierarchy)
[0m11:23:08.796266 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.int_topic_generate_hierarchy
[0m11:23:08.802994 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.int_topic_generate_hierarchy"
[0m11:23:08.803773 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.int_topic_generate_hierarchy
[0m11:23:08.825616 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.int_topic_generate_hierarchy"
[0m11:23:08.826096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:08.827252 [debug] [Thread-1 (]: On model.curriculum_rec.int_topic_generate_hierarchy: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.int_topic_generate_hierarchy"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`int_topic_generate_hierarchy`
  OPTIONS()
  as WITH RECURSIVE hierarchy AS (
    SELECT 
        t1.id_topic, 
        t1.id_topic_parent, 
        t1.val_topic_level, 
        t1.cat_topic_title,
        t1.id_topic AS root_id_topic
    FROM dbt_curriculum_rec.stg_kaggle__topic t1

    UNION ALL

    SELECT 
        t2.id_topic, 
        t2.id_topic_parent, 
        t2.val_topic_level, 
        t2.cat_topic_title,
        h.root_id_topic
    FROM dbt_curriculum_rec.stg_kaggle__topic t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
SELECT 
    root_id_topic as id_topic,
    TO_JSON_STRING(
        ARRAY_AGG(
            STRUCT(
                id_topic,
                id_topic_parent,
                val_topic_level,
                cat_topic_title
            )
        )
    ) AS json_hierarchy
FROM hierarchy
GROUP BY root_id_topic;


[0m11:23:09.588599 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:c6cf4fac-f608-4181-a860-c3dc5473f23b&page=queryresults
[0m11:23:10.071926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5253fd7b-9ec0-4c9e-8367-8e09259295f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121212050>]}
[0m11:23:10.072660 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_curriculum_rec.int_topic_generate_hierarchy  [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m11:23:10.073158 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.int_topic_generate_hierarchy
[0m11:23:10.074256 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:23:10.074497 [debug] [MainThread]: Connection 'model.curriculum_rec.int_topic_generate_hierarchy' was properly closed.
[0m11:23:10.074729 [info ] [MainThread]: 
[0m11:23:10.074964 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.08 seconds (2.08s).
[0m11:23:10.075442 [debug] [MainThread]: Command end result
[0m11:23:10.099034 [info ] [MainThread]: 
[0m11:23:10.099275 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:23:10.099433 [info ] [MainThread]: 
[0m11:23:10.099595 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:23:10.101057 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.9150586, "process_user_time": 1.238167, "process_kernel_time": 0.201345, "process_mem_max_rss": "209059840", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:23:10.101328 [debug] [MainThread]: Command `dbt run` succeeded at 11:23:10.101282 after 2.92 seconds
[0m11:23:10.101508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110a68d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110a7090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ff9c90>]}
[0m11:23:10.101680 [debug] [MainThread]: Flushing usage events
[0m11:23:58.281039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104feb550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10506ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10506d0d0>]}


============================== 11:23:58.283750 | ac96d923-7428-44ee-835e-1135ff276b23 ==============================
[0m11:23:58.283750 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:23:58.284047 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:23:58.713644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac96d923-7428-44ee-835e-1135ff276b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4b7490>]}
[0m11:23:58.733334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac96d923-7428-44ee-835e-1135ff276b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc90fd0>]}
[0m11:23:58.734189 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:23:58.745803 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:23:58.852756 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:23:58.852984 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:23:58.869955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac96d923-7428-44ee-835e-1135ff276b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cee9d90>]}
[0m11:23:58.916974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac96d923-7428-44ee-835e-1135ff276b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5e0290>]}
[0m11:23:58.917209 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m11:23:58.917356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac96d923-7428-44ee-835e-1135ff276b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a71e10>]}
[0m11:23:58.918165 [info ] [MainThread]: 
[0m11:23:58.918409 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:23:58.919987 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m11:23:58.920151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:23:59.233199 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m11:23:59.234160 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:59.682119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac96d923-7428-44ee-835e-1135ff276b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103599610>]}
[0m11:23:59.683354 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:23:59.683843 [info ] [MainThread]: 
[0m11:23:59.689564 [debug] [Thread-1 (]: Began running node model.curriculum_rec.int_topic_generate_hierarchy
[0m11:23:59.690326 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_curriculum_rec.int_topic_generate_hierarchy .... [RUN]
[0m11:23:59.690923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.int_topic_generate_hierarchy)
[0m11:23:59.691267 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.int_topic_generate_hierarchy
[0m11:23:59.699193 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.int_topic_generate_hierarchy"
[0m11:23:59.700434 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.int_topic_generate_hierarchy
[0m11:23:59.721606 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.int_topic_generate_hierarchy"
[0m11:23:59.722533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:59.723687 [debug] [Thread-1 (]: On model.curriculum_rec.int_topic_generate_hierarchy: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.int_topic_generate_hierarchy"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`int_topic_generate_hierarchy`
  OPTIONS()
  as WITH RECURSIVE hierarchy AS (
    SELECT 
        t1.id_topic, 
        t1.id_topic_parent, 
        t1.val_topic_level, 
        t1.cat_topic_title,
        t1.id_topic AS root_id_topic
    FROM dbt_curriculum_rec.stg_kaggle__topic t1

    UNION ALL

    SELECT 
        t2.id_topic, 
        t2.id_topic_parent, 
        t2.val_topic_level, 
        t2.cat_topic_title,
        h.root_id_topic
    FROM dbt_curriculum_rec.stg_kaggle__topic t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
SELECT 
    root_id_topic as id_topic,
    TO_JSON_STRING(
        ARRAY_AGG(
            STRUCT(
                id_topic,
                id_topic_parent,
                val_topic_level,
                cat_topic_title
            )
        )
    ) AS json_hierarchy
FROM hierarchy
GROUP BY root_id_topic;


[0m11:24:00.548712 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:4a43bf49-ad20-4958-a833-346c0a636953&page=queryresults
[0m11:24:01.190395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac96d923-7428-44ee-835e-1135ff276b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5cded0>]}
[0m11:24:01.191155 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_curriculum_rec.int_topic_generate_hierarchy  [[32mCREATE VIEW (0 processed)[0m in 1.50s]
[0m11:24:01.191656 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.int_topic_generate_hierarchy
[0m11:24:01.192016 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__content
[0m11:24:01.192510 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__content ............. [RUN]
[0m11:24:01.192870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.int_topic_generate_hierarchy, now model.curriculum_rec.stg_kaggle__content)
[0m11:24:01.193122 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__content
[0m11:24:01.195446 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__content"
[0m11:24:01.196831 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__content
[0m11:24:01.198695 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__content"
[0m11:24:01.199144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:24:01.200376 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__content.sql
WITH raw_content AS 
(
SELECT 
    id as id_content, 
    title as cat_content_title, 
    description as cat_content_description, 
    kind as cat_content_kind,
    text as cat_content_text,
    copyright_holder as cat_content_copyright_holder,
    license as id_content_license 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_content`
) 

SELECT 
    * 
FROM raw_content;


[0m11:24:01.879040 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:8363e67d-e470-4c31-8ede-043f38e2c4d6&page=queryresults
[0m11:24:02.263022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac96d923-7428-44ee-835e-1135ff276b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4fce10>]}
[0m11:24:02.264311 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__content ........ [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m11:24:02.265372 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__content
[0m11:24:02.265887 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__correl
[0m11:24:02.266584 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__correl .............. [RUN]
[0m11:24:02.267174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__content, now model.curriculum_rec.stg_kaggle__correl)
[0m11:24:02.267574 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__correl
[0m11:24:02.271342 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__correl"
[0m11:24:02.273533 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__correl
[0m11:24:02.276105 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__correl"
[0m11:24:02.276603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:24:02.278000 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__correl: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__correl"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__correl.sql
WITH raw_correl AS 
(
    SELECT 
    topic_id as id_topic, 
    -- probably can do some sort of transformation here it should be a list not a string --  
    -- sql doesn't natively use lists though -- 
    -- have to make the table better don't use lists -- 
    content_id as id_content 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_correlation`
)

SELECT 
    * 
FROM raw_correl;


[0m11:24:02.800123 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:7b8102e5-538c-4dcd-b5ad-e45239fc26e5&page=queryresults
[0m11:24:03.131221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac96d923-7428-44ee-835e-1135ff276b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd71790>]}
[0m11:24:03.132334 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__correl ......... [[32mCREATE VIEW (0 processed)[0m in 0.86s]
[0m11:24:03.133013 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__correl
[0m11:24:03.133746 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__topic
[0m11:24:03.134794 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__topic ............... [RUN]
[0m11:24:03.135352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__correl, now model.curriculum_rec.stg_kaggle__topic)
[0m11:24:03.135744 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__topic
[0m11:24:03.139345 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__topic"
[0m11:24:03.140167 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__topic
[0m11:24:03.142660 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__topic"
[0m11:24:03.143224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:24:03.144617 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__topic: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__topic"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__topics.sql
WITH raw_topics AS 
(
SELECT  
    id as id_topic, 
    title as cat_topic_title, 
    description as cat_topic_description, 
    channel as id_topic_description, 
    -- already encoded don't need to use case when -- 
    category as cat_topic_category, 
    level as val_topic_level, 
    parent as id_topic_parent, 
    has_content as ind_topic_has_content
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_topic`
) 

SELECT 
    *
FROM raw_topics;


[0m11:24:03.723555 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:3b525041-a8e0-4486-b686-a3c32ea16121&page=queryresults
[0m11:24:04.099361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac96d923-7428-44ee-835e-1135ff276b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d516850>]}
[0m11:24:04.100722 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__topic .......... [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m11:24:04.101348 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__topic
[0m11:24:04.101729 [debug] [Thread-1 (]: Began running node model.curriculum_rec.content
[0m11:24:04.102155 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt_curriculum_rec.content ......................... [RUN]
[0m11:24:04.102539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__topic, now model.curriculum_rec.content)
[0m11:24:04.102813 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.content
[0m11:24:04.105952 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.content"
[0m11:24:04.107593 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.content
[0m11:24:04.109445 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.content"
[0m11:24:04.109902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:24:04.111156 [debug] [Thread-1 (]: On model.curriculum_rec.content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`content`
  OPTIONS()
  as WITH 
content AS (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
)

correlation AS (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
)

hierarchy AS (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`int_topic_generate_hierarchy`
)

combined_content AS ( 
    SELECT content.*, correlation.id_topic, hierarchy.json_hierarchy
    FROM content 
    LEFT OUTER JOIN correlation ON content.id_content = correlation.id_content
    LEFT OUTER JOIN hierarchy ON correlation.id_topic = hierarchy.id_topic
);


[0m11:24:04.440130 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:a93a5409-ecb4-487a-901e-6e8fa554d70c&page=queryresults
[0m11:24:04.441553 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected identifier "correlation" at [11:1]; reason: invalidQuery, location: query, message: Syntax error: Unexpected identifier "correlation" at [11:1]')
[0m11:24:05.061141 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:cab386ac-1490-42e3-ac11-204c698f02ce&page=queryresults
[0m11:24:05.062732 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:cab386ac-1490-42e3-ac11-204c698f02ce&page=queryresults
[0m11:24:05.074641 [debug] [Thread-1 (]: Database Error in model content (models/marts/education/content.sql)
  Syntax error: Unexpected identifier "correlation" at [11:1]
  compiled Code at target/run/curriculum_rec/models/marts/education/content.sql
[0m11:24:05.075273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac96d923-7428-44ee-835e-1135ff276b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8f1690>]}
[0m11:24:05.075920 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model dbt_curriculum_rec.content ................ [[31mERROR[0m in 0.97s]
[0m11:24:05.076433 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.content
[0m11:24:05.078188 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:24:05.078473 [debug] [MainThread]: Connection 'model.curriculum_rec.content' was properly closed.
[0m11:24:05.078769 [info ] [MainThread]: 
[0m11:24:05.079022 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 6.16 seconds (6.16s).
[0m11:24:05.079920 [debug] [MainThread]: Command end result
[0m11:24:05.106649 [info ] [MainThread]: 
[0m11:24:05.106899 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:24:05.107062 [info ] [MainThread]: 
[0m11:24:05.107257 [error] [MainThread]:   Database Error in model content (models/marts/education/content.sql)
  Syntax error: Unexpected identifier "correlation" at [11:1]
  compiled Code at target/run/curriculum_rec/models/marts/education/content.sql
[0m11:24:05.107418 [info ] [MainThread]: 
[0m11:24:05.107582 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m11:24:05.108950 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.8540215, "process_user_time": 1.50016, "process_kernel_time": 0.208714, "process_mem_max_rss": "205635584", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:24:05.109229 [debug] [MainThread]: Command `dbt run` failed at 11:24:05.109183 after 6.85 seconds
[0m11:24:05.109427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10503aed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de0ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100b85510>]}
[0m11:24:05.109597 [debug] [MainThread]: Flushing usage events
[0m11:42:42.963849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa3990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109025350>]}


============================== 11:42:42.966191 | b363dadb-b00b-42a8-a4b6-8781749a5ff3 ==============================
[0m11:42:42.966191 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:42:42.966476 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:42:43.475202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b363dadb-b00b-42a8-a4b6-8781749a5ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccda110>]}
[0m11:42:43.494270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b363dadb-b00b-42a8-a4b6-8781749a5ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6aa9d0>]}
[0m11:42:43.494505 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:42:43.506372 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:42:43.580541 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:42:43.580830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b363dadb-b00b-42a8-a4b6-8781749a5ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9c9e90>]}
[0m11:42:44.134585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b363dadb-b00b-42a8-a4b6-8781749a5ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8d66d0>]}
[0m11:42:44.178086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b363dadb-b00b-42a8-a4b6-8781749a5ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee70a50>]}
[0m11:42:44.178300 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m11:42:44.178445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b363dadb-b00b-42a8-a4b6-8781749a5ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eab7510>]}
[0m11:42:44.179246 [info ] [MainThread]: 
[0m11:42:44.179459 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:42:44.181029 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m11:42:44.181199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:42:44.573754 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m11:42:44.574615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:42:45.023939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b363dadb-b00b-42a8-a4b6-8781749a5ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec401d0>]}
[0m11:42:45.024907 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:42:45.025330 [info ] [MainThread]: 
[0m11:42:45.030860 [debug] [Thread-1 (]: Began running node model.curriculum_rec.int_topic_generate_hierarchy
[0m11:42:45.031472 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_curriculum_rec.int_topic_generate_hierarchy .... [RUN]
[0m11:42:45.031940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.int_topic_generate_hierarchy)
[0m11:42:45.032273 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.int_topic_generate_hierarchy
[0m11:42:45.038482 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.int_topic_generate_hierarchy"
[0m11:42:45.039116 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.int_topic_generate_hierarchy
[0m11:42:45.059170 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.int_topic_generate_hierarchy"
[0m11:42:45.059610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:45.060654 [debug] [Thread-1 (]: On model.curriculum_rec.int_topic_generate_hierarchy: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.int_topic_generate_hierarchy"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`int_topic_generate_hierarchy`
  OPTIONS()
  as WITH RECURSIVE hierarchy AS (
    SELECT 
        t1.id_topic, 
        t1.id_topic_parent, 
        t1.val_topic_level, 
        t1.topic_title,
        t1.id_topic AS root_id_topic
    FROM dbt_curriculum_rec.stg_kaggle__topic t1

    UNION ALL

    SELECT 
        t2.id_topic, 
        t2.id_topic_parent, 
        t2.val_topic_level, 
        t2.topic_title,
        h.root_id_topic
    FROM dbt_curriculum_rec.stg_kaggle__topic t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
SELECT 
    root_id_topic as id_topic,
    TO_JSON_STRING(
        ARRAY_AGG(
            STRUCT(
                id_topic,
                id_topic_parent,
                val_topic_level,
                topic_title
            )
        )
    ) AS json_hierarchy
FROM hierarchy
GROUP BY root_id_topic;


[0m11:42:45.776452 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:f3ab2ff4-f212-445f-9ceb-d6ebc7a1c0ab&page=queryresults
[0m11:42:45.943257 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name topic_title not found inside t1 at [11:12]; reason: invalidQuery, location: query, message: Name topic_title not found inside t1 at [11:12]')
[0m11:42:46.559232 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:d73ad38b-58af-4b11-bb08-14081e37577e&page=queryresults
[0m11:42:46.707995 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:d73ad38b-58af-4b11-bb08-14081e37577e&page=queryresults
[0m11:42:46.720501 [debug] [Thread-1 (]: Database Error in model int_topic_generate_hierarchy (models/intermediate/education/int_topic_generate_hierarchy.sql)
  Name topic_title not found inside t1 at [11:12]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/int_topic_generate_hierarchy.sql
[0m11:42:46.721829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b363dadb-b00b-42a8-a4b6-8781749a5ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7f6a50>]}
[0m11:42:46.722338 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model dbt_curriculum_rec.int_topic_generate_hierarchy  [[31mERROR[0m in 1.69s]
[0m11:42:46.722759 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.int_topic_generate_hierarchy
[0m11:42:46.723054 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__content
[0m11:42:46.723922 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__content ............. [RUN]
[0m11:42:46.724306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.int_topic_generate_hierarchy, now model.curriculum_rec.stg_kaggle__content)
[0m11:42:46.724553 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__content
[0m11:42:46.727401 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__content"
[0m11:42:46.727869 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__content
[0m11:42:46.729593 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__content"
[0m11:42:46.729951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:46.730949 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__content.sql
WITH raw_content AS 
(
SELECT 
    id as id_content, 
    title as content_title, 
    description as content_description, 
    kind as cat_content_kind,
    text as content_text,
    copyright_holder as content_copyright_holder,
    license as id_content_license 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_content`
) 

SELECT 
    * 
FROM raw_content;


[0m11:42:47.319894 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:7f2039a2-5305-4879-88bb-c3623f67b19a&page=queryresults
[0m11:42:47.865705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b363dadb-b00b-42a8-a4b6-8781749a5ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eda2510>]}
[0m11:42:47.866432 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__content ........ [[32mCREATE VIEW (0 processed)[0m in 1.14s]
[0m11:42:47.866925 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__content
[0m11:42:47.867262 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__correl
[0m11:42:47.867711 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__correl .............. [RUN]
[0m11:42:47.868133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__content, now model.curriculum_rec.stg_kaggle__correl)
[0m11:42:47.868421 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__correl
[0m11:42:47.870840 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__correl"
[0m11:42:47.871499 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__correl
[0m11:42:47.873335 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__correl"
[0m11:42:47.873796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:47.874989 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__correl: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__correl"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__correl.sql
WITH raw_correl AS 
(
    SELECT 
    topic_id as id_topic, 
    -- probably can do some sort of transformation here it should be a list not a string --  
    -- sql doesn't natively use lists though -- 
    -- have to make the table better don't use lists -- 
    content_id as id_content 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_correlation`
)

SELECT 
    * 
FROM raw_correl;


[0m11:42:48.504802 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:be8c076b-a424-4cfb-ba6a-f1bf291bbdec&page=queryresults
[0m11:42:48.983209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b363dadb-b00b-42a8-a4b6-8781749a5ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee4e0d0>]}
[0m11:42:48.984326 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__correl ......... [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m11:42:48.984987 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__correl
[0m11:42:48.985471 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__topic
[0m11:42:48.986127 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__topic ............... [RUN]
[0m11:42:48.986785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__correl, now model.curriculum_rec.stg_kaggle__topic)
[0m11:42:48.987103 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__topic
[0m11:42:48.992783 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__topic"
[0m11:42:48.993546 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__topic
[0m11:42:48.995762 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__topic"
[0m11:42:48.996286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:48.997689 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__topic: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__topic"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__topics.sql
WITH raw_topics AS 
(
SELECT  
    id as id_topic, 
    title as topic_title, 
    description as topic_description, 
    channel as id_topic_description, 
    -- already encoded don't need to use case when -- 
    category as cat_topic_category, 
    level as val_topic_level, 
    parent as id_topic_parent, 
    has_content as ind_topic_has_content
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_topic`
) 

SELECT 
    *
FROM raw_topics;


[0m11:42:49.526721 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:79966b7d-9ad9-49fa-8732-fd64e29f6cc4&page=queryresults
[0m11:42:49.905415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b363dadb-b00b-42a8-a4b6-8781749a5ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecca7d0>]}
[0m11:42:49.907003 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__topic .......... [[32mCREATE VIEW (0 processed)[0m in 0.92s]
[0m11:42:49.908168 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__topic
[0m11:42:49.908746 [debug] [Thread-1 (]: Began running node model.curriculum_rec.content
[0m11:42:49.909313 [info ] [Thread-1 (]: 5 of 5 SKIP relation dbt_curriculum_rec.content ................................ [[33mSKIP[0m]
[0m11:42:49.909933 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.content
[0m11:42:49.911709 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:42:49.912083 [debug] [MainThread]: Connection 'model.curriculum_rec.stg_kaggle__topic' was properly closed.
[0m11:42:49.912496 [info ] [MainThread]: 
[0m11:42:49.912950 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.73 seconds (5.73s).
[0m11:42:49.914217 [debug] [MainThread]: Command end result
[0m11:42:49.942099 [info ] [MainThread]: 
[0m11:42:49.942353 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:42:49.942527 [info ] [MainThread]: 
[0m11:42:49.942894 [error] [MainThread]:   Database Error in model int_topic_generate_hierarchy (models/intermediate/education/int_topic_generate_hierarchy.sql)
  Name topic_title not found inside t1 at [11:12]
  compiled Code at target/run/curriculum_rec/models/intermediate/education/int_topic_generate_hierarchy.sql
[0m11:42:49.943232 [info ] [MainThread]: 
[0m11:42:49.943436 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m11:42:49.945577 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.007189, "process_user_time": 1.904915, "process_kernel_time": 0.236069, "process_mem_max_rss": "215908352", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:42:49.945936 [debug] [MainThread]: Command `dbt run` failed at 11:42:49.945878 after 7.01 seconds
[0m11:42:49.946152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109025150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ffc8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b3d510>]}
[0m11:42:49.946356 [debug] [MainThread]: Flushing usage events
[0m11:44:08.149827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094377d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094b8b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094b9150>]}


============================== 11:44:08.151450 | fcc6bfa4-0851-4fa3-8fdb-3b7bb6a14b47 ==============================
[0m11:44:08.151450 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:44:08.151722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'debug': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:44:08.457099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcc6bfa4-0851-4fa3-8fdb-3b7bb6a14b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e869110>]}
[0m11:44:08.476202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcc6bfa4-0851-4fa3-8fdb-3b7bb6a14b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a1cf90>]}
[0m11:44:08.476442 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:44:08.486744 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:44:08.571279 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:44:08.571499 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:44:08.588601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcc6bfa4-0851-4fa3-8fdb-3b7bb6a14b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eddb350>]}
[0m11:44:08.630036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcc6bfa4-0851-4fa3-8fdb-3b7bb6a14b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eda8f90>]}
[0m11:44:08.630258 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m11:44:08.630410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcc6bfa4-0851-4fa3-8fdb-3b7bb6a14b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee1edd0>]}
[0m11:44:08.631203 [info ] [MainThread]: 
[0m11:44:08.631433 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:44:08.633019 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m11:44:08.633190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:44:09.095512 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m11:44:09.096299 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:44:09.439951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcc6bfa4-0851-4fa3-8fdb-3b7bb6a14b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5b9fd0>]}
[0m11:44:09.440890 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:44:09.441667 [info ] [MainThread]: 
[0m11:44:09.446088 [debug] [Thread-1 (]: Began running node model.curriculum_rec.int_topic_generate_hierarchy
[0m11:44:09.446631 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_curriculum_rec.int_topic_generate_hierarchy .... [RUN]
[0m11:44:09.447118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.int_topic_generate_hierarchy)
[0m11:44:09.447450 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.int_topic_generate_hierarchy
[0m11:44:09.455068 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.int_topic_generate_hierarchy"
[0m11:44:09.455756 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.int_topic_generate_hierarchy
[0m11:44:09.475982 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.int_topic_generate_hierarchy"
[0m11:44:09.476391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:09.477366 [debug] [Thread-1 (]: On model.curriculum_rec.int_topic_generate_hierarchy: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.int_topic_generate_hierarchy"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`int_topic_generate_hierarchy`
  OPTIONS()
  as WITH RECURSIVE hierarchy AS (
    SELECT 
        t1.id_topic, 
        t1.id_topic_parent, 
        t1.val_topic_level, 
        t1.topic_title,
        t1.id_topic AS root_id_topic
    FROM dbt_curriculum_rec.stg_kaggle__topic t1

    UNION ALL

    SELECT 
        t2.id_topic, 
        t2.id_topic_parent, 
        t2.val_topic_level, 
        t2.topic_title,
        h.root_id_topic
    FROM dbt_curriculum_rec.stg_kaggle__topic t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
SELECT 
    root_id_topic as id_topic,
    TO_JSON_STRING(
        ARRAY_AGG(
            STRUCT(
                id_topic,
                id_topic_parent,
                val_topic_level,
                topic_title
            )
        )
    ) AS json_hierarchy
FROM hierarchy
GROUP BY root_id_topic;


[0m11:44:10.219759 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:e76cd89a-adb6-41e9-8ed7-0e2daf22ee3c&page=queryresults
[0m11:44:10.852859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6bfa4-0851-4fa3-8fdb-3b7bb6a14b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef224d0>]}
[0m11:44:10.853612 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_curriculum_rec.int_topic_generate_hierarchy  [[32mCREATE VIEW (0 processed)[0m in 1.41s]
[0m11:44:10.854104 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.int_topic_generate_hierarchy
[0m11:44:10.854447 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__content
[0m11:44:10.854915 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__content ............. [RUN]
[0m11:44:10.855345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.int_topic_generate_hierarchy, now model.curriculum_rec.stg_kaggle__content)
[0m11:44:10.855634 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__content
[0m11:44:10.858006 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__content"
[0m11:44:10.858635 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__content
[0m11:44:10.860453 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__content"
[0m11:44:10.860891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:10.862156 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__content.sql
WITH raw_content AS 
(
SELECT 
    id as id_content, 
    title as content_title, 
    description as content_description, 
    kind as cat_content_kind,
    text as content_text,
    copyright_holder as content_copyright_holder,
    license as id_content_license 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_content`
) 

SELECT 
    * 
FROM raw_content;


[0m11:44:11.448317 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:cfdee007-0a79-44f1-bed9-e567052f6bf5&page=queryresults
[0m11:44:11.904869 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6bfa4-0851-4fa3-8fdb-3b7bb6a14b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efc7690>]}
[0m11:44:11.906300 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__content ........ [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m11:44:11.907214 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__content
[0m11:44:11.907722 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__correl
[0m11:44:11.908213 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__correl .............. [RUN]
[0m11:44:11.908646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__content, now model.curriculum_rec.stg_kaggle__correl)
[0m11:44:11.908911 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__correl
[0m11:44:11.911488 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__correl"
[0m11:44:11.912094 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__correl
[0m11:44:11.914079 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__correl"
[0m11:44:11.914537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:11.915764 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__correl: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__correl"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__correl.sql
WITH raw_correl AS 
(
    SELECT 
    topic_id as id_topic, 
    -- probably can do some sort of transformation here it should be a list not a string --  
    -- sql doesn't natively use lists though -- 
    -- have to make the table better don't use lists -- 
    content_id as id_content 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_correlation`
)

SELECT 
    * 
FROM raw_correl;


[0m11:44:12.577804 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:3b12c268-f23f-44f1-88e9-e5b09c799067&page=queryresults
[0m11:44:12.987766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6bfa4-0851-4fa3-8fdb-3b7bb6a14b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f09e150>]}
[0m11:44:12.989045 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__correl ......... [[32mCREATE VIEW (0 processed)[0m in 1.08s]
[0m11:44:12.989896 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__correl
[0m11:44:12.990296 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__topic
[0m11:44:12.990780 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__topic ............... [RUN]
[0m11:44:12.991263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__correl, now model.curriculum_rec.stg_kaggle__topic)
[0m11:44:12.991629 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__topic
[0m11:44:12.994590 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__topic"
[0m11:44:12.995330 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__topic
[0m11:44:12.997483 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__topic"
[0m11:44:12.998013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:12.999364 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__topic: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__topic"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__topics.sql
WITH raw_topics AS 
(
SELECT  
    id as id_topic, 
    title as topic_title, 
    description as topic_description, 
    channel as id_topic_description, 
    -- already encoded don't need to use case when -- 
    category as cat_topic_category, 
    level as val_topic_level, 
    parent as id_topic_parent, 
    has_content as ind_topic_has_content
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_topic`
) 

SELECT 
    *
FROM raw_topics;


[0m11:44:13.496655 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:cfc59443-e360-49b8-8185-88565fed2f2a&page=queryresults
[0m11:44:13.830937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6bfa4-0851-4fa3-8fdb-3b7bb6a14b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f088350>]}
[0m11:44:13.832769 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__topic .......... [[32mCREATE VIEW (0 processed)[0m in 0.84s]
[0m11:44:13.833853 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__topic
[0m11:44:13.834350 [debug] [Thread-1 (]: Began running node model.curriculum_rec.content
[0m11:44:13.835214 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt_curriculum_rec.content ......................... [RUN]
[0m11:44:13.835741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__topic, now model.curriculum_rec.content)
[0m11:44:13.836000 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.content
[0m11:44:13.838848 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.content"
[0m11:44:13.839477 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.content
[0m11:44:13.841285 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.content"
[0m11:44:13.841667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:13.842794 [debug] [Thread-1 (]: On model.curriculum_rec.content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`content`
  OPTIONS()
  as WITH 
content AS (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
)

correlation AS (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
)

hierarchy AS (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`int_topic_generate_hierarchy`
)

combined_content AS ( 
    SELECT content.*, correlation.id_topic, hierarchy.json_hierarchy
    FROM content 
    LEFT OUTER JOIN correlation ON content.id_content = correlation.id_content
    LEFT OUTER JOIN hierarchy ON correlation.id_topic = hierarchy.id_topic
);


[0m11:44:14.171144 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:4c5572f1-b269-4f29-ae2a-a861593bb272&page=queryresults
[0m11:44:14.172856 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected identifier "correlation" at [11:1]; reason: invalidQuery, location: query, message: Syntax error: Unexpected identifier "correlation" at [11:1]')
[0m11:44:15.184252 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:4bfe1bfa-d2ff-4a65-a51a-1507f7f1d7f9&page=queryresults
[0m11:44:15.186017 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:4bfe1bfa-d2ff-4a65-a51a-1507f7f1d7f9&page=queryresults
[0m11:44:15.194054 [debug] [Thread-1 (]: Database Error in model content (models/marts/education/content.sql)
  Syntax error: Unexpected identifier "correlation" at [11:1]
  compiled Code at target/run/curriculum_rec/models/marts/education/content.sql
[0m11:44:15.194719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6bfa4-0851-4fa3-8fdb-3b7bb6a14b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecc4c50>]}
[0m11:44:15.195379 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model dbt_curriculum_rec.content ................ [[31mERROR[0m in 1.36s]
[0m11:44:15.195893 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.content
[0m11:44:15.197775 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:44:15.198107 [debug] [MainThread]: Connection 'model.curriculum_rec.content' was properly closed.
[0m11:44:15.198452 [info ] [MainThread]: 
[0m11:44:15.198744 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 6.57 seconds (6.57s).
[0m11:44:15.199734 [debug] [MainThread]: Command end result
[0m11:44:15.227008 [info ] [MainThread]: 
[0m11:44:15.227249 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:44:15.227408 [info ] [MainThread]: 
[0m11:44:15.227600 [error] [MainThread]:   Database Error in model content (models/marts/education/content.sql)
  Syntax error: Unexpected identifier "correlation" at [11:1]
  compiled Code at target/run/curriculum_rec/models/marts/education/content.sql
[0m11:44:15.227759 [info ] [MainThread]: 
[0m11:44:15.227919 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m11:44:15.229091 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.1031194, "process_user_time": 1.457353, "process_kernel_time": 0.182989, "process_mem_max_rss": "206077952", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:44:15.229372 [debug] [MainThread]: Command `dbt run` failed at 11:44:15.229326 after 7.10 seconds
[0m11:44:15.229568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094b8dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fd1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fd1650>]}
[0m11:44:15.229748 [debug] [MainThread]: Flushing usage events
[0m11:48:48.276001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059aabd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a2cd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a2d390>]}


============================== 11:48:48.278002 | e02f919b-7446-4fa2-bfd9-fc4fc37b4857 ==============================
[0m11:48:48.278002 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:48:48.278277 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select models/marts/education/content.sql', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:48:48.583237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e02f919b-7446-4fa2-bfd9-fc4fc37b4857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab5a2d0>]}
[0m11:48:48.602411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e02f919b-7446-4fa2-bfd9-fc4fc37b4857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10754cad0>]}
[0m11:48:48.602643 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:48:48.613542 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:48:48.698866 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:48:48.699080 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:48:48.716232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e02f919b-7446-4fa2-bfd9-fc4fc37b4857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab2e250>]}
[0m11:48:48.757202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e02f919b-7446-4fa2-bfd9-fc4fc37b4857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b377990>]}
[0m11:48:48.757427 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m11:48:48.757575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e02f919b-7446-4fa2-bfd9-fc4fc37b4857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b399cd0>]}
[0m11:48:48.758339 [info ] [MainThread]: 
[0m11:48:48.758573 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:48:48.758967 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m11:48:48.759148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:49.168282 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m11:48:49.168936 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:48:49.575096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e02f919b-7446-4fa2-bfd9-fc4fc37b4857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b290a90>]}
[0m11:48:49.576250 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:48:49.576697 [info ] [MainThread]: 
[0m11:48:49.581387 [debug] [Thread-1 (]: Began running node model.curriculum_rec.content
[0m11:48:49.582058 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_curriculum_rec.content ......................... [RUN]
[0m11:48:49.582636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.content)
[0m11:48:49.582973 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.content
[0m11:48:49.592059 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.content"
[0m11:48:49.592756 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.content
[0m11:48:49.612749 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.content"
[0m11:48:49.613215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:49.614228 [debug] [Thread-1 (]: On model.curriculum_rec.content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`content`
  OPTIONS()
  as WITH 
content AS (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
)

correlation AS (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
)

hierarchy AS (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`int_topic_generate_hierarchy`
)

combined_content AS ( 
    SELECT content.*, correlation.id_topic, hierarchy.json_hierarchy
    FROM content 
    LEFT OUTER JOIN correlation ON content.id_content = correlation.id_content
    LEFT OUTER JOIN hierarchy ON correlation.id_topic = hierarchy.id_topic
);


[0m11:48:49.994918 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:daf199e2-14ea-42c4-adb2-f629b7fb171e&page=queryresults
[0m11:48:49.996426 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected identifier "correlation" at [11:1]; reason: invalidQuery, location: query, message: Syntax error: Unexpected identifier "correlation" at [11:1]')
[0m11:48:50.648745 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:c1c6e57e-a847-450b-b4a3-d97082396177&page=queryresults
[0m11:48:50.650988 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:c1c6e57e-a847-450b-b4a3-d97082396177&page=queryresults
[0m11:48:50.659211 [debug] [Thread-1 (]: Database Error in model content (models/marts/education/content.sql)
  Syntax error: Unexpected identifier "correlation" at [11:1]
  compiled Code at target/run/curriculum_rec/models/marts/education/content.sql
[0m11:48:50.660958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e02f919b-7446-4fa2-bfd9-fc4fc37b4857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b808b50>]}
[0m11:48:50.661635 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_curriculum_rec.content ................ [[31mERROR[0m in 1.08s]
[0m11:48:50.662184 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.content
[0m11:48:50.664003 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:48:50.664378 [debug] [MainThread]: Connection 'model.curriculum_rec.content' was properly closed.
[0m11:48:50.664673 [info ] [MainThread]: 
[0m11:48:50.664956 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.91 seconds (1.91s).
[0m11:48:50.665455 [debug] [MainThread]: Command end result
[0m11:48:50.691026 [info ] [MainThread]: 
[0m11:48:50.691288 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:48:50.691456 [info ] [MainThread]: 
[0m11:48:50.691650 [error] [MainThread]:   Database Error in model content (models/marts/education/content.sql)
  Syntax error: Unexpected identifier "correlation" at [11:1]
  compiled Code at target/run/curriculum_rec/models/marts/education/content.sql
[0m11:48:50.691806 [info ] [MainThread]: 
[0m11:48:50.691966 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:48:50.693143 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.441626, "process_user_time": 1.14479, "process_kernel_time": 0.159502, "process_mem_max_rss": "204832768", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:48:50.693423 [debug] [MainThread]: Command `dbt run` failed at 11:48:50.693377 after 2.44 seconds
[0m11:48:50.693625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a2d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a048d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1015456d0>]}
[0m11:48:50.693811 [debug] [MainThread]: Flushing usage events
[0m11:50:16.085699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c53650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd4c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd5290>]}


============================== 11:50:16.088022 | c5c322d1-3d70-46ba-a25a-67152285a80d ==============================
[0m11:50:16.088022 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:50:16.088315 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select models/marts/education/content.sql', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:50:16.407060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5c322d1-3d70-46ba-a25a-67152285a80d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce70d0>]}
[0m11:50:16.426324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5c322d1-3d70-46ba-a25a-67152285a80d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105239090>]}
[0m11:50:16.426568 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:50:16.439270 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:50:16.528275 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:50:16.528578 [debug] [MainThread]: Partial parsing: updated file: curriculum_rec://models/marts/education/content.sql
[0m11:50:16.614474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5c322d1-3d70-46ba-a25a-67152285a80d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e161cd0>]}
[0m11:50:16.654233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5c322d1-3d70-46ba-a25a-67152285a80d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddbc550>]}
[0m11:50:16.654446 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m11:50:16.654596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5c322d1-3d70-46ba-a25a-67152285a80d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1be9d0>]}
[0m11:50:16.655384 [info ] [MainThread]: 
[0m11:50:16.655609 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:50:16.655991 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m11:50:16.656184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:50:17.010100 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m11:50:17.010945 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:50:17.358631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5c322d1-3d70-46ba-a25a-67152285a80d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de5a150>]}
[0m11:50:17.359847 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:50:17.360323 [info ] [MainThread]: 
[0m11:50:17.363855 [debug] [Thread-1 (]: Began running node model.curriculum_rec.content
[0m11:50:17.364628 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_curriculum_rec.content ......................... [RUN]
[0m11:50:17.365286 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.curriculum_rec.content'
[0m11:50:17.365666 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.content
[0m11:50:17.373823 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.content"
[0m11:50:17.374631 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.content
[0m11:50:17.396638 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.content"
[0m11:50:17.397141 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:50:17.398191 [debug] [Thread-1 (]: On model.curriculum_rec.content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`content`
  OPTIONS()
  as WITH 
content AS (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
),

correlation AS (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
),

hierarchy AS (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`int_topic_generate_hierarchy`
),

combined_content AS ( 
    SELECT content.*, correlation.id_topic, hierarchy.json_hierarchy
    FROM content 
    LEFT OUTER JOIN correlation ON content.id_content = correlation.id_content
    LEFT OUTER JOIN hierarchy ON correlation.id_topic = hierarchy.id_topic
)

SELECT * FROM combined_content;


[0m11:50:18.099980 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:cc64fd14-f636-4185-a9c3-2976dc2cbd56&page=queryresults
[0m11:50:18.593536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5c322d1-3d70-46ba-a25a-67152285a80d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c7e450>]}
[0m11:50:18.594281 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_curriculum_rec.content .................... [[32mCREATE VIEW (0 processed)[0m in 1.23s]
[0m11:50:18.594778 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.content
[0m11:50:18.595801 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:50:18.596020 [debug] [MainThread]: Connection 'list_dbt-tutorial-428919_dbt_curriculum_rec' was properly closed.
[0m11:50:18.596217 [debug] [MainThread]: Connection 'model.curriculum_rec.content' was properly closed.
[0m11:50:18.596431 [info ] [MainThread]: 
[0m11:50:18.596661 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.94 seconds (1.94s).
[0m11:50:18.597110 [debug] [MainThread]: Command end result
[0m11:50:18.620332 [info ] [MainThread]: 
[0m11:50:18.620577 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:50:18.620741 [info ] [MainThread]: 
[0m11:50:18.620905 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:50:18.622096 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5608675, "process_user_time": 1.234992, "process_kernel_time": 0.170536, "process_mem_max_rss": "213303296", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:50:18.622372 [debug] [MainThread]: Command `dbt run` succeeded at 11:50:18.622325 after 2.56 seconds
[0m11:50:18.622560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102891c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1027ed6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1027ed5d0>]}
[0m11:50:18.622737 [debug] [MainThread]: Flushing usage events
[0m11:52:27.534147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fe2150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107064d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107065390>]}


============================== 11:52:27.535837 | 65737da6-f3fc-482f-aaab-807b260350d0 ==============================
[0m11:52:27.535837 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:52:27.536111 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:52:27.840825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65737da6-f3fc-482f-aaab-807b260350d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107013390>]}
[0m11:52:27.860073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65737da6-f3fc-482f-aaab-807b260350d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055cca50>]}
[0m11:52:27.860315 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:52:27.871006 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:52:27.944824 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:52:27.945112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '65737da6-f3fc-482f-aaab-807b260350d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ca0150>]}
[0m11:52:28.487319 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.curriculum_rec.mart.education
[0m11:52:28.491692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65737da6-f3fc-482f-aaab-807b260350d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca60790>]}
[0m11:52:28.531587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65737da6-f3fc-482f-aaab-807b260350d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ceae790>]}
[0m11:52:28.531819 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m11:52:28.531964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65737da6-f3fc-482f-aaab-807b260350d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd43950>]}
[0m11:52:28.532783 [info ] [MainThread]: 
[0m11:52:28.533010 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:52:28.534568 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m11:52:28.534736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:52:28.867146 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m11:52:28.867894 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:52:29.200032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65737da6-f3fc-482f-aaab-807b260350d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc2b0d0>]}
[0m11:52:29.201111 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:52:29.201558 [info ] [MainThread]: 
[0m11:52:29.206720 [debug] [Thread-1 (]: Began running node model.curriculum_rec.int_topic_generate_hierarchy
[0m11:52:29.207526 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_curriculum_rec.int_topic_generate_hierarchy .... [RUN]
[0m11:52:29.208008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.int_topic_generate_hierarchy)
[0m11:52:29.208372 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.int_topic_generate_hierarchy
[0m11:52:29.214934 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.int_topic_generate_hierarchy"
[0m11:52:29.215737 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.int_topic_generate_hierarchy
[0m11:52:29.236063 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.int_topic_generate_hierarchy"
[0m11:52:29.236550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:52:29.237602 [debug] [Thread-1 (]: On model.curriculum_rec.int_topic_generate_hierarchy: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.int_topic_generate_hierarchy"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`int_topic_generate_hierarchy`
  OPTIONS()
  as WITH RECURSIVE hierarchy AS (
    SELECT 
        t1.id_topic, 
        t1.id_topic_parent, 
        t1.val_topic_level, 
        t1.topic_title,
        t1.id_topic AS root_id_topic
    FROM dbt_curriculum_rec.stg_kaggle__topic t1

    UNION ALL

    SELECT 
        t2.id_topic, 
        t2.id_topic_parent, 
        t2.val_topic_level, 
        t2.topic_title,
        h.root_id_topic
    FROM dbt_curriculum_rec.stg_kaggle__topic t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
SELECT 
    root_id_topic as id_topic,
    TO_JSON_STRING(
        ARRAY_AGG(
            STRUCT(
                id_topic,
                id_topic_parent,
                val_topic_level,
                topic_title
            )
        )
    ) AS json_hierarchy
FROM hierarchy
GROUP BY root_id_topic;


[0m11:52:30.043541 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:4d931c2e-8627-407b-a2c3-041976529951&page=queryresults
[0m11:52:30.443421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65737da6-f3fc-482f-aaab-807b260350d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd42f10>]}
[0m11:52:30.444133 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_curriculum_rec.int_topic_generate_hierarchy  [[32mCREATE VIEW (0 processed)[0m in 1.23s]
[0m11:52:30.444637 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.int_topic_generate_hierarchy
[0m11:52:30.444989 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__content
[0m11:52:30.445472 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__content ............. [RUN]
[0m11:52:30.445892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.int_topic_generate_hierarchy, now model.curriculum_rec.stg_kaggle__content)
[0m11:52:30.446182 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__content
[0m11:52:30.448717 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__content"
[0m11:52:30.449370 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__content
[0m11:52:30.451238 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__content"
[0m11:52:30.451722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:52:30.453004 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__content.sql
WITH raw_content AS 
(
SELECT 
    id as id_content, 
    title as content_title, 
    description as content_description, 
    kind as cat_content_kind,
    text as content_text,
    copyright_holder as content_copyright_holder,
    license as id_content_license 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_content`
) 

SELECT 
    * 
FROM raw_content;


[0m11:52:30.966513 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:b55ecb8e-984d-4cae-a87a-ee758fcf8326&page=queryresults
[0m11:52:31.456682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65737da6-f3fc-482f-aaab-807b260350d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd02210>]}
[0m11:52:31.457781 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__content ........ [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m11:52:31.458643 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__content
[0m11:52:31.459568 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__correl
[0m11:52:31.460365 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__correl .............. [RUN]
[0m11:52:31.461000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__content, now model.curriculum_rec.stg_kaggle__correl)
[0m11:52:31.461404 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__correl
[0m11:52:31.464862 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__correl"
[0m11:52:31.465652 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__correl
[0m11:52:31.468173 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__correl"
[0m11:52:31.468766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:52:31.470407 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__correl: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__correl"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__correl.sql
WITH raw_correl AS 
(
    SELECT 
    topic_id as id_topic, 
    -- probably can do some sort of transformation here it should be a list not a string --  
    -- sql doesn't natively use lists though -- 
    -- have to make the table better don't use lists -- 
    content_id as id_content 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_correlation`
)

SELECT 
    * 
FROM raw_correl;


[0m11:52:32.090884 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:029f3643-95cf-4e9f-bca9-2e271674eda2&page=queryresults
[0m11:52:32.402991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65737da6-f3fc-482f-aaab-807b260350d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd69210>]}
[0m11:52:32.404115 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__correl ......... [[32mCREATE VIEW (0 processed)[0m in 0.94s]
[0m11:52:32.405213 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__correl
[0m11:52:32.405633 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__topic
[0m11:52:32.406356 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__topic ............... [RUN]
[0m11:52:32.407134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__correl, now model.curriculum_rec.stg_kaggle__topic)
[0m11:52:32.407475 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__topic
[0m11:52:32.412801 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__topic"
[0m11:52:32.413483 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__topic
[0m11:52:32.415355 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__topic"
[0m11:52:32.415839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:52:32.417089 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__topic: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__topic"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__topics.sql
WITH raw_topics AS 
(
SELECT  
    id as id_topic, 
    title as topic_title, 
    description as topic_description, 
    channel as id_topic_description, 
    -- already encoded don't need to use case when -- 
    category as cat_topic_category, 
    level as val_topic_level, 
    parent as id_topic_parent, 
    has_content as ind_topic_has_content
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_topic`
) 

SELECT 
    *
FROM raw_topics;


[0m11:52:33.013350 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:84877320-9b27-4a45-a69e-5f29ce4765a3&page=queryresults
[0m11:52:33.452981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65737da6-f3fc-482f-aaab-807b260350d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce6de50>]}
[0m11:52:33.454177 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__topic .......... [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m11:52:33.455257 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__topic
[0m11:52:33.455990 [debug] [Thread-1 (]: Began running node model.curriculum_rec.content
[0m11:52:33.456688 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt_curriculum_rec.content ......................... [RUN]
[0m11:52:33.457280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__topic, now model.curriculum_rec.content)
[0m11:52:33.457671 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.content
[0m11:52:33.461444 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.content"
[0m11:52:33.462200 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.content
[0m11:52:33.464583 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.content"
[0m11:52:33.465126 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:52:33.466781 [debug] [Thread-1 (]: On model.curriculum_rec.content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`content`
  OPTIONS()
  as WITH 
content AS (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
),

correlation AS (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
),

hierarchy AS (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`int_topic_generate_hierarchy`
),

combined_content AS ( 
    SELECT content.*, correlation.id_topic, hierarchy.json_hierarchy
    FROM content 
    LEFT OUTER JOIN correlation ON content.id_content = correlation.id_content
    LEFT OUTER JOIN hierarchy ON correlation.id_topic = hierarchy.id_topic
)

SELECT * FROM combined_content;


[0m11:52:34.241495 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:d90ebbbd-badd-4cd8-8d5a-2fd4138bdd65&page=queryresults
[0m11:52:34.653973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65737da6-f3fc-482f-aaab-807b260350d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd69210>]}
[0m11:52:34.655180 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dbt_curriculum_rec.content .................... [[32mCREATE VIEW (0 processed)[0m in 1.20s]
[0m11:52:34.656267 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.content
[0m11:52:34.658042 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:52:34.658393 [debug] [MainThread]: Connection 'model.curriculum_rec.content' was properly closed.
[0m11:52:34.658805 [info ] [MainThread]: 
[0m11:52:34.659159 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 6.13 seconds (6.13s).
[0m11:52:34.660267 [debug] [MainThread]: Command end result
[0m11:52:34.689219 [info ] [MainThread]: 
[0m11:52:34.689482 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:52:34.689663 [info ] [MainThread]: 
[0m11:52:34.689845 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:52:34.691114 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.180874, "process_user_time": 1.989187, "process_kernel_time": 0.191159, "process_mem_max_rss": "214384640", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:52:34.691414 [debug] [MainThread]: Command `dbt run` succeeded at 11:52:34.691368 after 7.18 seconds
[0m11:52:34.691619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10703c8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c21c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b7cc10>]}
[0m11:52:34.691811 [debug] [MainThread]: Flushing usage events
[0m11:52:42.686410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b793950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b814d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8153d0>]}


============================== 11:52:42.688169 | f1c066cb-a9a5-4665-b567-5a7637c5eb3e ==============================
[0m11:52:42.688169 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:52:42.688433 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/CalvinLii/.dbt', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:52:42.990302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1c066cb-a9a5-4665-b567-5a7637c5eb3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c556a10>]}
[0m11:52:43.009580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1c066cb-a9a5-4665-b567-5a7637c5eb3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d78ed0>]}
[0m11:52:43.009822 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:52:43.020366 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:52:43.094295 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:52:43.094575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f1c066cb-a9a5-4665-b567-5a7637c5eb3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ac36850>]}
[0m11:52:43.633150 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.curriculum_rec.mart.education
[0m11:52:43.637475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1c066cb-a9a5-4665-b567-5a7637c5eb3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11af98550>]}
[0m11:52:43.676863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1c066cb-a9a5-4665-b567-5a7637c5eb3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b1df050>]}
[0m11:52:43.677077 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m11:52:43.677223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1c066cb-a9a5-4665-b567-5a7637c5eb3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ad24490>]}
[0m11:52:43.677999 [info ] [MainThread]: 
[0m11:52:43.678217 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:52:43.679831 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m11:52:43.680017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:52:44.007788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m11:52:44.008638 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:52:44.369096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1c066cb-a9a5-4665-b567-5a7637c5eb3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11abeb390>]}
[0m11:52:44.370292 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:52:44.370977 [info ] [MainThread]: 
[0m11:52:44.376324 [debug] [Thread-1 (]: Began running node model.curriculum_rec.int_topic_generate_hierarchy
[0m11:52:44.377102 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_curriculum_rec.int_topic_generate_hierarchy .... [RUN]
[0m11:52:44.377665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.int_topic_generate_hierarchy)
[0m11:52:44.377999 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.int_topic_generate_hierarchy
[0m11:52:44.384399 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.int_topic_generate_hierarchy"
[0m11:52:44.385181 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.int_topic_generate_hierarchy
[0m11:52:44.406390 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.int_topic_generate_hierarchy"
[0m11:52:44.406933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:52:44.408133 [debug] [Thread-1 (]: On model.curriculum_rec.int_topic_generate_hierarchy: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.int_topic_generate_hierarchy"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`int_topic_generate_hierarchy`
  OPTIONS()
  as WITH RECURSIVE hierarchy AS (
    SELECT 
        t1.id_topic, 
        t1.id_topic_parent, 
        t1.val_topic_level, 
        t1.topic_title,
        t1.id_topic AS root_id_topic
    FROM dbt_curriculum_rec.stg_kaggle__topic t1

    UNION ALL

    SELECT 
        t2.id_topic, 
        t2.id_topic_parent, 
        t2.val_topic_level, 
        t2.topic_title,
        h.root_id_topic
    FROM dbt_curriculum_rec.stg_kaggle__topic t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
SELECT 
    root_id_topic as id_topic,
    TO_JSON_STRING(
        ARRAY_AGG(
            STRUCT(
                id_topic,
                id_topic_parent,
                val_topic_level,
                topic_title
            )
        )
    ) AS json_hierarchy
FROM hierarchy
GROUP BY root_id_topic;


[0m11:52:45.089809 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:85215fa7-71a8-478e-95c6-ce82bc80812b&page=queryresults
[0m11:52:45.623582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c066cb-a9a5-4665-b567-5a7637c5eb3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b1db1d0>]}
[0m11:52:45.624331 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_curriculum_rec.int_topic_generate_hierarchy  [[32mCREATE VIEW (0 processed)[0m in 1.25s]
[0m11:52:45.624827 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.int_topic_generate_hierarchy
[0m11:52:45.625191 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__content
[0m11:52:45.625644 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__content ............. [RUN]
[0m11:52:45.626023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.int_topic_generate_hierarchy, now model.curriculum_rec.stg_kaggle__content)
[0m11:52:45.626279 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__content
[0m11:52:45.628603 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__content"
[0m11:52:45.629261 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__content
[0m11:52:45.631124 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__content"
[0m11:52:45.631587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:52:45.632873 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__content.sql
WITH raw_content AS 
(
SELECT 
    id as id_content, 
    title as content_title, 
    description as content_description, 
    kind as cat_content_kind,
    text as content_text,
    copyright_holder as content_copyright_holder,
    license as id_content_license 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_content`
) 

SELECT 
    * 
FROM raw_content;


[0m11:52:46.213814 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:09fbcfe1-a26b-4628-85b6-640578d854c9&page=queryresults
[0m11:52:46.668261 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c066cb-a9a5-4665-b567-5a7637c5eb3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b1feb50>]}
[0m11:52:46.669734 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__content ........ [[32mCREATE VIEW (0 processed)[0m in 1.04s]
[0m11:52:46.670706 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__content
[0m11:52:46.671059 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__correl
[0m11:52:46.671524 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__correl .............. [RUN]
[0m11:52:46.671942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__content, now model.curriculum_rec.stg_kaggle__correl)
[0m11:52:46.672205 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__correl
[0m11:52:46.674743 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__correl"
[0m11:52:46.675348 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__correl
[0m11:52:46.677042 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__correl"
[0m11:52:46.677464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:52:46.678552 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__correl: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__correl"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__correl.sql
WITH raw_correl AS 
(
    SELECT 
    topic_id as id_topic, 
    -- probably can do some sort of transformation here it should be a list not a string --  
    -- sql doesn't natively use lists though -- 
    -- have to make the table better don't use lists -- 
    content_id as id_content 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_correlation`
)

SELECT 
    * 
FROM raw_correl;


[0m11:52:47.237444 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:3f47e154-3ac8-4c71-9047-52985622c8ef&page=queryresults
[0m11:52:47.568874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c066cb-a9a5-4665-b567-5a7637c5eb3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b16e850>]}
[0m11:52:47.570418 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__correl ......... [[32mCREATE VIEW (0 processed)[0m in 0.90s]
[0m11:52:47.571286 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__correl
[0m11:52:47.571821 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__topic
[0m11:52:47.572817 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__topic ............... [RUN]
[0m11:52:47.573889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__correl, now model.curriculum_rec.stg_kaggle__topic)
[0m11:52:47.574381 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__topic
[0m11:52:47.580585 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__topic"
[0m11:52:47.581430 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__topic
[0m11:52:47.583665 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__topic"
[0m11:52:47.584193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:52:47.585599 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__topic: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__topic"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__topics.sql
WITH raw_topics AS 
(
SELECT  
    id as id_topic, 
    title as topic_title, 
    description as topic_description, 
    channel as id_topic_description, 
    -- already encoded don't need to use case when -- 
    category as cat_topic_category, 
    level as val_topic_level, 
    parent as id_topic_parent, 
    has_content as ind_topic_has_content
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_topic`
) 

SELECT 
    *
FROM raw_topics;


[0m11:52:48.116599 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:360e47b8-7fb6-4c28-88f9-4420a56b5790&page=queryresults
[0m11:52:48.610588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c066cb-a9a5-4665-b567-5a7637c5eb3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11af4f910>]}
[0m11:52:48.611705 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__topic .......... [[32mCREATE VIEW (0 processed)[0m in 1.04s]
[0m11:52:48.612346 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__topic
[0m11:52:48.612762 [debug] [Thread-1 (]: Began running node model.curriculum_rec.content
[0m11:52:48.613304 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt_curriculum_rec.content ......................... [RUN]
[0m11:52:48.613838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__topic, now model.curriculum_rec.content)
[0m11:52:48.614194 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.content
[0m11:52:48.617602 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.content"
[0m11:52:48.618323 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.content
[0m11:52:48.620380 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.content"
[0m11:52:48.620868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:52:48.622255 [debug] [Thread-1 (]: On model.curriculum_rec.content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`content`
  OPTIONS()
  as WITH 
content AS (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
),

correlation AS (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
),

hierarchy AS (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`int_topic_generate_hierarchy`
),

combined_content AS ( 
    SELECT content.*, correlation.id_topic, hierarchy.json_hierarchy
    FROM content 
    LEFT OUTER JOIN correlation ON content.id_content = correlation.id_content
    LEFT OUTER JOIN hierarchy ON correlation.id_topic = hierarchy.id_topic
)

SELECT * FROM combined_content;


[0m11:52:49.387687 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:41ff0985-67b4-4f2c-86e9-c4139447d3aa&page=queryresults
[0m11:52:49.723409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c066cb-a9a5-4665-b567-5a7637c5eb3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11af4ecd0>]}
[0m11:52:49.724620 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dbt_curriculum_rec.content .................... [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m11:52:49.725429 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.content
[0m11:52:49.727205 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:52:49.727601 [debug] [MainThread]: Connection 'model.curriculum_rec.content' was properly closed.
[0m11:52:49.728024 [info ] [MainThread]: 
[0m11:52:49.728948 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 6.05 seconds (6.05s).
[0m11:52:49.730338 [debug] [MainThread]: Command end result
[0m11:52:49.760524 [info ] [MainThread]: 
[0m11:52:49.760844 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:52:49.761035 [info ] [MainThread]: 
[0m11:52:49.761220 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:52:49.762586 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.105238, "process_user_time": 1.992022, "process_kernel_time": 0.187667, "process_mem_max_rss": "217137152", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:52:49.762930 [debug] [MainThread]: Command `dbt run` succeeded at 11:52:49.762878 after 7.11 seconds
[0m11:52:49.763148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055cdc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b423990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105528c10>]}
[0m11:52:49.763360 [debug] [MainThread]: Flushing usage events
[0m11:54:02.461729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f82b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109004d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109005350>]}


============================== 11:54:02.463395 | e7f10b15-d603-4879-b0e5-b148e9515caa ==============================
[0m11:54:02.463395 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:54:02.463693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/CalvinLii/dbt-curriculum-rec/logs', 'profiles_dir': '/Users/CalvinLii/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:54:02.768989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7f10b15-d603-4879-b0e5-b148e9515caa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab57ad0>]}
[0m11:54:02.788161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7f10b15-d603-4879-b0e5-b148e9515caa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107569110>]}
[0m11:54:02.788400 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:54:02.799399 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:54:02.873656 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:54:02.873926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e7f10b15-d603-4879-b0e5-b148e9515caa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c44110>]}
[0m11:54:03.415606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7f10b15-d603-4879-b0e5-b148e9515caa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e973310>]}
[0m11:54:03.455049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7f10b15-d603-4879-b0e5-b148e9515caa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee51450>]}
[0m11:54:03.455268 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 589 macros
[0m11:54:03.455415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7f10b15-d603-4879-b0e5-b148e9515caa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb881d0>]}
[0m11:54:03.456216 [info ] [MainThread]: 
[0m11:54:03.456449 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:54:03.458065 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-tutorial-428919'
[0m11:54:03.458246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:54:03.812393 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919, now list_dbt-tutorial-428919_dbt_curriculum_rec)
[0m11:54:03.813179 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:54:04.164793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7f10b15-d603-4879-b0e5-b148e9515caa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea1ea50>]}
[0m11:54:04.165921 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:54:04.166431 [info ] [MainThread]: 
[0m11:54:04.171808 [debug] [Thread-1 (]: Began running node model.curriculum_rec.int_topic_generate_hierarchy
[0m11:54:04.172605 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_curriculum_rec.int_topic_generate_hierarchy .... [RUN]
[0m11:54:04.173090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-tutorial-428919_dbt_curriculum_rec, now model.curriculum_rec.int_topic_generate_hierarchy)
[0m11:54:04.173435 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.int_topic_generate_hierarchy
[0m11:54:04.179663 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.int_topic_generate_hierarchy"
[0m11:54:04.180403 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.int_topic_generate_hierarchy
[0m11:54:04.201078 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.int_topic_generate_hierarchy"
[0m11:54:04.201572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:54:04.202687 [debug] [Thread-1 (]: On model.curriculum_rec.int_topic_generate_hierarchy: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.int_topic_generate_hierarchy"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`int_topic_generate_hierarchy`
  OPTIONS()
  as WITH RECURSIVE hierarchy AS (
    SELECT 
        t1.id_topic, 
        t1.id_topic_parent, 
        t1.val_topic_level, 
        t1.topic_title,
        t1.id_topic AS root_id_topic
    FROM dbt_curriculum_rec.stg_kaggle__topic t1

    UNION ALL

    SELECT 
        t2.id_topic, 
        t2.id_topic_parent, 
        t2.val_topic_level, 
        t2.topic_title,
        h.root_id_topic
    FROM dbt_curriculum_rec.stg_kaggle__topic t2
    JOIN hierarchy h ON t2.id_topic = h.id_topic_parent
)
SELECT 
    root_id_topic as id_topic,
    TO_JSON_STRING(
        ARRAY_AGG(
            STRUCT(
                id_topic,
                id_topic_parent,
                val_topic_level,
                topic_title
            )
        )
    ) AS json_hierarchy
FROM hierarchy
GROUP BY root_id_topic;


[0m11:54:04.950435 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:d2db54ca-f325-4d45-bbf4-9c1431bac8c0&page=queryresults
[0m11:54:05.483360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7f10b15-d603-4879-b0e5-b148e9515caa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecd16d0>]}
[0m11:54:05.484109 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_curriculum_rec.int_topic_generate_hierarchy  [[32mCREATE VIEW (0 processed)[0m in 1.31s]
[0m11:54:05.484603 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.int_topic_generate_hierarchy
[0m11:54:05.484942 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__content
[0m11:54:05.485411 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__content ............. [RUN]
[0m11:54:05.485832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.int_topic_generate_hierarchy, now model.curriculum_rec.stg_kaggle__content)
[0m11:54:05.486130 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__content
[0m11:54:05.488530 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__content"
[0m11:54:05.489182 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__content
[0m11:54:05.491017 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__content"
[0m11:54:05.491487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:54:05.492730 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__content"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__content.sql
WITH raw_content AS 
(
SELECT 
    id as id_content, 
    title as content_title, 
    description as content_description, 
    kind as cat_content_kind,
    text as content_text,
    copyright_holder as content_copyright_holder,
    license as id_content_license 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_content`
) 

SELECT 
    * 
FROM raw_content;


[0m11:54:06.036617 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:3fe98a12-3247-4011-b814-37d7cbe27645&page=queryresults
[0m11:54:06.551118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7f10b15-d603-4879-b0e5-b148e9515caa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c79b10>]}
[0m11:54:06.551711 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__content ........ [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m11:54:06.552072 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__content
[0m11:54:06.552305 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__correl
[0m11:54:06.552565 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__correl .............. [RUN]
[0m11:54:06.552798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__content, now model.curriculum_rec.stg_kaggle__correl)
[0m11:54:06.552948 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__correl
[0m11:54:06.555067 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__correl"
[0m11:54:06.555750 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__correl
[0m11:54:06.557961 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__correl"
[0m11:54:06.558453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:54:06.559743 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__correl: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__correl"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__correl.sql
WITH raw_correl AS 
(
    SELECT 
    topic_id as id_topic, 
    -- probably can do some sort of transformation here it should be a list not a string --  
    -- sql doesn't natively use lists though -- 
    -- have to make the table better don't use lists -- 
    content_id as id_content 
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_correlation`
)

SELECT 
    * 
FROM raw_correl;


[0m11:54:07.202697 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:972c7ccf-de4d-45cb-bf42-6b5b9213e79a&page=queryresults
[0m11:54:07.525340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7f10b15-d603-4879-b0e5-b148e9515caa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7c9950>]}
[0m11:54:07.526424 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__correl ......... [[32mCREATE VIEW (0 processed)[0m in 0.97s]
[0m11:54:07.527361 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__correl
[0m11:54:07.527717 [debug] [Thread-1 (]: Began running node model.curriculum_rec.stg_kaggle__topic
[0m11:54:07.528285 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_curriculum_rec.stg_kaggle__topic ............... [RUN]
[0m11:54:07.528690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__correl, now model.curriculum_rec.stg_kaggle__topic)
[0m11:54:07.528931 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.stg_kaggle__topic
[0m11:54:07.533606 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.stg_kaggle__topic"
[0m11:54:07.534267 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.stg_kaggle__topic
[0m11:54:07.536121 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.stg_kaggle__topic"
[0m11:54:07.536563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:54:07.537705 [debug] [Thread-1 (]: On model.curriculum_rec.stg_kaggle__topic: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.stg_kaggle__topic"} */


  create or replace view `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__topic`
  OPTIONS()
  as -- models/staging/kaggle/stg_kaggle__topics.sql
WITH raw_topics AS 
(
SELECT  
    id as id_topic, 
    title as topic_title, 
    description as topic_description, 
    channel as id_topic_description, 
    -- already encoded don't need to use case when -- 
    category as cat_topic_category, 
    level as val_topic_level, 
    parent as id_topic_parent, 
    has_content as ind_topic_has_content
FROM `dbt-tutorial-428919`.`kaggle_curriculum_rec`.`kaggle_topic`
) 

SELECT 
    *
FROM raw_topics;


[0m11:54:08.066836 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:c5fb0e01-d632-4b56-b8f7-2bd1c19a4090&page=queryresults
[0m11:54:08.613364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7f10b15-d603-4879-b0e5-b148e9515caa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eda3cd0>]}
[0m11:54:08.614823 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dbt_curriculum_rec.stg_kaggle__topic .......... [[32mCREATE VIEW (0 processed)[0m in 1.08s]
[0m11:54:08.615830 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.stg_kaggle__topic
[0m11:54:08.616324 [debug] [Thread-1 (]: Began running node model.curriculum_rec.content
[0m11:54:08.617005 [info ] [Thread-1 (]: 5 of 5 START sql table model dbt_curriculum_rec.content ........................ [RUN]
[0m11:54:08.617631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.curriculum_rec.stg_kaggle__topic, now model.curriculum_rec.content)
[0m11:54:08.618017 [debug] [Thread-1 (]: Began compiling node model.curriculum_rec.content
[0m11:54:08.621813 [debug] [Thread-1 (]: Writing injected SQL for node "model.curriculum_rec.content"
[0m11:54:08.622611 [debug] [Thread-1 (]: Began executing node model.curriculum_rec.content
[0m11:54:08.631931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:54:09.129569 [debug] [Thread-1 (]: Writing runtime sql for node "model.curriculum_rec.content"
[0m11:54:09.130712 [debug] [Thread-1 (]: On model.curriculum_rec.content: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "curriculum_rec_connect", "target_name": "dev", "node_id": "model.curriculum_rec.content"} */

  
    

    create or replace table `dbt-tutorial-428919`.`dbt_curriculum_rec`.`content`
      
    
    

    OPTIONS()
    as (
      WITH 
content AS (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__content`
),

correlation AS (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`stg_kaggle__correl`
),

hierarchy AS (
    SELECT * FROM `dbt-tutorial-428919`.`dbt_curriculum_rec`.`int_topic_generate_hierarchy`
),

combined_content AS ( 
    SELECT content.*, correlation.id_topic, hierarchy.json_hierarchy
    FROM content 
    LEFT OUTER JOIN correlation ON content.id_content = correlation.id_content
    LEFT OUTER JOIN hierarchy ON correlation.id_topic = hierarchy.id_topic
)

SELECT * FROM combined_content
    );
  
[0m11:54:09.763014 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-tutorial-428919&j=bq:US:ec48aa0c-fa9d-47ec-85a8-e0a5bbfad19a&page=queryresults
[0m11:54:29.570308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7f10b15-d603-4879-b0e5-b148e9515caa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edf3710>]}
[0m11:54:29.571553 [info ] [Thread-1 (]: 5 of 5 OK created sql table model dbt_curriculum_rec.content ................... [[32mCREATE TABLE (128.4k rows, 377.0 MiB processed)[0m in 20.95s]
[0m11:54:29.572283 [debug] [Thread-1 (]: Finished running node model.curriculum_rec.content
[0m11:54:29.574294 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:54:29.574882 [debug] [MainThread]: Connection 'model.curriculum_rec.content' was properly closed.
[0m11:54:29.575312 [info ] [MainThread]: 
[0m11:54:29.575702 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 26.12 seconds (26.12s).
[0m11:54:29.576858 [debug] [MainThread]: Command end result
[0m11:54:29.606102 [info ] [MainThread]: 
[0m11:54:29.606359 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:54:29.606535 [info ] [MainThread]: 
[0m11:54:29.606713 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:54:29.608001 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 27.170652, "process_user_time": 2.024639, "process_kernel_time": 0.197179, "process_mem_max_rss": "217022464", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:54:29.608306 [debug] [MainThread]: Command `dbt run` succeeded at 11:54:29.608258 after 27.17 seconds
[0m11:54:29.608501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109004950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109004110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bc1c10>]}
[0m11:54:29.608686 [debug] [MainThread]: Flushing usage events
